//>>built
require({cache:{"dgrid/main":function(){define("dgrid/Tree dgrid/Selection dgrid/OnDemandList dgrid/OnDemandGrid dgrid/extensions/ColumnReorder dgrid/extensions/ColumnResizer dgrid/extensions/CompoundColumns dgrid/extensions/Pagination dgrid/extensions/DnD dgrid/Editor dstore/Store dstore/Memory dstore/Tree dstore/Cache dstore/Trackable dstore/legacy/DstoreAdapter".split(" "),function(){})},"dgrid/Tree":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/aspect dojo/dom-construct dojo/dom-class dojo/on dojo/query dojo/when ./util/has-css3 ./Grid xdojo/has!touch?./util/touch".split(" "),
function(r,h,p,m,g,n,l,f,u,a,b,d){return r(null,{collapseOnRefresh:!1,enableTreeTransitions:!1,treeIndentWidth:9,constructor:function(){this._treeColumnListeners=[]},shouldExpand:function(a,b,c){return c},expand:function(b,d,c){if(this._treeColumn){var q=this,t=b.element?b:this.row(b),y=!!this._expanded[t.id],A=a("transitionend"),B;b=t.element;b=-1<b.className.indexOf("dgrid-expando-icon")?b:f(".dgrid-expando-icon",b)[0];c=c||!this.enableTreeTransitions;if(b&&b.mayHaveChildren&&(c||d!==y)){var C=
void 0===d?!this._expanded[t.id]:d;n.replace(b,"ui-icon-triangle-1-"+(C?"se":"e"),"ui-icon-triangle-1-"+(C?"e":"se"));n.toggle(t.element,"dgrid-row-expanded",C);d=t.element;var z=d.connected,v,p,w={};if(!z){var z=w.container=d.connected=g.create("div",{className:"dgrid-tree-container"},d,"after"),m=function(c){var a=q._renderedCollection.getChildren(t.data);q.sort&&(a=a.sort(q.sort));a.track&&q.shouldTrackCollection&&(z._rows=c.rows=[],a=a.track(),z._handles=[a.tracking,q._observeCollection(a,z,c)]);
return"start"in c?a.fetchRange({start:c.start,end:c.start+c.count}):a.fetch()};"level"in b&&(m.level=b.level);if(this.renderQuery)B=this.renderQuery(m,w);else{var r=g.create("div",null,z);B=this._trackError(function(){return q.renderQueryResults(m(w),r,h.mixin({rows:w.rows},"level"in m?{queryLevel:m.level}:null)).then(function(c){g.destroy(r);return c})})}A&&l(z,A,this._onTreeTransitionEnd)}z.hidden=!C;v=z.style;!A||c?(v.display=C?"block":"none",v.height=""):(C?(v.display="block",p=z.scrollHeight,
v.height="0px"):(n.add(z,"dgrid-tree-resetting"),v.height=z.scrollHeight+"px"),setTimeout(function(){n.remove(z,"dgrid-tree-resetting");v.height=C?p?p+"px":"auto":"0px"},0));C?this._expanded[t.id]=!0:delete this._expanded[t.id]}return u(B)}},_configColumns:function(){var a=this.inherited(arguments);this._expanded={};for(var b=0,c=a.length;b<c;b++)if(a[b].renderExpando){this._configureTreeColumn(a[b]);break}return a},insertRow:function(a){var b=this.inherited(arguments),c=this.row(b);(c=this.shouldExpand(c,
this._currentLevel,this._expanded[c.id]))&&this.expand(b,!0,!0);(c||!this.collection.mayHaveChildren||this.collection.mayHaveChildren(a))&&n.add(b,"dgrid-row-expandable");return b},removeRow:function(a,b){var c=a.connected,q={};c&&(c._handles&&(p.forEach(c._handles,function(c){c.remove()}),delete c._handles),c._rows&&(q.rows=c._rows),f("\x3e.dgrid-row",c).forEach(function(c){this.removeRow(c,!0,q)},this),c._rows&&(c._rows.length=0,delete c._rows),b||g.destroy(c));this.inherited(arguments)},_refreshCellFromItem:function(a,
b){if(!a.column.renderExpando)return this.inherited(arguments);this.inherited(arguments,[a,b,{queryLevel:f(".dgrid-expando-icon",a.element)[0].level-1}])},cleanup:function(){this.inherited(arguments);this.collapseOnRefresh&&(this._expanded={})},_destroyColumns:function(){this.inherited(arguments);for(var a=this._treeColumnListeners,b=a.length;b--;)a[b].remove();this._treeColumnListeners=[];this._treeColumn=null},_calcRowHeight:function(a){var b=a.connected;return this.inherited(arguments)+(b?b.offsetHeight:
0)},_configureTreeColumn:function(b){var k=this,c=this.collection,q=".dgrid-content .dgrid-column-"+b.id,t;this._treeColumn=b;if(!b._isConfiguredTreeColumn){var y=b.renderCell||this._defaultRenderCell;b._isConfiguredTreeColumn=!0;b.renderCell=function(a,q,t,d){if(c){var f=Number(d&&d.queryLevel)+1,A=!c.mayHaveChildren||c.mayHaveChildren(a),g,f=k._currentLevel=isNaN(f)?0:f;g=b.renderExpando(f,A,k._expanded[c.getIdentity(a)],a);g.level=f;g.mayHaveChildren=A;(a=y.call(b,a,q,t,d))&&a.nodeType?(t.appendChild(g),
t.appendChild(a)):t.insertBefore(g,t.firstChild)}};"function"!==typeof b.renderExpando&&(b.renderExpando=this._defaultRenderExpando)}var f=this._treeColumnListeners;0===f.length&&(f.push(this.on(b.expandOn||".dgrid-expando-icon:click,"+q+":dblclick,"+q+":keydown",function(c){var a=k.row(c);k.collection.mayHaveChildren&&!k.collection.mayHaveChildren(a.data)||"keydown"===c.type&&32!==c.keyCode||"dblclick"===c.type&&t&&1<t.count&&a.id===t.id&&-1<c.target.className.indexOf("dgrid-expando-icon")||k.expand(a);
-1<c.target.className.indexOf("dgrid-expando-icon")&&(t&&t.id===k.row(c).id?t.count++:t={id:k.row(c).id,count:1})})),a("touch")&&f.push(this.on(d.selector(q,d.dbltap),function(){k.expand(this)})))},_defaultRenderExpando:function(a,b,c){var q=this.grid.isRTL?"right":"left",t="dgrid-expando-icon";b&&(t+=" ui-icon ui-icon-triangle-1-"+(c?"se":"e"));return g.create("div",{className:t,innerHTML:"\x26nbsp;",style:"margin-"+q+": "+a*this.grid.treeIndentWidth+"px; float: "+q+";"})},_onNotification:function(a,
b){"delete"===b.type&&delete this._expanded[b.id];this.inherited(arguments)},_onTreeTransitionEnd:function(a){var b=this,c=this.style.height;c&&(this.style.display="0px"===c?"none":"block");a&&(n.add(this,"dgrid-tree-resetting"),setTimeout(function(){n.remove(b,"dgrid-tree-resetting")},0));this.style.height=""}})})},"dgrid/util/has-css3":function(){define(["dojo/has"],function(r){function h(h,g){var n=h.style,l;if(g in n)return!0;g=g.slice(0,1).toUpperCase()+g.slice(1);for(l=p.length;l--;)if(p[l]+
g in n)return p[l];return!1}var p=["ms","O","Moz","Webkit"];r.add("css-transitions",function(p,g,n){return h(n,"transitionProperty")});r.add("css-transforms",function(p,g,n){return h(n,"transform")});r.add("css-transforms3d",function(p,g,n){return h(n,"perspective")});r.add("transitionend",function(){var h=r("css-transitions");return h?!0===h?"transitionend":{ms:"MSTransitionEnd",O:"oTransitionEnd",Moz:"transitionend",Webkit:"webkitTransitionEnd"}[h]:!1});return r})},"dgrid/Grid":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on dojo/has ./List ./util/misc dojo/_base/sniff".split(" "),
function(r,h,p,m,g,n,l,f){function u(a,b){b&&b.nodeType&&a.appendChild(b)}r=r(l,{columns:null,hasNeutralSort:!1,cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(a){return"object"!==typeof a?this.columns[a]:this.cell(a).column},listType:"grid",cell:function(a,b){if(a.column&&a.element)return a;a.target&&a.target.nodeType&&(a=a.target);var d;if(a.nodeType){do{if(this._rowIdToObject[a.id])break;var e=a.columnId;if(e){b=e;d=a;break}a=a.parentNode}while(a&&a!==this.domNode)}if(!d&&"undefined"!==
typeof b){var k=this.row(a);if(e=k&&k.element)for(var e=e.getElementsByTagName("td"),c=0;c<e.length;c++)if(e[c].columnId===b){d=e[c];break}}if(null!=a)return{row:k||this.row(a),column:b&&this.column(b),element:d}},createRowCells:function(a,b,d,e,k){var c=p.create("table",{className:"dgrid-row-table",role:"presentation"}),q=9>n("ie")?p.create("tbody",null,c):c,t,y,g,u,l,z,v,h,w,m;d=d||this.subRows;y=0;for(g=d.length;y<g;y++)for(z=d[y],t=p.create("tr",null,q),z.className&&(t.className=z.className),
u=0,l=z.length;u<l;u++){v=z[u];h=v.id;w=v.field?" field-"+f.escapeCssIdentifier(v.field,"-"):"";(m="function"===typeof v.className?v.className(e):v.className)&&(w+=" "+m);w=p.create(a,{className:"dgrid-cell"+(h?" dgrid-column-"+f.escapeCssIdentifier(h,"-"):"")+w,role:"th"===a?"columnheader":"gridcell"});w.columnId=h;if(h=v.colSpan)w.colSpan=h;if(h=v.rowSpan)w.rowSpan=h;b(w,v,e,k);t.appendChild(w)}return c},_createBodyRowCell:function(a,b,d,e){var k=d;b.get?k=b.get(d):"field"in b&&"_item"!==b.field&&
(k=d[b.field]);b.renderCell?u(a,b.renderCell(d,k,a,e)):this._defaultRenderCell.call(b,d,k,a,e)},_createHeaderRowCell:function(a,b){var d=b.headerNode=a,e=b.field;e&&(a.field=e);b.renderHeaderCell?u(d,b.renderHeaderCell(d)):("label"in b||b.field)&&d.appendChild(document.createTextNode("label"in b?b.label:b.field));!1!==b.sortable&&e&&"_item"!==e&&(a.sortable=!0,a.className+=" dgrid-sortable")},left:function(a,b){a.element||(a=this.cell(a));return this.cell(this._move(a,-(b||1),"dgrid-cell"))},right:function(a,
b){a.element||(a=this.cell(a));return this.cell(this._move(a,b||1,"dgrid-cell"))},_defaultRenderCell:function(a,b,d){if(this.formatter){var e=this.formatter,k=this.grid.formatterScope;d.innerHTML="string"===typeof e&&k?k[e](b,a):this.formatter(b,a)}else null!=b&&d.appendChild(document.createTextNode(b))},renderRow:function(a,b){var d=this.createRowCells("td",h.hitch(this,"_createBodyRowCell"),b&&b.subRows,a,b),e=p.create("div",{role:"row"});e.appendChild(d);return e},renderHeader:function(){var a=
this,b=this.headerNode;b.setAttribute("role","row");p.empty(b);var d=this.createRowCells("th",h.hitch(this,"_createHeaderRowCell"),this.subRows&&this.subRows.headerRows);this._rowIdToObject[d.id=this.id+"-header"]=this.columns;b.appendChild(d);this._sortListener&&this._sortListener.remove();this._sortListener=g(d,"click,keydown",function(e){if("click"===e.type||32===e.keyCode||!n("opera")&&13===e.keyCode){var d=e.target,c,q;do if(d.sortable){c=d.field||d.columnId;q=a.sort[0];c=a.hasNeutralSort&&q&&
q.property===c&&q.descending?[]:[{property:c,descending:q&&q.property===c&&!q.descending}];q={bubbles:!0,cancelable:!0,grid:a,parentType:e.type,sort:c};g.emit(e.target,"dgrid-sort",q)&&(a._sortNode=d,a.set("sort",c));break}while((d=d.parentNode)&&d!==b)}})},resize:function(){if(this.headerNode){var a=this.headerNode.firstChild,b=this.contentNode,d;this.inherited(arguments);b.style.width="";b&&a&&(d=a.offsetWidth)>b.offsetWidth&&(b.style.width=d+"px")}},destroy:function(){this._destroyColumns();this._sortListener&&
this._sortListener.remove();this.inherited(arguments)},_setSort:function(){this.inherited(arguments);this.updateSortArrow(this.sort)},_findSortArrowParent:function(a){var b=this.columns,d;for(d in b){var e=b[d];if(e.field===a)return e.headerNode}},updateSortArrow:function(a,b){this._lastSortedArrow&&(m.remove(this._lastSortedArrow.parentNode,"dgrid-sort-up dgrid-sort-down"),p.destroy(this._lastSortedArrow),delete this._lastSortedArrow);b&&(this.sort=a);if(a[0]){var d=a[0].property,e=a[0].descending,
d=this._sortNode||this._findSortArrowParent(d);delete this._sortNode;d&&(d=d.contents||d,this._lastSortedArrow=p.create("div",{className:"dgrid-sort-arrow ui-icon",innerHTML:"\x26nbsp;",role:"presentation"},d,"first"),m.add(d,"dgrid-sort-"+(e?"down":"up")),this.resize())}},styleColumn:function(a,b){return this.addCssRule("#"+f.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+f.escapeCssIdentifier(a,"-"),b)},_configColumns:function(a,b){var d=[],e=b instanceof Array;f.each(b,function(k,c){"string"===
typeof k&&(b[c]=k={label:k});e||k.field||(k.field=c);c=k.id=k.id||(isNaN(c)?c:a+c);this._configColumn&&(this._configColumn(k,b,a),c=k.id);e&&(this.columns[c]=k);k.grid=this;d.push(k)},this);return e?b:d},_destroyColumns:function(){this.cleanup()},configStructure:function(){var a=this.subRows,b=this._columns=this.columns;this.columns=!b||b instanceof Array?{}:b;if(a)for(b=0;b<a.length;b++)a[b]=this._configColumns(b+"-",a[b]);else this.subRows=[this._configColumns("",b)]},_getColumns:function(){return this._columns||
this.columns},_setColumns:function(a){this._destroyColumns();this.subRows=null;this.columns=a;this._updateColumns()},_setSubRows:function(a){this._destroyColumns();this.subRows=a;this._updateColumns()},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this.sort.length?(this._lastSortedArrow=null,this.updateSortArrow(this.sort)):this.resize())}});r.appendIfNode=u;return r})},"dgrid/List":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-class dojo/on dojo/has ./util/misc dojo/_base/sniff".split(" "),
function(r,h,p,m,g,n){function l(c,a){c.className="dgrid-scrollbar-measure";document.body.appendChild(c);var b=c["offset"+a]-c["client"+a];c.className="";c.parentNode&&document.body.removeChild(c);return b}function f(c){p.replace(this.domNode,c,this._class||"");this._class=c}function u(){return this._class}var a=[];g("mozilla")&&a.push("has-mozilla");g("touch")&&a.push("has-touch");p.add(document.documentElement,a);g.add("pointer",function(c){return"PointerEvent"in c?"pointer":"MSPointerEvent"in c?
"MSPointer":!1});var b,d;g.add("dom-scrollbar-width",function(c,a,b){return l(b,"Width")});g.add("dom-scrollbar-height",function(c,a,b){return l(b,"Height")});g.add("dom-rtl-scrollbar-left",function(c,a,b){c=document.createElement("div");b.className="dgrid-scrollbar-measure";b.setAttribute("dir","rtl");b.appendChild(c);document.body.appendChild(b);a=!!g("ie")||!!g("trident")||/\bEdge\//.test(navigator.userAgent)||c.offsetLeft>=g("dom-scrollbar-width");b.className="";b.parentNode&&document.body.removeChild(b);
h.destroy(c);b.removeAttribute("dir");return a});var e=0,k=r(null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,addUiClasses:!1,highlightDuration:250,postscript:function(c,a){var b=this;(this._Row=function(c,a,b){this.id=c;this.data=a;this.element=b}).prototype.remove=function(){b.removeRow(this.element)};a&&(this.srcNodeRef=a=a.nodeType?a:document.getElementById(a));this.create(c,a)},listType:"list",create:function(c,a){var b=this.domNode=a||document.createElement("div"),
d;c&&(this.params=c,r.safeMixin(this,c),d=c["class"]||c.className||b.className);this.sort=this.sort||[];this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=b.id=b.id||this.id||k.autoIdPrefix+e++;this.buildRendering();d&&f.call(this,d);this.postCreate();delete this.srcNodeRef},buildRendering:function(){var c=this.domNode,a=this.addUiClasses,b=this,e,d,k;k=this.isRTL="rtl"===(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();
c.className="";c.setAttribute("role","grid");p.add(c,"dgrid dgrid-"+this.listType+(a?" ui-widget":""));e=this.headerNode=h.create("div",{tabIndex:-1,className:"dgrid-header dgrid-header-row"+(a?" ui-widget-header":"")+(this.showHeader?"":" dgrid-header-hidden")},c);d=this.bodyNode=h.create("div",{className:"dgrid-scroller"},c);g("ff")&&(d.tabIndex=-1);this.headerScrollNode=h.create("div",{className:"dgrid-header dgrid-header-scroll dgrid-scrollbar-width"+(a?" widget":"")},c);this.footerNode=h.create("div",
{className:"dgrid-footer"+(this.showFooter?"":" dgrid-footer-hidden")},c);k&&(c.className+=" dgrid-rtl"+(g("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));m(d,"scroll",function(a){b.showHeader&&(e.scrollLeft=a.scrollLeft||d.scrollLeft);a.stopPropagation();m.emit(c,"scroll",{scrollTarget:d})});this.configStructure();this.renderHeader();this.contentNode=this.touchNode=h.create("div",{className:"dgrid-content"+(a?" widget":"")},this.bodyNode)},startup:function(){this._started||(this.inherited(arguments),
this._started=!0,this.set("sort",this.sort))},configStructure:function(){},resize:function(){var c=this.bodyNode,a=this.footerNode,a=this.showFooter?a.offsetHeight:0;this.headerScrollNode.style.height=c.style.marginTop=this.headerNode.offsetHeight+"px";c.style.marginBottom=a+"px";b||(b=g("dom-scrollbar-width"),d=g("dom-scrollbar-height"),g("ie")&&(b++,d++),17!==b&&n.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+b+"px"))},addCssRule:function(c,a){var b=n.addCssRule(c,a);this.cleanAddedRules&&
this._listeners.push(b);return b},on:function(c,a){var b=m(this.domNode,c,a);g("dom-addeventlistener")||this._listeners.push(b);return b},cleanup:function(){for(var c in this._rowIdToObject)if(this._rowIdToObject[c]!==this.columns){var a=document.getElementById(c);a&&this.removeRow(a,!0)}},destroy:function(){if(this._listeners){for(var c=this._listeners.length;c--;)this._listeners[c].remove();this._listeners=null}this._started=!1;this.cleanup();h.destroy(this.domNode)},refresh:function(){this.cleanup();
this._rowIdToObject={};this._autoRowId=0;this.contentNode.innerHTML="";this.scrollTo({x:0,y:0})},adjustRowIndices:function(c){var a=c.rowIndex;if(-1<a){do-1<c.rowIndex&&(this.maintainOddEven&&p.contains(c,"dgrid-row")&&p.replace(c,1===a%2?"dgrid-row-odd":"dgrid-row-even",0===a%2?"dgrid-row-odd":"dgrid-row-even"),c.rowIndex=a++);while((c=c.nextSibling)&&c.rowIndex!==a)}},renderArray:function(c,a,b){b=b||{};var e=b.start||0,d=document.createDocumentFragment(),k=[],f=0,g=c.length;a||(this._lastCollection=
c);for(;f<g;)k[f]=this.insertRow(c[f],d,null,e++,b),f++;(c=a?a.parentNode:this.contentNode)&&c.parentNode&&(c!==this.contentNode||g)&&(c.insertBefore(d,a||null),g&&this.adjustRowIndices(k[g-1]));return k},renderHeader:function(){},_autoRowId:0,insertRow:function(c,a,b,e,d){var k=this.id+"-row-"+(this.collection&&this.collection.getIdentity?this.collection.getIdentity(c):this._autoRowId++),f=document.getElementById(k),g=f&&f.previousSibling;f&&(f===b&&(b=(b.connected||b).nextSibling),this.removeRow(f,
!1,d));f=this.renderRow(c,d);f.className=(f.className||"")+" dgrid-row "+(1===e%2?"dgrid-row-odd":"dgrid-row-even");this._rowIdToObject[f.id=k]=c;a.insertBefore(f,b||null);f.rowIndex=e;g&&g.rowIndex!==f.rowIndex-1&&this.adjustRowIndices(g);return f},renderRow:function(c){var a=document.createElement("div");a.appendChild(document.createTextNode(c));return a},removeRow:function(c,a){c=c.element||c;delete this._rowIdToObject[c.id];a||h.destroy(c)},row:function(c){var a;if(c instanceof this._Row)return c;
if(!c)return null;c.target&&c.target.nodeType&&(c=c.target);if(c.nodeType){do{var b=c.id;if(a=this._rowIdToObject[b])return new this._Row(b.substring(this.id.length+5),a,c);c=c.parentNode}while(c&&c!==this.domNode)}else return"object"===typeof c?a=this.collection.getIdentity(c):(a=c,c=this._rowIdToObject[this.id+"-row-"+a]),new this._Row(a,c,document.getElementById(this.id+"-row-"+a))},cell:function(c){return{row:this.row(c)}},_move:function(c,a,b,e){var d,k;k=d=c.element;a=a||1;do if(c=d[0>a?"previousSibling":
"nextSibling"]){do if((d=c)&&-1<(d.className+" ").indexOf(b+" ")){k=d;a+=0>a?1:-1;break}while(c=(!e||!d.hidden)&&d[0>a?"lastChild":"firstChild"])}else if(d=d.parentNode,!d||d===this.bodyNode||d===this.headerNode)break;while(a);return k},up:function(c,a,b){if(!c)return null;c.element||(c=this.row(c));return this.row(this._move(c,-(a||1),"dgrid-row",b))},down:function(c,a,b){if(!c)return null;c.element||(c=this.row(c));return this.row(this._move(c,a||1,"dgrid-row",b))},scrollTo:function(c){"undefined"!==
typeof c.x&&(this.bodyNode.scrollLeft=c.x);"undefined"!==typeof c.y&&(this.bodyNode.scrollTop=c.y)},getScrollPosition:function(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}},get:function(c){var a="_get"+c.charAt(0).toUpperCase()+c.slice(1);return"function"===typeof this[a]?this[a].apply(this,[].slice.call(arguments,1)):this[c]},set:function(c,a){if("object"===typeof c)for(var b in c)this.set(b,c[b]);else b="_set"+c.charAt(0).toUpperCase()+c.slice(1),"function"===typeof this[b]?this[b].apply(this,
[].slice.call(arguments,1)):this[c]=a;return this},_getClass:u,_setClass:f,_getClassName:u,_setClassName:f,_setSort:function(c,a){this.sort="string"!==typeof c?c:[{property:c,descending:a}];this._applySort()},_applySort:function(){this.refresh();if(this._lastCollection){var c=this.sort;if(c&&0<c.length){var a=c[0].property,b=!!c[0].descending;this._lastCollection.sort(function(c,d){var e=c[a],k=d[a];void 0===e&&(e="");void 0===k&&(k="");return e===k?0:e>k!==b?1:-1})}this.renderArray(this._lastCollection)}},
_setShowHeader:function(c){var a=this.headerNode;this.showHeader=c;p.toggle(a,"dgrid-header-hidden",!c);this.renderHeader();this.resize();c&&(a.scrollLeft=this.getScrollPosition().x)},_setShowFooter:function(c){this.showFooter=c;p.toggle(this.footerNode,"dgrid-footer-hidden",!c);this.resize()}});k.autoIdPrefix="dgrid_";return k})},"dgrid/util/misc":function(){define(["dojo/has"],function(r){r.add("dom-contains",function(f,g,a){return!!a.contains});var h=[],p,m,g,n=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,
l={defaultDelay:15,throttle:function(f,g,a){var b=!1;a=a||l.defaultDelay;return function(){b||(b=!0,f.apply(g,arguments),setTimeout(function(){b=!1},a))}},throttleDelayed:function(f,g,a){var b=!1;a=a||l.defaultDelay;return function(){if(!b){b=!0;var d=arguments;setTimeout(function(){b=!1;f.apply(g,d)},a)}}},debounce:function(f,g,a){var b;a=a||l.defaultDelay;return function(){b&&(clearTimeout(b),b=null);var d=arguments;b=setTimeout(function(){f.apply(g,d)},a)}},each:function(f,g,a){var b,d;if(f)if("number"===
typeof f.length)for(b=0,d=f.length;b<d;b++)g.call(a,f[b],b,f);else for(b in f)g.call(a,f[b],b,f)},contains:function(f,g){return r("dom-contains")?f.contains(g):f.compareDocumentPosition(g)&8},addCssRule:function(f,n){p||(p=document.createElement("style"),document.getElementsByTagName("head")[0].appendChild(p),p=p.sheet||p.styleSheet,m=p.deleteRule?"deleteRule":"removeRule",g=p.cssRules?"cssRules":"rules");var a=h.length;h[a]=(p.cssRules||p.rules).length;p.addRule?p.addRule(f,n):p.insertRule(f+"{"+
n+"}",h[a]);return{get:function(b){return p[g][h[a]].style[b]},set:function(b,d){"undefined"!==typeof h[a]&&(p[g][h[a]].style[b]=d)},remove:function(){var b=h[a],d,e;if(void 0!==b)for(p[m](b),h[a]=void 0,d=a+1,e=h.length;d<e;d++)h[d]>b&&h[d]--}}},escapeCssIdentifier:function(f,g){return"string"===typeof f?f.replace(n,g||"\\$1"):f}};return l})},"dgrid/Selection":function(){define("dojo/_base/declare dojo/dom-class dojo/on dojo/has dojo/aspect ./List dgrid/util/touch dojo/query dojo/_base/sniff dojo/dom".split(" "),
function(r,h,p,m,g,n,l){function f(c,a){for(var b=c.unselectable=a?"on":"",d=c.getElementsByTagName("*"),e=d.length;--e;)"INPUT"!==d[e].tagName&&"TEXTAREA"!==d[e].tagName&&(d[e].unselectable=b)}function u(c,a){var d=c.bodyNode,e=a?"text":21>m("ff")?"-moz-none":"none";b&&"msUserSelect"!==b?d.style[b]=e:m("dom-selectstart")?a||c._selectstartHandle?a&&c._selectstartHandle&&(c._selectstartHandle.remove(),delete c._selectstartHandle):c._selectstartHandle=p(d,"selectstart",function(c){var a=c.target&&c.target.tagName;
"INPUT"!==a&&"TEXTAREA"!==a&&c.preventDefault()}):(f(d,!a),a||c._unselectableHandle)?a&&c._unselectableHandle&&(c._unselectableHandle.remove(),delete c._unselectableHandle):c._unselectableHandle=g.after(c,"renderRow",function(c){f(c,!0);return c})}m.add("dom-comparedocumentposition",function(c,a,b){return!!b.compareDocumentPosition});m.add("dom-selectstart","undefined"!==typeof document.onselectstart);var a=m("mac")?"metaKey":"ctrlKey",b=m("css-user-select"),d=(n=m("pointer"))&&"MS"===n.slice(0,2),
e=n?n+(d?"Down":"down"):"mousedown",k=n?n+(d?"Up":"up"):"mouseup";"WebkitUserSelect"===b&&"undefined"!==typeof document.documentElement.style.msUserSelect&&(b=!1);return r(null,{selectionDelegate:".dgrid-row",selectionEvents:e+","+k+",dgrid-cellfocusin",selectionTouchEvents:m("touch")?l.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);
this._initSelectionEvents();var c=this.selectionMode;this.selectionMode="";this._setSelectionMode(c)},destroy:function(){this.inherited(arguments);this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&this._removeDeselectSignals()},_setSelectionMode:function(c){c!==this.selectionMode&&(this.clearSelection(),this.selectionMode=c,this._selectionHandlerName="_"+c+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},
_setAllowTextSelection:function(c){"undefined"!==typeof c?u(this,c):u(this,"none"===this.selectionMode);this.allowTextSelection=c},_handleSelect:function(c,a){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(a))&&("dgrid-cellfocusin"!==c.type||"mousedown"!==c.parentType)&&(c.type!==k||a===this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=c;if(!c.keyCode||!c.ctrlKey||32===c.keyCode)if(!c.shiftKey&&c.type===e&&this.isSelected(a))this._waitForMouseUp=a;else this[this._selectionHandlerName](c,
a);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(c,b){var d=c.keyCode?c.ctrlKey:c[a];this._lastSelected===b?this.select(b,null,!d||!this.isSelected(b)):(this.clearSelection(),this.select(b),this._lastSelected=b)},_multipleSelectionHandler:function(c,b){var d=this._lastSelected,e=c.keyCode?c.ctrlKey:c[a],k;c.shiftKey||(k=e?null:!0,d=null);this.select(b,d,k,null,-1!==c.type.indexOf("mouse")?"mouse":c.type);d||(this._lastSelected=b)},_extendedSelectionHandler:function(c,b){(2===
c.button?this.isSelected(b):c.keyCode?c.ctrlKey:c[a])||this.clearSelection(null,!0);this._multipleSelectionHandler(c,b)},_toggleSelectionHandler:function(c,a){this.select(a,null,null)},_initSelectionEvents:function(){var c=this,b=this.contentNode,d=this.selectionDelegate;this._selectionEventQueues={deselect:[],select:[]};m("touch")&&!m("pointer")&&this.selectionTouchEvents?(p(b,l.selector(d,this.selectionTouchEvents),function(a){c._handleSelect(a,this);c._ignoreMouseSelect=this}),p(b,p.selector(d,
this.selectionEvents),function(a){c._ignoreMouseSelect!==this?c._handleSelect(a,this):a.type===k&&(c._ignoreMouseSelect=null)})):p(b,p.selector(d,this.selectionEvents),function(a){c._handleSelect(a,this)});this.addKeyHandler&&this.addKeyHandler(32,function(a){c._handleSelect(a,a.target)});if(this.allowSelectAll)this.on("keydown",function(b){b[a]&&65===b.keyCode&&!/\bdgrid-input\b/.test(b.target.className)&&(b.preventDefault(),c[c.allSelected?"clearSelection":"selectAll"]())});this._setCollection&&
g.before(this,"_setCollection",function(a){c._updateDeselectionAspect(a)});this._updateDeselectionAspect()},_updateDeselectionAspect:function(c){function a(c,d,e){if((c=b.row(c))&&b.selection[c.id])b[d](c,null,!0,null,e)}var b=this,d;this._removeDeselectSignals&&this._removeDeselectSignals();d=c&&c.track&&this._observeCollection?[g.before(this,"_observeCollection",function(c){d.push(c.on("delete",function(c){"undefined"===typeof c.index&&a(c.id,"deselect")}))}),g.after(this,"_observeCollection",function(c){d.push(c.on("update",
function(b){"undefined"!==typeof b.index&&a(c.getIdentity(b.target),"select","update")}))},!0)]:[g.before(this,"removeRow",function(c,a){var b;a||(b=this.row(c))&&b.id in this.selection&&this.deselect(b)})];this._removeDeselectSignals=function(){for(var c=d.length;c--;)d[c].remove();d=[]}},allowSelect:function(){return!0},_fireSelectionEvent:function(c){var a=this._selectionEventQueues[c],b=this._selectionTriggerEvent,d;d={bubbles:!0,grid:this};b&&(d.parentType=b.type);d[this._selectionTargetType]=
a;this._selectionEventQueues[c]=[];p.emit(this.contentNode,"dgrid-"+c,d)},_fireSelectionEvents:function(){var c=this._selectionEventQueues,a;for(a in c)c[a].length&&this._fireSelectionEvent(a)},_select:function(c,a,b){var d,e,k;"undefined"===typeof b&&(b=!0);c.element||(c=this.row(c));if(!1===b||this.allowSelect(c))if(d=this.selection,e=!!d[c.id],null===b&&(b=!e),k=c.element,b||this.allSelected?d[c.id]=b:delete this.selection[c.id],k&&(b?h.add(k,"dgrid-selected"+(this.addUiClasses?" ui-state-active":
"")):h.remove(k,"dgrid-selected ui-state-active")),b!==e&&k&&this._selectionEventQueues[(b?"":"de")+"select"].push(c),a)if(a.element||(a=this.row(a)),a){if(a=a.element)for(d=this._determineSelectionDirection(k,a),d||(a=document.getElementById(a.id),d=this._determineSelectionDirection(k,a));c.element!==a&&(c=this[d](c));)this._select(c,null,b)}else this._lastSelected=k},_determineSelectionDirection:m("dom-comparedocumentposition")?function(c,a){var b=a.compareDocumentPosition(c);return b&1?!1:2===
b?"down":"up"}:function(c,a){return 1>a.sourceIndex?!1:a.sourceIndex>c.sourceIndex?"down":"up"},select:function(c,a,b){this._select(c,a,b);this._fireSelectionEvents()},deselect:function(c,a){this.select(c,a,!1)},clearSelection:function(c,a){this.allSelected=!1;for(var b in this.selection)c!==b&&this._select(b,null,!1);a||(this._lastSelected=null);this._fireSelectionEvents()},selectAll:function(){this.allSelected=!0;this.selection={};for(var c in this._rowIdToObject){var a=this.row(this._rowIdToObject[c]);
this._select(a.id,null,!0)}this._fireSelectionEvents()},isSelected:function(c){if("undefined"===typeof c||null===c)return!1;c.element||(c=this.row(c));return c.id in this.selection?!!this.selection[c.id]:this.allSelected&&(!c.data||this.allowSelect(c))},refresh:function(){this.deselectOnRefresh&&this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var c=this.inherited(arguments),a=this.selection,b,d,e;for(b=0;b<c.length;b++)d=this.row(c[b]),(e=d.id in
a?a[d.id]:this.allSelected)&&this.select(d,null,e,null,"renderArray");this._fireSelectionEvents();return c}})})},"dgrid/util/touch":function(){define(["dojo/on"],function(r,h){function p(g,n,l,f){if(!(1<l.targetTouches.length)){var u=l.changedTouches[0],a=u.screenX,b=u.screenY;f&&l.preventDefault();var d=r(g,"touchend",function(e){var k=e.changedTouches[0];e.targetTouches.length||(Math.abs(k.screenX-a)<m.tapRadius&&Math.abs(k.screenY-b)<m.tapRadius&&(f&&e.preventDefault(),n.call(this,e)),d.remove())})}}
var m={tapRadius:10,dbltapTime:250,selector:function(g,n,l){return function(f,u){var a=n.bubble;a?n=a:!1!==l&&(l=!0);return r(f,n,function(a){var d=a.target;3===d.nodeType&&(d=d.parentNode);for(;!h.matches(d,g,f);)if(d===f||!l||!(d=d.parentNode))return;return u.call(d,a)})}},countCurrentTouches:function(g,n){if(!("touches"in g))return-1;var l,f,u;for(f=l=0;u=g.touches[l];++l)n.contains(u.target)&&++f;return f},tap:function(g,n){return r(g,"touchstart",function(l){p(g,n,l)})},dbltap:function(g,n){var l,
f;return r(g,"touchstart",function(u){l?p(g,function(a){if(l){var b=a.changedTouches[0];Math.abs(b.screenX-l.screenX)<m.tapRadius&&Math.abs(b.screenY-l.screenY)<m.tapRadius&&(f&&clearTimeout(f),l=f=null,n.call(this,a))}},u,!0):p(g,function(a){l=a.changedTouches[0];f=setTimeout(function(){l=f=null},m.dbltapTime)},u)})}};return m})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/on dojo/when ./util/misc".split(" "),function(r,
h,p,m,g,n,l,f){return p([r,h],{minRowsPerPage:2500,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:f.defaultDelay,keepScrollPosition:!1,rowHeight:0,postCreate:function(){this.inherited(arguments);var g=this;n(this.bodyNode,"scroll",f[this.pagingMethod](function(a){g._processScroll(a)},null,this.pagingDelay))},destroy:function(){this.inherited(arguments);this._refreshTimeout&&clearTimeout(this._refreshTimeout)},renderQuery:function(f,
a){var b=this,d=a&&a.container||this.contentNode,e={query:f,count:0},k,c=this.preload,q={node:g.create("div",{className:"dgrid-preload",style:{height:"0"}},d),count:0,query:f,next:e};q.node.rowIndex=0;e.node=k=g.create("div",{className:"dgrid-preload"},d);e.previous=q;k.rowIndex=this.minRowsPerPage;c?((e.next=c.next)&&k.offsetTop>=c.node.offsetTop?e.previous=c:(e.next=c,e.previous=c.previous),e.previous.next=e,e.next.previous=e):this.preload=e;var t=g.create("div",{className:"dgrid-loading"},k,"before");
g.create("div",{className:"dgrid-below"},t).innerHTML=this.loadingMessage;a=m.mixin({start:0,count:this.minRowsPerPage},"level"in f?{queryLevel:f.level}:null);return this._trackError(function(){var c=f(a);return b.renderQueryResults(c,k,a).then(function(d){return c.totalLength.then(function(c){var q=d.length,f=k.parentNode,n=b.noDataNode;b._rows&&(b._rows.min=0,b._rows.max=q===c?Infinity:q-1);g.destroy(t);"queryLevel"in a||(b._total=c);0===c&&f&&(n&&(g.destroy(n),delete b.noDataNode),b.noDataNode=
n=g.create("div",{className:"dgrid-no-data",innerHTML:b.noDataMessage}),b._emit("noData"),f.insertBefore(n,b._getFirstRowSibling(f)));for(n=f=0;n<q;n++)f+=b._calcRowHeight(d[n]);q&&f&&(b.rowHeight=f/q);c-=q;e.count=c;k.rowIndex=q;c?k.style.height=Math.min(c*b.rowHeight,b.maxEmptySpace)+"px":k.style.display="none";b._previousScrollPosition&&(b.scrollTo(b._previousScrollPosition),delete b._previousScrollPosition);return l(b._processScroll()).then(function(){return d})})}).otherwise(function(c){g.destroy(t);
throw c;})})},refresh:function(f){var a=this,b=f&&f.keepScrollPosition;"undefined"===typeof b&&(b=this.keepScrollPosition);b&&(this._previousScrollPosition=this.getScrollPosition());this.inherited(arguments);if(this._renderedCollection)return this.renderQuery(function(b){return a._renderedCollection.fetchRange({start:b.start,end:b.start+b.count})}).then(function(){a._refreshTimeout=setTimeout(function(){n.emit(a.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:a});a._refreshTimeout=
null},0)})},resize:function(){this.inherited(arguments);this._processScroll()},cleanup:function(){this.inherited(arguments);this.preload=null},renderQueryResults:function(f){var a=this.inherited(arguments),b=this._renderedCollection;b&&b.releaseRange&&a.then(function(a){a[0]&&!a[0].parentNode.tagName&&f.totalLength.then(function(){b.releaseRange(a[0].rowIndex,a[a.length-1].rowIndex+1)})});return a},_getFirstRowSibling:function(f){return f.lastChild},_calcRowHeight:function(f){var a=f.nextSibling;
return a&&!/\bdgrid-preload\b/.test(a.className)?a.offsetTop-f.offsetTop:f.offsetHeight},lastScrollTop:0,_processScroll:function(f){function a(c,a,d,q){var k=e.farOffRemoval,f=c.node;if(a>2*k){for(var t,n=f[d],l=0,y=0,u=[],v=n&&n.rowIndex,h;t=n;){var m=e._calcRowHeight(t);if(l+m+k>a||0>n.className.indexOf("dgrid-row")&&0>n.className.indexOf("dgrid-loading"))break;n=t[d];l+=m;y+=t.count||1;e.removeRow(t,!0);u.push(t);"rowIndex"in t&&(h=t.rowIndex)}e._renderedCollection.releaseRange&&"number"===typeof v&&
"number"===typeof h&&(q?e._renderedCollection.releaseRange(h,v+1):e._renderedCollection.releaseRange(v,h+1),e._rows[q?"max":"min"]=h,e._rows.max>=e._total-1&&(e._rows.max=Infinity));c.count+=y;q?(f.rowIndex-=y,b(c)):f.style.height=f.offsetHeight+l+"px";var A=document.createElement("div");for(c=u.length;c--;)A.appendChild(u[c]);setTimeout(function(){g.destroy(A)},1)}}function b(c,a){c.node.style.height=Math.min(c.count*e.rowHeight,a?Infinity:e.maxEmptySpace)+"px"}function d(c,a){do c=a?c.next:c.previous;
while(c&&!c.node.offsetWidth);return c}if(this.rowHeight){var e=this,k=e.bodyNode;f=f&&f.scrollTop||this.getScrollPosition().y;var k=k.offsetHeight+f,c,q,t=e.preload,n=e.lastScrollTop,l=e.bufferRows*e.rowHeight,h=l-e.rowHeight,p,z=!0;for(e.lastScrollTop=f;t&&!t.node.offsetWidth;)t=t.previous;for(;t&&t!==c;){c=e.preload;e.preload=t;q=t.node;var v=q.offsetTop;if(k+1+h<v)t=d(t,z=!1);else if(f-1-h>v+q.offsetHeight)t=d(t,z=!0);else{var v=((q.rowIndex?f-l:k)-v)/e.rowHeight,m=(k-f+2*l)/e.rowHeight,w=Math.max(Math.min((f-
n)*e.rowHeight,e.maxRowsPerPage/2),e.maxRowsPerPage/-2),m=m+Math.min(Math.abs(w),10);0===q.rowIndex&&(v-=m);v=Math.max(v,0);10>v&&0<v&&m+v<e.maxRowsPerPage&&(m+=Math.max(0,v),v=0);m=Math.min(Math.max(m,e.minRowsPerPage),e.maxRowsPerPage,t.count);if(0===m)t=d(t,z);else{var m=Math.ceil(m),v=Math.min(Math.floor(v),t.count-m),x={};t.count-=m;var r=q,F,w=e.queryRowsOverlap,G=(0<q.rowIndex||q.offsetTop>f)&&t;if(G){var D=t.previous;D&&(a(D,f-(D.node.offsetTop+D.node.offsetHeight),"nextSibling"),0<v&&D.node===
q.previousSibling?(v=Math.min(t.count,v),t.previous.count+=v,b(t.previous,!0),q.rowIndex+=v,w=0):m+=v,t.count-=v);x.start=q.rowIndex-w;x.count=Math.min(m+w,e.maxRowsPerPage);q.rowIndex=x.start+x.count}else t.next&&(a(t.next,t.next.node.offsetTop-k,"previousSibling",!0),r=q.nextSibling,r===t.next.node?(t.next.count+=t.count-v,t.next.node.rowIndex=v+m,b(t.next),t.count=v,w=0):F=!0),x.start=t.count,x.count=Math.min(m+w,e.maxRowsPerPage);F&&r&&r.offsetWidth&&(F=r.offsetTop);b(t);"level"in t.query&&(x.queryLevel=
t.query.level);if("queryLevel"in x||!(x.start>e._total||0>x.count)){var E=g.create("div",{className:"dgrid-loading",style:{height:m*e.rowHeight+"px"}},r,"before");g.create("div",{className:"dgrid-"+(G?"below":"above"),innerHTML:e.loadingMessage},E);E.count=m;e._trackError(function(){(function(c,a,d){var q=t.query(x);p=e.renderQueryResults(q,c,x).then(function(k){var f=e._rows;!f||"queryLevel"in x||!k.length||(a?(f.max<=f.min&&(f.min=k[0].rowIndex),f.max=k[k.length-1].rowIndex):(f.max<=f.min&&(f.max=
k[k.length-1].rowIndex),f.min=k[0].rowIndex));r=c.nextSibling;g.destroy(c);d&&r&&r.offsetWidth&&(f=e.getScrollPosition(),e.scrollTo({x:f.x,y:f.y+r.offsetTop-d,preserveMomentum:!0}));q.totalLength.then(function(c){"queryLevel"in x||(e._total=c,e._rows&&e._rows.max>=e._total-1&&(e._rows.max=Infinity));a&&(a.count=c-a.node.rowIndex,b(a))});e._processScroll();return k},function(a){g.destroy(c);throw a;})})(E,G,F)});t=t.previous}}}}return p}}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/aspect dojo/dom-construct dojo/has dojo/on dojo/when".split(" "),
function(r,h,p,m,g,n,l,f){function u(a){if("object"!==typeof a)a=Error(a);else if("cancel"===a.dojoType)return;l.emit(this.domNode,"dgrid-error",{grid:this,error:a,cancelable:!0,bubbles:!0})&&console.error(a)}return r(null,{collection:null,_renderedCollection:null,_rows:null,_observerHandle:null,shouldTrackCollection:!1,getBeforePut:!0,noDataMessage:"",loadingMessage:"",_total:0,constructor:function(){this.dirty={};this._updating={};this._columnsWithSet={};m.before(this,"configStructure",h.hitch(this,
function(){this._columnsWithSet={}}))},destroy:function(){this.inherited(arguments);this._renderedCollection&&this._cleanupCollection()},_configColumn:function(a){a.set&&(this._columnsWithSet[a.field]=a);this.inherited(arguments)},_setCollection:function(a){this._renderedCollection&&(this.cleanup(),this._cleanupCollection({shouldRevert:!a||a.storage!==this._renderedCollection.storage}));this.collection=a;if(this._started){if(a){var b=a;this.sort&&0<this.sort.length&&(b=a.sort(this.sort));b.track&&
this.shouldTrackCollection&&(b=b.track(),this._rows=[],this._observerHandle=this._observeCollection(b,this.contentNode,{rows:this._rows}));this._renderedCollection=b}this.refresh()}},_setStore:function(){},_getTotal:function(){return this._total},_cleanupCollection:function(a){a=a||{};this._renderedCollection.tracking&&this._renderedCollection.tracking.remove();this._observerHandle&&(this._observerHandle.remove(),this._observerHandle=this._rows=null);!1!==a.shouldRevert&&(this.dirty={});this._renderedCollection=
this.collection=null},_applySort:function(){this.collection&&this.set("collection",this.collection)},row:function(){var a=this.inherited(arguments);a&&a.data&&"undefined"!==typeof a.id&&(this.collection?a.id=this.collection.getIdentity(a.data):console.error("_StoreMixin:have no collection!"));return a},refresh:function(){var a=this.inherited(arguments);this.collection||(this.noDataNode=g.create("div",{className:"dgrid-no-data",innerHTML:this.noDataMessage},this.contentNode),this._emit("noData"));
return a},refreshCell:function(a){if(!this.collection||!this._createBodyRowCell)return!1;if(a.column){if(a.column&&a.column.selector)return(new p).resolve();this.inherited(arguments);return this.collection.get(a.row.id).then(h.hitch(this,"_refreshCellFromItem",a))}},_refreshCellFromItem:function(a,b,d){if(a&&a.element){var e=a.element;e.widget&&e.widget.destroyRecursive();g.empty(e);var k=this.dirty&&this.dirty[a.row.id];k&&(b=h.delegate(b,k));this._createBodyRowCell(e,a.column,b,d)}},renderArray:function(){var a=
this.inherited(arguments);this.collection||a.length&&this.noDataNode&&g.destroy(this.noDataNode);return a},insertRow:function(a,b,d,e,k){var c=this.collection,q=this.dirty,c=c&&c.getIdentity(a),f;c in q&&!(c in this._updating)&&(f=q[c]);f&&(a=h.delegate(a,f));q=this.inherited(arguments);k&&k.rows&&(k.rows[e]=q);this.noDataNode&&(g.destroy(this.noDataNode),this.noDataNode=null);return q},updateDirty:function(a,b,d){var e=this.dirty,k=e[a];k||(k=e[a]={});k[b]=d},save:function(){function a(a,q){return function(k){var f=
b._columnsWithSet,t=b._updating,g,n;if("function"===typeof k.set)k.set(q);else for(g in q)k[g]=q[g];for(g in f)n=f[g].set(k),void 0!==n&&(k[g]=n);t[a]=!0;return d.put(k).then(function(b){delete e[a];delete t[a];c[a]=b;return c})}}var b=this,d=this.collection,e=this.dirty,k=new p,c={},q=function(c){var a;return b.getBeforePut||!(a=b.row(c).data)?function(){return d.get(c)}:function(){return a}},f=k.then(function(){return c}),g;for(g in e)var n=a(g,e[g]),f=f.then(q(g)).then(n);k.resolve();return f},
revert:function(){this.dirty={};this.refresh()},_trackError:function(a){"string"===typeof a&&(a=h.hitch(this,a));var b=this,d;try{d=f(a())}catch(e){a=new p,a.reject(e),d=a.promise}d.otherwise(function(a){u.call(b,a)});return d},removeRow:function(a,b,d){var e={element:a};!b&&this.noDataMessage&&this.up(e).element===a&&this.down(e).element===a&&(this.noDataNode=g.create("div",{className:"dgrid-no-data",innerHTML:this.noDataMessage},this.contentNode),this._emit("noData"));(e=d&&d.rows||this._rows)&&
delete e[a.rowIndex];return this.inherited(arguments)},renderQueryResults:function(a,b,d){d=h.mixin({rows:this._rows},d);var e=this;return a.then(function(a){a=e.renderArray(a,b,d);delete e._lastCollection;return a})},_observeCollection:function(a,b,d){var e=this,k=d.rows,c,q=[a.on("delete, update",function(a){var q=a.previousIndex,f=a.index;void 0!==q&&k[q]&&("max"in k&&(void 0===f||f<k.min||f>k.max)&&k.max--,c=k[q],c.parentNode===b&&e.removeRow(c,!1,d),k.splice(q,1),("delete"===a.type||"update"===
a.type&&(q<f||void 0===f))&&k[q]&&k[q].rowIndex--);"delete"===a.type&&(c=null)}),a.on("add, update",function(a){var q=a.previousIndex,f=a.index;if(void 0!==f&&(!("max"in k)||f>=k.min&&f<=k.max)){"max"in k&&(void 0===q||q<k.min||q>k.max)&&k.max++;if(k.length){if(q=k[f],!q&&(q=k[f-1]))q=(q.connected||q).nextSibling}else q=e._getFirstRowSibling&&e._getFirstRowSibling(b);c&&q&&c.id===q.id&&(q=(q.connected||q).nextSibling);q&&!q.parentNode&&(q=document.getElementById(q.id));k.splice(f,0,void 0);c=e.insertRow(a.target,
b,q,f,d);e.highlightRow(c)}c=null}),a.on("add, delete, update",function(c){var b="undefined"!==typeof c.previousIndex?c.previousIndex:Infinity,d="undefined"!==typeof c.index?c.index:Infinity,q=Math.min(b,d);b!==d&&k[q]&&e.adjustRowIndices(k[q]);Infinity!==b&&e._processScroll&&(k[b]||k[b-1])&&e._processScroll();e._onNotification(k,c,a);a===e._renderedCollection&&"totalLength"in c&&(e._total=c.totalLength)})];return{remove:function(){for(;0<q.length;)q.pop().remove()}}},_onNotification:function(){}})})},
"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(r,h,p){return r([h,p],{})})},"dgrid/extensions/ColumnReorder":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/dom-class dojo/on dojo/query dojo/dnd/Source".split(" "),function(r,h,p,m,g,n){function l(a,d){var e=d[2],f=a[e?"columnSets":"subRows"][d[1]];return e?f[d[2]]:f}function f(a,d,e){d[2]?a.columnSets[d[1]][d[2]]=e:a.subRows[d[1]]=e}function u(a,d){return d.slice(("dgrid-"+
a+"-").length)}var a=/(\d+)(?:-(\d+))?$/;r=h(n,{copyState:function(){return!1},checkAcceptance:function(a){return a===this},_legalMouseDown:function(a){return-1<a.target.className.indexOf("dgrid-resize-handle")?!1:this.inherited(arguments)},onDropInternal:function(b){var d=this.grid,e=a.exec(u(d.id,b[0].getAttribute("dndType"))),k=e[2]?"columnSets":"subRows",c=l(d,e),q=d.columns;this.inherited(arguments);e&&setTimeout(function(){var a=p.map(b[0].parentNode.childNodes,function(a){return q[a.columnId]});
f(d,e,a);a={grid:d,subRow:a,column:q[b[0].columnId],bubbles:!0,cancelable:!0,parentType:"dnd"};a[k]=d[k];g.emit(d.domNode,"dgrid-columnreorder",a)?d.set(k,d[k]):(f(d,e,c),d.renderHeader(),d.sort.length&&d.updateSortArrow(d.sort))},0)}});h=h("dgrid.ColumnReorder",null,{columnDndConstructor:r,_initSubRowDnd:function(a,d){var e,f,c,q;f=0;for(c=a.length;f<c;f++)q=a[f],!1!==q.reorderable&&(q=q.headerNode,m.add(q,"dojoDndItem"),q.setAttribute("dndType",d),e||(e=q.parentNode));e&&this._columnDndSources.push(new this.columnDndConstructor(e,
{horizontal:!0,grid:this}))},renderHeader:function(){var a="dgrid-"+this.id+"-",d,e;this.inherited(arguments);this._columnDndSources=[];if(this.columnSets)for(e=0,d=this.columnSets.length;e<d;e++)p.forEach(this.columnSets[e],function(d,c){this._initSubRowDnd(d,a+e+"-"+c)},this);else p.forEach(this.subRows,function(d,c){this._initSubRowDnd(d,a+c)},this)},_destroyColumns:function(){this._columnDndSources&&p.forEach(this._columnDndSources,function(a){a&&a.destroy&&a.destroy()});this.inherited(arguments)}});
h.ColumnDndSource=r;return h})},"dgrid/extensions/ColumnResizer":function(){define("dojo/_base/declare dojo/on dojo/query dojo/_base/lang dojo/dom dojo/dom-construct dojo/dom-geometry dojo/has ../util/misc dojo/_base/html".split(" "),function(r,h,p,m,g,n,l,f,u){function a(a){for(var b=a.length,d=b,e=a[0].length,f=Array(b);b--;)f[b]=Array(e);for(var k={},b=0;b<d;b++)for(var g=f[b],n=a[b],l=0,u=0;l<e;l++){var h=n[u],m;if("undefined"===typeof g[l]){g[l]=h.id;if(h.rowSpan&&1<h.rowSpan){m=f;for(var p=
h.rowSpan,r=b,G=l,D=h.id,E=1;E<p;E++)m[r+E][G]=D}if(0<b&&h.colSpan&&1<h.colSpan)for(m=1;m<h.colSpan;m++)if(g[++l]=h.id,h.rowSpan&&1<h.rowSpan)for(var p=f,r=h.rowSpan,G=b,D=l,E=h.id,I=1;I<r;I++)p[G+I][D]=E;k[h.id]=a[0][l].id;u++}}return k}function b(a,b,d,e,f){if(!(0>=d)){var k=a.columns[b],g;if(k&&(g={grid:a,columnId:b,width:d,bubbles:!0,cancelable:!0},e&&(g.parentType=e),!a._resizedColumns||h.emit(a.headerNode,"dgrid-columnresize",g)))return"auto"===d?delete k.width:(k.width=d,d+="px"),(e=a._columnSizes[b])?
e.set("width",d):e=u.addCssRule("#"+u.escapeCssIdentifier(a.domNode.id)+" .dgrid-column-"+u.escapeCssIdentifier(b,"-"),"width: "+d+";"),a._columnSizes[b]=e,!1!==f&&a.resize(),!0}}var d,e=0,k={create:function(){d=n.create("div",{className:"dgrid-column-resizer"})},destroy:function(){n.destroy(d);d=null},show:function(a){a=l.position(a.domNode,!0);d.style.top=a.y+"px";d.style.height=a.h+"px";document.body.appendChild(d)},move:function(a){d.style.left=a+"px"},hide:function(){d.parentNode.removeChild(d)}};
return r("dgrid.ColumnResizer",null,{resizeNode:null,minWidth:40,adjustLastColumn:!0,_resizedColumns:!1,buildRendering:function(){this.inherited(arguments);e||k.create();e++},destroy:function(){this.inherited(arguments);for(var a in this._columnSizes)this._columnSizes[a].remove();--e||k.destroy()},resizeColumnWidth:function(a,d){return b(this,a,d)},configStructure:function(){var a=this._oldColumnSizes=m.mixin({},this._columnSizes),b;this._resizedColumns=!1;this._columnSizes={};this.inherited(arguments);
for(b in a)b in this._columnSizes||a[b].remove();delete this._oldColumnSizes},_configColumn:function(a){this.inherited(arguments);var b=a.id,d;"width"in a&&((d=this._oldColumnSizes[b])?d.set("width",a.width+"px"):d=u.addCssRule("#"+u.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+u.escapeCssIdentifier(b,"-"),"width: "+a.width+"px;"),this._columnSizes[b]=d)},renderHeader:function(){this.inherited(arguments);var c=this,b;if(this.columnSets&&this.columnSets.length)for(var d=this.columnSets.length;d--;)b=
m.mixin(b||{},a(this.columnSets[d]));else this.subRows&&1<this.subRows.length&&(b=a(this.subRows));for(var d=p(".dgrid-cell",c.headerNode),e=d.length;e--;){var k=d[e],g=k.columnId,l=c.columns[g],r=k.childNodes;if(l&&!1!==l.resizable){l=n.create("div",{className:"dgrid-resize-header-container"});for(k.contents=l;0<r.length;)l.appendChild(r[0]);r=n.create("div",{className:"dgrid-resize-handle resizeNode-"+u.escapeCssIdentifier(g,"-")},l);k.appendChild(l);r.columnId=b&&b[g]||g}}c.mouseMoveListen||(h(c.headerNode,
".dgrid-resize-handle:mousedown"+(f("touch")?",.dgrid-resize-handle:touchstart":""),function(a){c._resizeMouseDown(a,this);c.mouseMoveListen.resume();c.mouseUpListen.resume()}),c._listeners.push(c.mouseMoveListen=h.pausable(document,"mousemove"+(f("touch")?",touchmove":""),u.throttleDelayed(function(a){c._updateResizerPosition(a)}))),c._listeners.push(c.mouseUpListen=h.pausable(document,"mouseup"+(f("touch")?",touchend":""),function(a){c._resizeMouseUp(a);c.mouseMoveListen.pause();c.mouseUpListen.pause()})),
c.mouseMoveListen.pause(),c.mouseUpListen.pause())},_resizeMouseDown:function(a,b){a.preventDefault();g.setSelectable(this.domNode,!1);this._startX=this._getResizeMouseLocation(a);this._targetCell=p(".dgrid-column-"+u.escapeCssIdentifier(b.columnId,"-"),this.headerNode)[0];this._updateResizerPosition(a);k.show(this)},_resizeMouseUp:function(a){var d=this._columnSizes,e,f,n;this.adjustLastColumn&&(n=this.headerNode.clientWidth-1);this._resizedColumns||(e=p(".dgrid-cell",this.headerNode),this.columnSets&&
this.columnSets.length?e=e.filter(function(a){return"0"===a.columnId.split("-")[0]&&!(a.columnId in d)}):this.subRows&&1<this.subRows.length&&(e=e.filter(function(a){return"0"===a.columnId.charAt(0)&&!(a.columnId in d)})),f=e.map(function(a){return a.offsetWidth}),e.forEach(function(a,c){b(this,a.columnId,f[c],null,!1)},this),this._resizedColumns=!0);g.setSelectable(this.domNode,!0);e=this._targetCell;var l=this._getResizeMouseLocation(a)-this._startX,h=e.offsetWidth+l,m=this._getResizedColumnWidths(),
v=m.totalWidth,m=m.lastColId,r=p(".dgrid-column-"+u.escapeCssIdentifier(m,"-"),this.headerNode)[0].offsetWidth;h<this.minWidth&&(h=this.minWidth);b(this,e.columnId,h,a.type)&&e.columnId!==m&&this.adjustLastColumn&&(v+l<n?b(this,m,"auto",a.type):r-l<=this.minWidth&&b(this,m,this.minWidth,a.type));k.hide();delete this._startX;delete this._targetCell},_updateResizerPosition:function(a){if(this._targetCell){a=this._getResizeMouseLocation(a);var b=this._targetCell.offsetWidth,d=a;b+(a-this._startX)<this.minWidth&&
(d=this._startX-(b-this.minWidth));k.move(d)}},_getResizeMouseLocation:function(a){var b=0;a.pageX?b=a.pageX:a.clientX&&(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft);return b},_getResizedColumnWidths:function(){var a=0,b=p((this.columnSets?".dgrid-column-set-cell ":"")+"tr:first-child .dgrid-cell",this.headerNode),d=b.length;if(!d)return{};for(var e=b[d-1].columnId;d--;)a+=b[d].offsetWidth;return{totalWidth:a,lastColId:e}}})})},"dgrid/extensions/CompoundColumns":function(){define(["dojo/_base/lang",
"dojo/_base/declare","dojo/sniff","dojo/query","../util/misc"],function(r,h,p,m,g){return h(null,{configStructure:function(){function n(c,b,d,e){var k=0,l=function(){},m,p;g.each(c,function(g,K){"string"===typeof g&&(g={label:g});c instanceof Array||g.field||(g.field=K);p=(m=g.children)&&!1!==g.showChildHeaders;g.parentColumn=e;m?null==g.id?g.id=(e&&e.id||b-1)+"-"+h.length:e&&e.id&&(g.id=e.id+"-"+g.id):(a.push(g),h.push(r.delegate(g,{renderHeaderCell:l})),k++);p||(g=r.delegate(g,{rowSpan:-b}));m&&
(k+=g.colSpan=n(m,b+1,p,g));d&&(f[b]||(f[b]=[])).push(g)},this);return k}var l=this.subRows&&this.subRows[0]||this.columns,f=[[]],h=f[0],a=[];f[0].className="dgrid-spacer-row";n(l,1,!0);var l=f.length,b,d,e,k;for(b=0;b<l;b++)for(e=f[b],d=0;d<e.length;d++)k=e[d],1>k.rowSpan&&(k.rowSpan+=l);a=[a];a.headerRows=f;this.subRows=a;this.inherited(arguments)},renderHeader:function(){var g,l=this.subRows[0],f=this.subRows.headerRows[0];this.inherited(arguments);for(g=l.length;g--;)l[g].headerNode=f[g].headerNode},
_findSortArrowParent:function(){var n=this.inherited(arguments);if(n&&g.contains(m(".dgrid-spacer-row",this.headerNode)[0],n))return n=n.columnId||n.parentNode.columnId,n=m(".dgrid-column-"+n,this.headerNode),n[n.length-1]},_configColumn:function(g,l,f){var h=g.parentColumn,a=g.id;h&&(a=0===a.indexOf(f)?a.substring(f.length):a,f=h.id+"-",g.id=f+a);this.inherited(arguments,[g,l,f])},cell:function(g,l){if("object"!==typeof l){var f=this.column(l);f&&(l=f.id)}return this.inherited(arguments,[g,l])},
column:function(g){var l=this.inherited(arguments);if(null==l&&"object"!==typeof g){var f="-"+g,h=f.length,a;for(a in this.columns)if(-1!==a.indexOf(f,a.length-h))return this.columns[a]}return l},_updateCompoundHiddenStates:function(g,l){var f=this.columns[g],h;if(!f||f.hidden!==l)for(;f&&f.parentColumn;){f=f.parentColumn;if(h=f.colSpan+=l?-1:1)f.headerNode.colSpan=h;1!==h||l?!h&&l&&this._hideColumn(f.id):this._showColumn(f.id)}},_hideColumn:function(g){var l=this;this._updateCompoundHiddenStates(g,
!0);this.inherited(arguments);p("ff")&&(this.headerNode.style.display="none",setTimeout(function(){l.headerNode.style.display="";l.resize()},0))},_showColumn:function(g){this._updateCompoundHiddenStates(g,!1);this.inherited(arguments)},_getResizedColumnWidths:function(){var g=0,l=this.columns,f;for(f in l)g+=l[f].headerNode.offsetWidth;return{totalWidth:g,lastColId:this.subRows[0][this.subRows[0].length-1].id}}})})},"dgrid/extensions/Pagination":function(){define("../_StoreMixin dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on dojo/query dojo/string dojo/has dojo/when ../util/misc dojo/_base/sniff".split(" "),
function(r,h,p,m,g,n,l,f,u,a,b,d){function e(a){a.noDataNode?(g.destroy(a.noDataNode),delete a.noDataNode):a.cleanup();a.contentNode.innerHTML=""}function k(a){if(a.loadingNode)g.destroy(a.loadingNode),delete a.loadingNode;else if(a._oldPageNodes){for(var b in a._oldPageNodes)a.removeRow(a._oldPageNodes[b]);delete a._oldPageNodes}delete a._isLoading}return h(r,{rowsPerPage:10,pagingTextBox:!1,previousNextArrows:!0,firstLastArrows:!1,pagingLinks:2,pageSizeOptions:null,showLoadingMessage:!0,i18nPagination:{status:"${start} - ${end} of ${total} results",
gotoFirst:"Go to first page",gotoNext:"Go to next page",gotoPrev:"Go to previous page",gotoLast:"Go to last page",gotoPage:"Go to page",jumpPage:"Jump to page",rowsPerPage:"Number of rows per page"},showFooter:!0,_currentPage:1,buildRendering:function(){this.inherited(arguments);var a=this,b=this.paginationNode=g.create("div",{className:"dgrid-pagination"},this.footerNode),d=this.paginationStatusNode=g.create("div",{className:"dgrid-status"},b),e=this.i18nPagination;d.tabIndex=0;this.addUiClasses&&
n.add(this.footerNode,"ui-widget-content");this._updatePaginationSizeSelect();this._updateRowsPerPageOption();this._updatePaginationStatus(this._total);b=this.paginationNavigationNode=g.create("div",{className:"dgrid-navigation"},b);this.firstLastArrows&&(this.paginationFirstNode=g.create("span",{"aria-label":e.gotoFirst,className:"dgrid-first dgrid-page-link",innerHTML:"\u00ab",tabIndex:0},b));this.previousNextArrows&&(this.paginationPreviousNode=g.create("span",{"aria-label":e.gotoPrev,className:"dgrid-previous dgrid-page-link",
innerHTML:"\u2039",tabIndex:0},b));this.paginationLinksNode=g.create("span",{className:"dgrid-pagination-links"},b);this.previousNextArrows&&(this.paginationNextNode=g.create("span",{"aria-label":e.gotoNext,className:"dgrid-next dgrid-page-link",innerHTML:"\u203a",tabIndex:0},b));this.firstLastArrows&&(this.paginationLastNode=g.create("span",{"aria-label":e.gotoLast,className:"dgrid-last dgrid-page-link",innerHTML:"\u00bb",tabIndex:0},b));this._listeners.push(l(b,".dgrid-page-link:click,.dgrid-page-link:keydown",
function(b){if("keydown"!==b.type||13===b.keyCode){b=this.className;var d,e;a._isLoading||-1<b.indexOf("dgrid-page-disabled")||(d=a._currentPage,e=Math.ceil(a._total/a.rowsPerPage),this===a.paginationPreviousNode?a.gotoPage(d-1):this===a.paginationNextNode?a.gotoPage(d+1):this===a.paginationFirstNode?a.gotoPage(1):this===a.paginationLastNode?a.gotoPage(e):"dgrid-page-link"===b&&a.gotoPage(+this.innerHTML))}}))},destroy:function(){this.inherited(arguments);this._pagingTextBoxHandle&&this._pagingTextBoxHandle.remove()},
_updatePaginationSizeSelect:function(){var a=this.pageSizeOptions,b=this.paginationSizeSelect,d;if(a&&a.length){b||(b=this.paginationSizeSelect=g.create("select",{"aria-label":this.i18nPagination.rowsPerPage,className:"dgrid-page-size"},this.paginationNode),d=this._paginationSizeChangeHandle=l(b,"change",m.hitch(this,function(){this.set("rowsPerPage",+this.paginationSizeSelect.value)})),this._listeners.push(d));for(d=b.options.length=0;d<a.length;d++)g.create("option",{innerHTML:a[d],selected:this.rowsPerPage===
a[d],value:a[d]},b);this._updateRowsPerPageOption()}else a&&a.length||!b||(g.destroy(b),this.paginationSizeSelect=null,this._paginationSizeChangeHandle.remove())},_setPageSizeOptions:function(a){this.pageSizeOptions=a&&a.sort(function(a,b){return a-b});this._updatePaginationSizeSelect()},_updateRowsPerPageOption:function(){var a=this.rowsPerPage,b=this.pageSizeOptions,d=this.paginationSizeSelect;d&&(0>p.indexOf(b,a)?this._setPageSizeOptions(b.concat([a])):d.value=""+a)},_setRowsPerPage:function(a){this.rowsPerPage=
a;this._updateRowsPerPageOption();this.gotoPage(1)},_updateNavigation:function(a){function b(a,c){var d,e;h.pagingTextBox&&a===p&&1<w?(d=g.create("input",{"aria-label":m.jumpPage,className:"dgrid-page-input",type:"text",value:p},u),h._pagingTextBoxHandle=l(d,"change",function(){var a=+this.value;!isNaN(a)&&0<a&&a<=w&&h.gotoPage(+this.value)}),x&&"INPUT"===x.tagName&&d.focus()):(e=a===p,d=g.create("span",{"aria-label":m.gotoPage,className:"dgrid-page-link"+(e?" dgrid-page-disabled":""),innerHTML:a+
(c?" ":""),tabIndex:e?-1:0},u),H===a&&(e?a<w?H++:F.focus():d.focus()),e||(F=d))}function e(a,b){n.toggle(a,"dgrid-page-disabled",b);a.tabIndex=b?-1:0}function k(){g.create("span",{className:"dgrid-page-skip",innerHTML:"..."},u)}var h=this,m=this.i18nPagination,u=this.paginationLinksNode,p=this._currentPage,v=this.pagingLinks,r=this.paginationNavigationNode,w=Math.ceil(a/this.rowsPerPage);a=this._pagingTextBoxHandle;var x=document.activeElement,H,F;x&&d.contains(this.paginationNavigationNode,x)?"dgrid-page-link"===
x.className&&(H=+x.innerHTML):x=null;a&&a.remove();u.innerHTML="";f(".dgrid-first, .dgrid-previous",r).forEach(function(a){e(a,1===p)});f(".dgrid-last, .dgrid-next",r).forEach(function(a){e(a,p>=w)});if(v&&0<w){b(1,!0);r=p-v;for(2<r?k():r=2;r<Math.min(p+v+1,w);r++)b(r,!0);p+v+1<w&&k();1<w&&b(w)}else h.pagingTextBox&&b(p);x&&-1===x.tabIndex&&(v=f('[tabindex\x3d"0"]',this.paginationNavigationNode),x===this.paginationPreviousNode||x===this.paginationFirstNode?x=v[0]:v.length&&(x=v[v.length-1]),x&&x.focus())},
_updatePaginationStatus:function(a){var b=this.rowsPerPage,d=Math.min(a,(this._currentPage-1)*b+1);this.paginationStatusNode.innerHTML=u.substitute(this.i18nPagination.status,{start:d,end:Math.min(a,d+b-1),total:a})},refresh:function(a){var b=this,d=a&&a.keepCurrentPage?Math.min(this._currentPage,Math.ceil(this._total/this.rowsPerPage)):1;this.inherited(arguments);return this.gotoPage(d).then(function(a){setTimeout(function(){l.emit(b.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:b})},
0);return a})},_onNotification:function(a,b,d){a=this.rowsPerPage;var e=this._currentPage*a;"add"===b.type&&b.index<e||"delete"===b.type&&b.previousIndex<e||"update"===b.type&&Math.floor(b.index/a)!==Math.floor(b.previousIndex/a)?this.gotoPage(Math.min(this._currentPage,Math.ceil(b.totalLength/this.rowsPerPage))):d===this._renderedCollection&&b.totalLength!==this._total&&(this._updatePaginationStatus(b.totalLength),this._updateNavigation(b.totalLength))},renderQueryResults:function(a,b){var d=this,
e=this.inherited(arguments);b||(this._topLevelRequest&&(this._topLevelRequest.cancel(),delete this._topLevelRequest),"function"===typeof e.cancel&&(this._topLevelRequest=e),e.then(function(){d._topLevelRequest&&delete d._topLevelRequest}));return e},insertRow:function(){var a=this._oldPageNodes,b=this.inherited(arguments);a&&b===a[b.id]&&delete a[b.id];return b},gotoPage:function(a){var d=this,f=(this._currentPage-1)*this.rowsPerPage;if(!this._renderedCollection)return b([]);this._renderedCollection.releaseRange&&
this._renderedCollection.releaseRange(f,f+this.rowsPerPage);return this._trackError(function(){var b=d.rowsPerPage,f=(a-1)*b,l={start:f,count:b},n,h=d.contentNode,t,m,u;if(d.showLoadingMessage)e(d),d.loadingNode=g.create("div",{className:"dgrid-loading",innerHTML:d.loadingMessage},h);else for(d._oldPageNodes=t={},h=h.children,m=0,u=h.length;m<u;m++)t[h[m].id]=h[m];d._isLoading=!0;n=d._renderedCollection.fetchRange({start:f,end:f+b});return d.renderQueryResults(n,null,l).then(function(e){k(d);d.scrollTo({y:0});
d._rows&&(d._rows.min=f,d._rows.max=f+b-1);n.totalLength.then(function(b){b||(d.noDataNode&&(g.destroy(d.noDataNode),delete d.noDataNode),d.noDataNode=g.create("div",{className:"dgrid-no-data",innerHTML:d.noDataMessage},d.contentNode));d._total=b;d._currentPage=a;d._rowsOnPage=e.length;d._updatePaginationStatus(b);d._updateNavigation(b)});return n},function(a){k(d);throw a;})})}})})},"dgrid/extensions/DnD":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/aspect dojo/dom-class dojo/on dojo/topic dojo/has dojo/when dojo/dnd/Source dojo/dnd/Manager dojo/_base/NodeList ../Selection dojo/has!touch?../util/touch dojo/has!touch?./_DnD-touch-autoscroll".split(" "),
function(r,h,p,m,g,n,l,f,u,a,b,d,e,k){var c=r(a,{grid:null,getObject:function(a){var b=this.grid;return b.collection.get(a.id.slice(b.id.length+5))},_legalMouseDown:function(a){return this.inherited(arguments)&&a.target!==this.grid.bodyNode},onDrop:function(a,b,c){var d=this,e=this._targetAnchor=this.targetAnchor,f=this.grid,k=f.collection;!this.before&&e&&(e=e.nextSibling);e=e&&f.row(e);u(e&&k.get(e.id),function(e){if(d!==a)d.onDropExternal(a,b,c,e);else d.onDropInternal(b,c,e)})},onDropInternal:function(a,
b,c){var d=this.grid,e=d.collection,f=this,k=f._targetAnchor,g;k&&(g=this.before?k.previousSibling:k.nextSibling);k=d.row(a[0]);(b||g!==a[0]&&(c||!k||d.down(k).element!==a[0]))&&a.forEach(function(a){u(f.getObject(a),function(a){var k=e.getIdentity(a);e[b&&e.copy?"copy":"put"](a,{beforeId:c?e.getIdentity(c):null});f._selectedNodes[k]&&(f._selectedNodes[k]=d.row(k).element)})})},onDropExternal:function(a,b,c,d){var e=this.grid.collection,f=a.grid;b.forEach(function(b,k){u(a.getObject(b),function(g){c||
(f?u(f.collection.getIdentity(g),function(c){!k&&a.selectNone();a.delItem(b.id);f.collection.remove(c)}):a.deleteSelectedNodes());e[e.copy?"copy":"put"](g,{beforeId:d?e.getIdentity(d):null})})})},onDndStart:function(a){this.inherited(arguments);a===this&&(this.grid.cancelTouchScroll&&this.grid.cancelTouchScroll(),b.manager().avatar.node.style.width=this.grid.domNode.offsetWidth/2+"px")},onMouseDown:function(a){f("touch")&&this.isDragging&&1<k.countCurrentTouches(a,this.grid.touchNode)?(l.publish("/dnd/cancel"),
b.manager().stopDrag()):this.inherited(arguments)},onMouseMove:function(a){(!f("touch")||1>=k.countCurrentTouches(a,this.grid.touchNode))&&this.inherited(arguments)},checkAcceptance:function(b){return b.getObject&&a.prototype.checkAcceptance.apply(this,arguments)},getSelectedNodes:function(){if(!this.grid.selection)return this.inherited(arguments);var a=new d,b;for(b in this.grid.selection)a.push(this._selectedNodes[b]);return a}});r=r(e,{dndSourceType:"dgrid-row",dndParams:null,dndConstructor:c,
postMixInProperties:function(){this.inherited(arguments);this.dndParams=h.mixin({accept:[this.dndSourceType]},this.dndParams)},postCreate:function(){function a(b){d[b.id]=b.element}function b(a){delete d[a.id];g.remove(a.element,"dojoDndItemSelected dojoDndItemAnchor")}this.inherited(arguments);this.dndSource=new (this.dndConstructor||c)(this.bodyNode,h.mixin(this.dndParams,{grid:this,dropParent:this.contentNode}));var d=this.dndSource._selectedNodes={};this.on("dgrid-select",function(b){p.forEach(b.rows,
a)});this.on("dgrid-deselect",function(a){p.forEach(a.rows,b)});m.after(this,"destroy",function(){delete this.dndSource._selectedNodes;d=null;this.dndSource.destroy()},!0)},insertRow:function(a){var b=this.inherited(arguments),c="function"===typeof this.getObjectDndType?this.getObjectDndType(a):[this.dndSourceType];g.add(b,"dojoDndItem");this.dndSource.setItem(b.id,{data:a,type:c instanceof Array?c:[c]});return b},removeRow:function(a){this.dndSource.delItem(this.row(a));this.inherited(arguments)}});
r.GridSource=c;return r})},"dgrid/Editor":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/dom-construct dojo/dom-class dojo/on dojo/has dojo/query ./Grid dojo/_base/sniff".split(" "),function(r,h,p,m,g,n,l,f,u){return r(null,{constructor:function(){this._editorInstances={};this._editorColumnListeners=[];this._editorCellListeners={};this._editorsPendingStartup=[]},postCreate:function(){var a=this;this.inherited(arguments);this.on(".dgrid-input:focusin",function(){a._focusedEditorCell=
a.cell(this)});this._editorFocusoutHandle=n.pausable(this.domNode,".dgrid-input:focusout",function(){a._focusedEditorCell=null});this._listeners.push(this._editorFocusoutHandle)},insertRow:function(){this._editorRowListeners={};var a=this.inherited(arguments),b=this.row(a),d=this._editorCellListeners[a.id]=this._editorCellListeners[a.id]||{},e;for(e in this._editorRowListeners)d[e]=this._editorRowListeners[e];this._editorRowListeners=null;(d=this._previouslyFocusedEditorCell)&&d.row.id===b.id&&this.edit(this.cell(b,
d.column.id));return a},refresh:function(){for(var a in this._editorInstances){var b=this._editorInstances[a].domNode;b&&b.parentNode&&b.parentNode.removeChild(b)}this.inherited(arguments)},removeRow:function(a){var b=this,d=this._focusedEditorCell;d&&d.row.id===this.row(a).id&&(this._previouslyFocusedEditorCell=d,this._editorFocusoutHandle.pause(),setTimeout(function(){b._editorFocusoutHandle.resume();b._previouslyFocusedEditorCell=null},0));if(this._editorCellListeners[a.id]){for(var e in this._editorCellListeners[a.id])this._editorCellListeners[a.id][e].remove();
delete this._editorCellListeners[a.id]}for(d=this._alwaysOnWidgetColumns.length;d--;)if(e=(e=this.cell(a,this._alwaysOnWidgetColumns[d].id).element)&&(e.contents||e).widget)this._editorFocusoutHandle.pause(),e.destroyRecursive();return this.inherited(arguments)},renderArray:function(){var a=this.inherited(arguments);a.length?this._startupPendingEditors():this._editorsPendingStartup=[];return a},_onNotification:function(){this.inherited(arguments);this._startupPendingEditors()},_destroyColumns:function(){this._editorStructureCleanup();
this.inherited(arguments)},_editorStructureCleanup:function(){var a=this._editorInstances,b=this._editorColumnListeners;this._editTimer&&clearTimeout(this._editTimer);for(var d in a){var e=a[d];e.domNode&&e.destroyRecursive()}this._editorInstances={};for(a=b.length;a--;)b[a].remove();for(var f in this._editorCellListeners)for(d in this._editorCellListeners[f])this._editorCellListeners[f][d].remove();for(a=0;a<this._editorColumnListeners.length;a++)this._editorColumnListeners[a].remove();this._editorCellListeners=
{};this._editorColumnListeners=[];this._editorsPendingStartup=[]},_configColumns:function(){var a=this.inherited(arguments);this._alwaysOnWidgetColumns=[];for(var b=0,d=a.length;b<d;b++)a[b].editor&&this._configureEditorColumn(a[b]);return a},_configureEditorColumn:function(a){var b=this,d=a.renderCell||this._defaultRenderCell,e=a.editOn,f="string"!==typeof a.editor;e?this._editorInstances[a.id]=this._createSharedEditor(a,d):f&&this._alwaysOnWidgetColumns.push(a);a.renderCell=e?function(c,f,k,g){if(!g||
!g.alreadyHooked){var l=n(k,e,function(){b._activeOptions=g;b.edit(this)});if(b._editorRowListeners)b._editorRowListeners[a.id]=l;else{var h=b.row(c);b._editorCellListeners[h.element.id][a.id]=l}}return d.call(a,c,f,k,g)}:function(c,e,g,l){if(!a.canEdit||a.canEdit(c,e))l=b._createEditor(a),l.object=c,b._showEditor(l,a,g,e),g[f?"widget":"input"]=l;else return d.call(a,c,e,g,l)}},edit:function(a){function b(a){d._activeCell=f;d._showEditor(n,e,f,l);d._editTimer=setTimeout(function(){n.focus&&n.focus();
e._editorBlurHandle&&e._editorBlurHandle.resume();d._editTimer=null;a.resolve(n)},0)}var d=this,e,f,c,g,l,n,h;a.column||(a=this.cell(a));if(!a||!a.element)return null;e=a.column;g=e.field;f=a.element.contents||a.element;if(n=this._editorInstances[e.id]){if(this._activeCell!==f){var m=a.row;l=(c=this.dirty&&this.dirty[m.id])&&g in c?c[g]:e.get?e.get(m.data):m.data[g];if(!e.canEdit||e.canEdit(a.row.data,l))return h=new p,a=n.domNode||n,a.offsetWidth?(a.blur(),setTimeout(function(){b(h)},0)):b(h),h.promise}}else if(e.editor&&
(n=f.widget||f.input))return h=new p,n.focus&&n.focus(),h.resolve(n),h.promise;return null},refreshCell:function(a){var b=a.row.element.id,d=a.column.id;this._editorCellListeners[b]&&this._editorCellListeners[b][d]&&(this._editorCellListeners[b][d].remove(),this._editorCellListeners[b][d]=null);return this.inherited(arguments)},_showEditor:function(a,b,d,e){var f=a.domNode;f||this._updateInputValue(a,e);d.innerHTML="";g.add(d,"dgrid-cell-editing");f&&b.editOn&&a.validate&&a.reset&&a.reset();d.appendChild(a.domNode||
a);f&&!b.editOn?this._editorsPendingStartup.push([a,b,d,e]):this._startupEditor(a,b,d,e)},_startupEditor:function(a,b,d,e){a.domNode&&(a._started||a.startup(),a._dgridIgnoreChange=!0,a.set("value",e),setTimeout(function(){a._dgridIgnoreChange=!1},0));a._dgridLastValue=e;this._activeCell&&(this._activeValue=e,n.emit(d,"dgrid-editor-show",{grid:this,cell:this.cell(d),column:b,editor:a,bubbles:!0,cancelable:!1}))},_startupPendingEditors:function(){for(var a=this._editorsPendingStartup,b=a.length;b--;)this._startupEditor.apply(this,
a[b]);this._editorsPendingStartup=[]},_handleEditorChange:function(a,b){var d=a.target;"_dgridLastValue"in d&&-1<d.className.indexOf("dgrid-input")&&this._updatePropertyFromEditor(b||this.cell(d).column,d,a)},_createEditor:function(a){var b=a.editor,d=a.editOn,e=this,f="string"!==typeof b&&b,c,g,u={};c=a.editorArgs||{};"function"===typeof c&&(c=c.call(this,a));f?(g=new f(c),c=g.focusNode||g.domNode,c.className+=" dgrid-input",g.on(d?"blur":"change",function(){g._dgridIgnoreChange||e._updatePropertyFromEditor(a,
this,{type:"widget"})})):(this._hasInputListener||(this._hasInputListener=!0,this.on("change",function(a){e._handleEditorChange(a)})),"textarea"===b?f="textarea":(f="input",u.type=b),g=c=m.create(f,h.mixin(u,{className:"dgrid-input",name:a.field,tabIndex:isNaN(a.tabIndex)?-1:a.tabIndex},c)),9>l("ie")&&(b="radio"===b||"checkbox"===b?n(g,"click",function(b){e._handleEditorChange(b,a)}):n(g,"change",function(b){e._handleEditorChange(b,a)}),d?this._editorColumnListeners.push(b):this._editorRowListeners?
this._editorRowListeners[a.id]=b:this._editorCellListeners[this.row(object).element.id][a.id]=b));if(a.autoSelect){var p=g.focusNode||g;p.select&&n(p,"focus",function(){setTimeout(function(){p.select()},0)})}return g},_createSharedEditor:function(a){function b(){var a=e._activeCell;q.blur();"function"===typeof e.focus&&setTimeout(function(){e.focus(a)},f&&9>l("ie")?15:0)}var d=this._createEditor(a),e=this,f=d.domNode,c=d.domNode||d,q=d.focusNode||c,p=f?function(){d.set("value",d._dgridLastValue)}:
function(){e._updateInputValue(d,d._dgridLastValue);e._updatePropertyFromEditor(a,d)};this._editorColumnListeners.push(n(q,"keydown",function(c){c=c.keyCode||c.which;27===c?(p(),e._activeValue=d._dgridLastValue,b()):13===c&&!1!==a.dismissOnEnter&&b()}));(a._editorBlurHandle=n.pausable(d,"blur",function(){var b=c.parentNode,f={alreadyHooked:!0},k=e.cell(c);n.emit(k.element,"dgrid-editor-hide",{grid:e,cell:k,column:a,editor:d,bubbles:!0,cancelable:!1});a._editorBlurHandle.pause();b.removeChild(c);k.row&&
(g.remove(k.element,"dgrid-cell-editing"),m.empty(b),u.appendIfNode(b,a.renderCell(k.row.data,e._activeValue,b,e._activeOptions?h.delegate(f,e._activeOptions):f)));e._focusedEditorCell=e._activeCell=e._activeValue=e._activeOptions=null})).pause();this._editorColumnListeners.push(a._editorBlurHandle);return d},_updatePropertyFromEditor:function(a,b,d){var e;if(!b.isValid||b.isValid())if(d=this._updateProperty((b.domNode||b).parentNode,this._activeCell?this._activeValue:b._dgridLastValue,this._retrieveEditorValue(a,
b),d),this._activeCell?this._activeValue=d:b._dgridLastValue=d,"radio"===b.type&&b.name&&!a.editOn&&a.field)for(e in d=this.row(b),f("input[type\x3dradio][name\x3d"+b.name+"]",this.contentNode).forEach(function(d){var c=this.row(d);d!==b&&d._dgridLastValue&&(d._dgridLastValue=!1,this.updateDirty?this.updateDirty(c.id,a.field,!1):c.data[a.field]=!1)},this),this.dirty)d.id.toString()!==e&&this.dirty[e][a.field]&&this.updateDirty(e,a.field,!1)},_updateProperty:function(a,b,d,e){var f=this;if((b&&b.valueOf())!==
(d&&d.valueOf())){var c=this.cell(a),g=c.row,l=c.column;a=c.element;if(l.field&&g)if(c={grid:this,cell:c,oldValue:b,value:d,bubbles:!0,cancelable:!0},e&&e.type&&(c.parentType=e.type),n.emit(a,"dgrid-datachange",c))this.updateDirty?(this.updateDirty(g.id,l.field,d),l.autoSave&&setTimeout(function(){f._trackError("save")},0)):g.data[l.field]=d;else{var h;(h=a.widget)?(h._dgridIgnoreChange=!0,h.set("value",b),setTimeout(function(){h._dgridIgnoreChange=!1},0)):(h=a.input)&&this._updateInputValue(h,b);
return b}}return d},_updateInputValue:function(a,b){a.value=b;if("radio"===a.type||"checkbox"===a.type)a.checked=a.defaultChecked=!!b},_retrieveEditorValue:function(a,b){return"function"===typeof b.get?this._convertEditorValue(b.get("value")):this._convertEditorValue(b["checkbox"===b.type||"radio"===b.type?"checked":"value"])},_convertEditorValue:function(a,b){if("number"===typeof b)a=isNaN(a)?a:parseFloat(a);else if("boolean"===typeof b)a="true"===a?!0:"false"===a?!1:a;else if(b instanceof Date){var d=
new Date(a);a=isNaN(d.getTime())?a:d}return a}})})},"dstore/Store":function(){define("dojo/_base/lang dojo/_base/array dojo/aspect dojo/has dojo/when dojo/Deferred dojo/_base/declare dstore/QueryMethod dstore/Filter dojo/Evented".split(" "),function(r,h,p,m,g,n,l,f,u,a){function b(a){return function(b,c){var d=this;g(b,function(b){b={target:b};var f=c[1]||{};"beforeId"in f&&(b.beforeId=f.beforeId);d.emit(a,b)});return b}}m.add("object-proto",!!{}.__proto__&&!{}.watch);var d=m("object-proto");return l(a,
{constructor:function(d){d&&l.safeMixin(this,d);this.Model&&this.Model.createSubclass&&(this.Model=this.Model.createSubclass([]).extend({_store:this}));this.storage=new a;var f=this;this.autoEmitEvents&&(p.after(this,"add",b("add")),p.after(this,"put",b("update")),p.after(this,"remove",function(a,b){g(a,function(){f.emit("delete",{id:b[0]})});return a}))},autoEmitEvents:!0,idProperty:"id",queryAccessors:!0,getIdentity:function(a){return a.get?a.get(this.idProperty):a[this.idProperty]},_setIdentity:function(a,
b){a.set?a.set(this.idProperty,b):a[this.idProperty]=b},forEach:function(a,b){var c=this;return g(this.fetch(),function(d){for(var f=0,g;void 0!==(g=d[f]);f++)a.call(b,g,f,c);return d})},on:function(a,b){return this.storage.on(a,b)},emit:function(a,b){b=b||{};b.type=a;try{return this.storage.emit(a,b)}finally{return b.cancelable}},parse:null,stringify:null,Model:null,_restore:function(a,b){var c=this.Model;if(c&&a){var f=c.prototype,g=f._restore;g?a=g.call(a,c,b):d&&b?a.__proto__=f:a=r.delegate(f,
a)}return a},create:function(a){return new this.Model(a)},_createSubCollection:function(a){var b=r.delegate(this.constructor.prototype),c;for(c in this)this._includePropertyInSubCollection(c,b)&&(b[c]=this[c]);return l.safeMixin(b,a)},_includePropertyInSubCollection:function(a,b){return!(a in b)||b[a]!==this[a]},queryLog:[],filter:new f({type:"filter",normalizeArguments:function(a){var b=this.Filter;return a instanceof b?[a]:[new b(a)]}}),Filter:u,sort:new f({type:"sort",normalizeArguments:function(a,
b){var c;"function"===typeof a?c=[a]:(c=a instanceof Array?a.slice():"object"===typeof a?[].slice.call(arguments):[{property:a,descending:b}],c=h.map(c,function(a){a=r.mixin({},a);a.descending=!!a.descending;return a}),c=[c]);return c}}),select:new f({type:"select"}),_getQuerierFactory:function(a){return this["_create"+(a[0].toUpperCase()+a.substr(1))+"Querier"]}})})},"dstore/QueryMethod":function(){define([],function(){return function(r){var h=r.type,p=r.normalizeArguments,m=r.applyQuery,g=r.querierFactory;
return function(){var n=Array.prototype.slice.call(arguments),l=p?p.apply(this,n):n,n={type:h,arguments:n,normalizedArguments:l},f=this._getQuerierFactory(h)||g;f&&(n.querier=f.apply(this,l));l=this._createSubCollection({queryLog:this.queryLog.concat(n)});return m?m.call(this,l,n):l}}})},"dstore/Filter":function(){define(["dojo/_base/declare"],function(r){function h(p){return function(){var m=this.constructor,g=new m;g.type=p;g.args=arguments;return this.type?h("and").call(m.prototype,this,g):g}}
r=r(null,{constructor:function(h){var m=typeof h;switch(m){case "object":var m=this,g;for(g in h)var n=h[g],m=n instanceof this.constructor?m[n.type](g,n.args[0]):n&&n.test?m.match(g,n):m.eq(g,n);this.type=m.type;this.args=m.args;break;case "function":case "string":this.type=m,this.args=[h]}},and:h("and"),or:h("or"),eq:h("eq"),ne:h("ne"),lt:h("lt"),lte:h("lte"),gt:h("gt"),gte:h("gte"),contains:h("contains"),"in":h("in"),match:h("match")});r.filterCreator=h;return r})},"dstore/Memory":function(){define("dojo/_base/declare dojo/_base/array ./Store ./Promised ./SimpleQuery ./QueryResults".split(" "),
function(r,h,p,m,g,n){return r([p,m,g],{constructor:function(){this.storage.version=0},postscript:function(){this.inherited(arguments);this.setData(this.data||[])},data:null,autoEmitEvents:!1,getSync:function(g){return this.storage.fullData[this.storage.index[g]]},putSync:function(g,f){f=f||{};var n=this.storage,a=n.index,b=n.fullData,d=this.Model;!d||g instanceof d||(g=this._restore(g));var e=this.getIdentity(g);null==e&&(this._setIdentity(g,"id"in f?f.id:Math.random()),e=this.getIdentity(g));n.version++;
var n=e in a?"update":"add",d={target:g},k;if("update"===n){if(!1===f.overwrite)throw Error("Object already exists");b.splice(k=a[e],1);e=k}else e=this.defaultNewToStart?0:b.length;var c;if("beforeId"in f){var h=f.beforeId;null===h?c=b.length:(c=a[h],k<c&&--c);void 0!==c?d.beforeId=h:(console.error("options.beforeId was specified but no corresponding index was found"),c=e)}else c=e;b.splice(c,0,g);k=isFinite(k)?Math.min(k,c):c;for(e=b.length;k<e;++k)a[this.getIdentity(b[k])]=k;this.emit(n,d);return g},
addSync:function(g,f){(f=f||{}).overwrite=!1;return this.putSync(g,f)},removeSync:function(g){var f=this.storage,n=f.index,f=f.fullData;if(g in n)return n=f.splice(n[g],1)[0],this._reindex(),!0!==this._ignoreChangeEvents&&this.emit("delete",{id:g,target:n}),!0},setData:function(g){this.parse&&(g=this.parse(g));g.items&&(this.idProperty=g.identifier||this.idProperty,g=g.items);this.storage.fullData=this.data=g;this._reindex()},_reindex:function(){for(var g=this.storage,f=g.index={},n=g.fullData,a=
this.Model,b=Object.prototype,d=0,e=n.length;d<e;d++){var k=n[d];if(a&&!(k instanceof a)){var c=this._restore(k,k.__proto__===b);k!==c&&(n[d]=k=c)}f[this.getIdentity(k)]=d}g.version++},fetchSync:function(){var g=this.data;if(!g||g._version!==this.storage.version){for(var g=this.storage.fullData,f=this.queryLog,h=0,a=f.length;h<a;h++)g=f[h].querier(g);g._version=this.storage.version;this.data=g}return new n(g)},fetchRangeSync:function(g){var f=this.fetchSync();return new n(f.slice(g.start,g.end),{totalLength:f.length})},
_includePropertyInSubCollection:function(g){return"data"!==g&&this.inherited(arguments)}})})},"dstore/Promised":function(){define(["dojo/_base/declare","dojo/Deferred","./QueryResults","dojo/when"],function(r,h,p,m){function g(g,l){return function(){var f=new h;try{f.resolve(this[g].apply(this,arguments))}catch(u){f.reject(u)}return l?(f=new p(f.promise),f.totalLength=m(f.totalLength),f):f.promise}}return r(null,{get:g("getSync"),put:g("putSync"),add:g("addSync"),remove:g("removeSync"),fetch:g("fetchSync",
!0),fetchRange:g("fetchRangeSync",!0)})})},"dstore/QueryResults":function(){define(["dojo/_base/lang","dojo/when"],function(r,h){function p(m,g){return h(this,function(n){for(var h=0,f=n.length;h<f;h++)m.call(g,n[h],h,n)})}return function(h,g){var n=g&&"totalLength"in g;if(h.then){h=r.delegate(h);var l=h.then(function(f){var h=n?g.totalLength:f.totalLength||f.length;f.totalLength=h;return!n&&h});h.totalLength=n?g.totalLength:l;h.response=g&&g.response}else h.totalLength=n?g.totalLength:h.length;h.forEach=
p;return h}})},"dstore/SimpleQuery":function(){define(["dojo/_base/declare","dojo/_base/array"],function(r,h){function p(g,h){if(-1<g.indexOf(".")){var l=g.split("."),f=l.length;return function(g){for(var a=0;a<f;a++)g=g&&(h&&g.get?g.get(l[a]):g[l[a]]);return g}}return function(f){return f.get?f.get(g):f[g]}}var m={eq:function(g,h){return g===h},"in":function(g,n){return-1<h.indexOf(n.data||n,g)},ne:function(g,h){return g!==h},lt:function(g,h){return g<h},lte:function(g,h){return g<=h},gt:function(g,
h){return g>h},gte:function(g,h){return g>=h},match:function(g,h,l){return h.test(g,l)},contains:function(g,n,l,f){var m=this;return h.every(n.data||n,function(a){if("object"===typeof a&&a.type){var b=m._getFilterComparator(a.type);return h.some(g,function(d){return b.call(m,d,a.args[1],l,f)})}return-1<h.indexOf(g,a)})}};return r(null,{_createFilterQuerier:function(g){function n(a){var b=a.type;a=a.args;var d=f._getFilterComparator(b);if(d){var e=a[0],g=p(e,l),c=a[1];c&&c.fetchSync&&(c=c.fetchSync());
return function(a){return d.call(f,g(a),c,a,e)}}switch(b){case "and":case "or":for(var h=0,r=a.length;h<r;h++){var y=n(a[h]);m=m?function(a,c){return"and"===b?function(b){return a(b)&&c(b)}:function(b){return a(b)||c(b)}}(m,y):y}return m;case "function":return a[0];case "string":h=f[a[0]];if(!h)throw Error("No filter function "+a[0]+" was found in the collection");return h;case void 0:return function(){return!0};default:throw Error('Unknown filter operation "'+b+'"');}}var l=this.queryAccessors,f=
this,m=n(g);return function(a){return h.filter(a,m)}},_getFilterComparator:function(g){return m[g]||this.inherited(arguments)},_createSelectQuerier:function(g){return function(n){var l=g.length;return h.map(n,g instanceof Array?function(f){for(var h={},a=0;a<l;a++){var b=g[a];h[b]=f[b]}return h}:function(f){return f[g]})}},_createSortQuerier:function(g){var h=this.queryAccessors;return function(l){l=l.slice();l.sort("function"==typeof g?g:function(f,l){for(var a=0;a<g.length;a++){var b,d=g[a];if("function"==
typeof d)b=d(f,l);else{b=d.get||(d.get=p(d.property,h));var d=d.descending,e=b(f);b=b(l);null!=e&&(e=e.valueOf());null!=b&&(b=b.valueOf());b=e===b?0:!!d===(null===e||e>b&&null!==b)?-1:1}if(0!==b)return b}return 0});return l}}})})},"dstore/Tree":function(){define(["dojo/_base/declare"],function(r){return r(null,{constructor:function(){this.root=this},mayHaveChildren:function(h){return"hasChildren"in h?h.hasChildren:!0},getRootCollection:function(){return this.root.filter({parent:null})},getChildren:function(h){return this.root.filter({parent:this.getIdentity(h)})}})})},
"dstore/Cache":function(){define("dojo/_base/array dojo/when dojo/_base/declare dojo/_base/lang ./Store ./Memory ./QueryResults".split(" "),function(r,h,p,m,g,n,l){function f(a){return function(){var d=this.inherited(arguments),e=this.cachingCollection||this.cachingStore;d.cachingCollection=e[a].apply(e,arguments);d.isValidFetchCache=!0===this.canCacheQuery||this.canCacheQuery(a,arguments);return d}}function u(a){a.cachingStore||(a.cachingStore=new n);a.cachingStore.Model=a.Model;a.cachingStore.idProperty=
a.idProperty}var a={cachingStore:null,constructor:function(){u(this)},canCacheQuery:function(a,d){return!1},isAvailableInCache:function(){return this.isValidFetchCache&&(this.allLoaded||this.fetchRequest)||this._parent&&this._parent.isAvailableInCache()},fetch:function(){return this._fetch(arguments)},fetchRange:function(){return this._fetch(arguments,!0)},_fetch:function(a,d){var e=this.cachingStore,f=this.cachingCollection||e,c=this,g=this.isAvailableInCache();if(g)return new l(h(g,function(){return c.isAvailableInCache()?
d?f.fetchRange(a[0]):f.fetch():c.inherited(a)}));g=this.fetchRequest=this.inherited(a);h(g,function(a){var b=!d;c.fetchRequest=null;r.forEach(a,function(a){!c.isLoaded||c.isLoaded(a)?e.put(a):b=!1});b&&(c.allLoaded=!0);return a});return g},isValidFetchCache:!1,get:function(a,d){var e=this.cachingStore,f=this.getInherited(arguments),c=this;return h(this.fetchRequest,function(){return h(e.get(a),function(g){if(void 0!==g)return g;if(f)return h(f.call(c,a,d),function(c){c&&e.put(c,{id:a});return c})})})},
add:function(a,d){var e=this.cachingStore;return h(this.inherited(arguments),function(f){var c=e.put(a&&"object"===typeof f?f:a,d);return f||c})},put:function(a,d){var e=this.cachingStore;e.remove(d&&d.id||this.getIdentity(a));return h(this.inherited(arguments),function(f){var c=e.put(a&&"object"===typeof f?f:a,d);return f||c})},remove:function(a,d){var e=this.cachingStore;return h(this.inherited(arguments),function(f){return h(e.remove(a,d),function(){return f})})},evict:function(a){this.allLoaded=
!1;return this.cachingStore.remove(a)},invalidate:function(){this.allLoaded=!1},_createSubCollection:function(){var a=this.inherited(arguments);a._parent=this;return a},sort:f("sort"),filter:f("filter"),_getQuerierFactory:function(a){var d=this.cachingStore;return this.inherited(arguments)||m.hitch(d,d._getQuerierFactory(a))}};g=p(null,a);g.create=function(b,d){b=p.safeMixin(m.delegate(b),a);p.safeMixin(b,d);u(b);return b};return g})},"dstore/Trackable":function(){define("dojo/_base/lang dojo/_base/declare dojo/aspect dojo/when dojo/promise/all dojo/_base/array dojo/on".split(" "),
function(r,h,p,m,g,n,l){function f(a,d,e){for(var f=a.length-1;0<=f;--f){var c=a[f],g=c.start,c=g+c.count;if(d>c){a.splice(f+1,0,{start:d,count:e-d});return}e>=g&&(d=Math.min(d,g),e=Math.max(e,c),a.splice(f,1))}a.unshift({start:d,count:e-d})}var u=0,a={track:function(){function a(){return function(){var a=this,b=this.inherited(arguments);m(b,function(b){b=a._results=b.slice();a._partialResults&&(a._partialResults=null);a._ranges=[];f(a._ranges,0,b.length)});return b}}function d(){return function(a){var b=
this,c=a.start,d=a.end,e=this.inherited(arguments);this._results||m(e,function(a){return m(a.totalLength,function(e){var g=b._partialResults||(b._partialResults=[]);d=Math.min(d,c+a.length);g.length=e;e=[c,d-c].concat(a);g.splice.apply(g,e);f(b._ranges,c,d);return a})});return e}}function e(a,b){u++;var c=b.target;b=r.delegate(b,B[a]);m(y._results||y._partialResults,function(d){if(d){var e,f,h,l=y._ranges,m,p="id"in b?b.id:g.getIdentity(c),q=-1,r=-1,u=-1,t=-1;if("delete"===a||"update"===a)for(e=0;-1===
q&&e<l.length;++e)for(m=l[e],f=m.start,h=f+m.count;f<h;++f)if(g.getIdentity(d[f])==p){q=b.previousIndex=f;r=e;d.splice(q,1);m.count--;for(f=e+1;f<l.length;++f)l[f].start--;break}if("add"===a||"update"===a){if(A){if(A([c]).length){var B=0;h=l.length-1;f=-1;for(var J;B<=h&&-1===u;)e=B+Math.round((h-B)/2),m=l[e],r=d.slice(m.start,m.start+m.count),"beforeId"in b&&(f=null===b.beforeId?r.length:C(r,b.beforeId)),-1===f&&(f=q>=Math.max(0,m.start-1)&&q<=m.start+m.count?q:g.defaultNewToStart?0:r.length),r.splice(f,
0,c),p=n.indexOf(A(r),c),J=m.start+p,0===p&&0!==m.start?h=e-1:p>=r.length-1&&J<d.length?B=e+1:(u=J,t=e);if(-1===u&&0<B&&B<l.length)var L=!0}}else{f=-1;if("beforeId"in b)if(null===b.beforeId)u=d.length,f=l.length-1;else for(e=0,h=l.length;-1===t&&e<h;++e)m=l[e],u=C(d,b.beforeId,m.start,m.start+m.count),-1!==u&&(t=e);else"update"===a?(u=q,t=r):g.defaultNewToStart?f=u=0:(u=d.length,f=l.length-1);-1!==f&&-1===t&&(m=l[f])&&m.start<=u&&u<=m.start+m.count&&(t=f)}if(-1<u&&-1<t)for(b.index=u,d.splice(u,0,
c),l[t].count++,e=t+1;e<l.length;++e)l[e].start++;else if(L)for(b.beforeIndex=l[B].start,e=B;e<l.length;++e)l[e].start++}b.totalLength=d.length}(d=y["on_tracked"+a])&&d.call(y,b)})}var g=this.store||this,c=[],q={add:1,update:1,"delete":1},t;for(t in q)c.push(this.on(t,function(a){return function(b){e(a,b)}}(t)));var y=h.safeMixin(r.delegate(this),{_ranges:[],fetch:a(),fetchRange:d(),releaseRange:function(a,b){if(this._partialResults){a:for(var c=this._ranges,d=0,e;e=c[d];++d){var f=e.start,g=f+e.count;
if(a<=f)if(b>=g)c.splice(d,1);else{e.start=b;e.count=g-e.start;break a}else if(a<g)if(b>f){c.splice(d,1,{start:f,count:a-f},{start:b,count:g-b});break a}else e.count=a-e.start}for(c=a;c<b;++c)delete this._partialResults[c]}},on:function(a,b){var c=this,d=this.getInherited(arguments);return l.parse(y,a,b,function(a,e){return e in q?p.after(y,"on_tracked"+e,b,!0):d.call(c,e,b)})},tracking:{remove:function(){for(;0<c.length;)c.pop().remove();this.remove=function(){}}},track:null});this.fetchSync&&(h.safeMixin(y,
{fetchSync:a(),fetchRangeSync:d()}),y.fetchSync());var A;n.forEach(this.queryLog,function(a){var b=A,c=a.querier;c&&(A=b?function(a){return c(b(a))}:c)});var B={add:{index:void 0},update:{previousIndex:void 0,index:void 0},"delete":{previousIndex:void 0}},C=function(a,b,c,d){d=void 0!==d?d:a.length;for(c=void 0!==c?c:0;c<d;++c)if(g.getIdentity(a[c])===b)return c;return-1};return y}};g=h(null,a);g.create=function(b,d){b=h.safeMixin(r.delegate(b),a);h.safeMixin(b,d);return b};return g})},"dstore/legacy/DstoreAdapter":function(){define(["dojo/_base/declare",
"dojo/_base/array","dojo/store/util/QueryResults"],function(r,h,p){function m(g){return g}var g={store:null,constructor:function(g){this.store=g;if(g._getQuerierFactory("filter")||g._getQuerierFactory("sort"))this.queryEngine=function(f,l){l=l||{};var a=g._getQuerierFactory("filter"),b=a?a(f):m,a=g._getQuerierFactory("sort"),d=m;a&&(d=a(h.map(l.sort,function(a){return{property:a.attribute,descending:a.descending}})));var e=m;isNaN(l.start)&&isNaN(l.count)||(e=function(a){var b=l.start||0,b=a.slice(b,
b+(l.count||Infinity));b.total=a.length;return b});return function(a){return e(d(b(a)))}};var l=this;g.on("add,update,delete",function(f){var h=f.type,a=f.target;l.notify("add"===h||"update"===h?a:void 0,"delete"===h||"update"===h?"id"in f?f.id:g.getIdentity(a):void 0)})},labelAttr:"title",getLabel:function(g){return this.store.getLabel(g)},query:function(g,h){h=h||{};var f=this.store.filter(g),m,a,b;if(b=h.sort)if("[object Array]"===Object.prototype.toString.call(b))for(var d;d=b.pop();)f=f.sort(d.attribute,
d.descending);else f=f.sort(b);f.track&&!f.tracking&&(f=f.track(),a=!0);"start"in h&&(m=h.start||0,m=f[f.fetchRangeSync?"fetchRangeSync":"fetchRange"]({start:m,end:h.count?m+h.count:Infinity}));m=m||f[f.fetchSync?"fetchSync":"fetch"]();b=m.totalLength;m=new p(m);m.total=b;m.observe=function(b,d){function c(b){return void 0===b&&a?-1:b}var g=f.on("add",function(a){b(a.target,-1,c(a.index))}),h=f.on("update",function(a){!d&&a.previousIndex===a.index&&isFinite(a.index)||b(a.target,c(a.previousIndex),
c(a.index))}),l=f.on("delete",function(a){b(a.target,c(a.previousIndex),-1)}),m={remove:function(){g.remove();h.remove();l.remove()}};m.cancel=m.remove;return m};return m},notify:function(){}};h.forEach(["get","put","add","remove","getIdentity"],function(h){g[h]=function(){var g=this.store;return(g[h+"Sync"]||g[h]).apply(g,arguments)}});return r(null,g)})}}});
//# sourceMappingURL=dgrid.js.map