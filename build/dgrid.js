//>>built
require({cache:{"dgrid/main":function(){define("dgrid/Tree dgrid/Selection dgrid/OnDemandList dgrid/OnDemandGrid dgrid/extensions/ColumnReorder dgrid/extensions/ColumnResizer dgrid/extensions/CompoundColumns dgrid/extensions/Pagination dgrid/extensions/DnD dgrid/Editor dstore/Store dstore/Memory dstore/Tree dstore/Cache dstore/Trackable dstore/legacy/DstoreAdapter".split(" "),function(){})},"dgrid/Tree":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/aspect dojo/dom-construct dojo/dom-class dojo/on dojo/query dojo/when ./util/has-css3 ./Grid dojo/has!touch?./util/touch".split(" "),
function(t,n,q,r,g,p,m,f,l,a,b,e){return t(null,{collapseOnRefresh:!1,enableTreeTransitions:!1,treeIndentWidth:9,constructor:function(){this._treeColumnListeners=[]},shouldExpand:function(a,b,h){return h},expand:function(b,e,h){if(this._treeColumn){var d=this,u=b.element?b:this.row(b),x=!!this._expanded[u.id],C=a("transitionend"),B;b=u.element;b=-1<b.className.indexOf("dgrid-expando-icon")?b:f(".dgrid-expando-icon",b)[0];h=h||!this.enableTreeTransitions;if(b&&b.mayHaveChildren&&(h||e!==x)){var D=
void 0===e?!this._expanded[u.id]:e;p.replace(b,"ui-icon-triangle-1-"+(D?"se":"e"),"ui-icon-triangle-1-"+(D?"e":"se"));p.toggle(u.element,"dgrid-row-expanded",D);e=u.element;var z=e.connected,v,q,r={};if(!z){var z=r.container=e.connected=g.create("div",{className:"dgrid-tree-container"},e,"after"),w=function(h){var a=d._renderedCollection.getChildren(u.data);d.sort&&(a=a.sort(d.sort));a.track&&d.shouldTrackCollection&&(z._rows=h.rows=[],a=a.track(),z._handles=[a.tracking,d._observeCollection(a,z,h)]);
return"start"in h?a.fetchRange({start:h.start,end:h.start+h.count}):a.fetch()};"level"in b&&(w.level=b.level);if(this.renderQuery)B=this.renderQuery(w,r);else{var t=g.create("div",null,z);B=this._trackError(function(){return d.renderQueryResults(w(r),t,n.mixin({rows:r.rows},"level"in w?{queryLevel:w.level}:null)).then(function(d){g.destroy(t);return d})})}C&&m(z,C,this._onTreeTransitionEnd)}z.hidden=!D;v=z.style;!C||h?(v.display=D?"block":"none",v.height=""):(D?(v.display="block",q=z.scrollHeight,
v.height="0px"):(p.add(z,"dgrid-tree-resetting"),v.height=z.scrollHeight+"px"),setTimeout(function(){p.remove(z,"dgrid-tree-resetting");v.height=D?q?q+"px":"auto":"0px"},0));D?this._expanded[u.id]=!0:delete this._expanded[u.id]}return l(B)}},_configColumns:function(){var a=this.inherited(arguments);this._expanded={};for(var b=0,h=a.length;b<h;b++)if(a[b].renderExpando){this._configureTreeColumn(a[b]);break}return a},insertRow:function(a){var b=this.inherited(arguments),h=this.row(b);(h=this.shouldExpand(h,
this._currentLevel,this._expanded[h.id]))&&this.expand(b,!0,!0);(h||!this.collection.mayHaveChildren||this.collection.mayHaveChildren(a))&&p.add(b,"dgrid-row-expandable");return b},removeRow:function(a,b){var h=a.connected,d={};h&&(h._handles&&(q.forEach(h._handles,function(d){d.remove()}),delete h._handles),h._rows&&(d.rows=h._rows),f("\x3e.dgrid-row",h).forEach(function(h){this.removeRow(h,!0,d)},this),h._rows&&(h._rows.length=0,delete h._rows),b||g.destroy(h));this.inherited(arguments)},_refreshCellFromItem:function(a,
b){if(!a.column.renderExpando)return this.inherited(arguments);this.inherited(arguments,[a,b,{queryLevel:f(".dgrid-expando-icon",a.element)[0].level-1}])},cleanup:function(){this.inherited(arguments);this.collapseOnRefresh&&(this._expanded={})},_destroyColumns:function(){this.inherited(arguments);for(var a=this._treeColumnListeners,b=a.length;b--;)a[b].remove();this._treeColumnListeners=[];this._treeColumn=null},_calcRowHeight:function(a){var b=a.connected;return this.inherited(arguments)+(b?b.offsetHeight:
0)},_configureTreeColumn:function(b){var k=this,h=this.collection,d=".dgrid-content .dgrid-column-"+b.id,u;this._treeColumn=b;if(!b._isConfiguredTreeColumn){var x=b.renderCell||this._defaultRenderCell;b._isConfiguredTreeColumn=!0;b.renderCell=function(d,a,u,e){if(h){var f=Number(e&&e.queryLevel)+1,g=!h.mayHaveChildren||h.mayHaveChildren(d),l,f=k._currentLevel=isNaN(f)?0:f;l=b.renderExpando(f,g,k._expanded[h.getIdentity(d)],d);l.level=f;l.mayHaveChildren=g;(d=x.call(b,d,a,u,e))&&d.nodeType?(u.appendChild(l),
u.appendChild(d)):u.insertBefore(l,u.firstChild)}};"function"!==typeof b.renderExpando&&(b.renderExpando=this._defaultRenderExpando)}var f=this._treeColumnListeners;0===f.length&&(f.push(this.on(b.expandOn||".dgrid-expando-icon:click,"+d+":dblclick,"+d+":keydown",function(d){var a=k.row(d);k.collection.mayHaveChildren&&!k.collection.mayHaveChildren(a.data)||"keydown"===d.type&&32!==d.keyCode||"dblclick"===d.type&&u&&1<u.count&&a.id===u.id&&-1<d.target.className.indexOf("dgrid-expando-icon")||k.expand(a);
-1<d.target.className.indexOf("dgrid-expando-icon")&&(u&&u.id===k.row(d).id?u.count++:u={id:k.row(d).id,count:1})})),a("touch")&&f.push(this.on(e.selector(d,e.dbltap),function(){k.expand(this)})))},_defaultRenderExpando:function(a,b,h){var d=this.grid.isRTL?"right":"left",u="dgrid-expando-icon";b&&(u+=" ui-icon ui-icon-triangle-1-"+(h?"se":"e"));return g.create("div",{className:u,innerHTML:"\x26nbsp;",style:"margin-"+d+": "+a*this.grid.treeIndentWidth+"px; float: "+d+";"})},_onNotification:function(a,
b){"delete"===b.type&&delete this._expanded[b.id];this.inherited(arguments)},_onTreeTransitionEnd:function(a){var b=this,h=this.style.height;h&&(this.style.display="0px"===h?"none":"block");a&&(p.add(this,"dgrid-tree-resetting"),setTimeout(function(){p.remove(b,"dgrid-tree-resetting")},0));this.style.height=""}})})},"dgrid/util/has-css3":function(){define(["dojo/has"],function(t){function n(n,g){var p=n.style,m;if(g in p)return!0;g=g.slice(0,1).toUpperCase()+g.slice(1);for(m=q.length;m--;)if(q[m]+
g in p)return q[m];return!1}var q=["ms","O","Moz","Webkit"];t.add("css-transitions",function(q,g,p){return n(p,"transitionProperty")});t.add("css-transforms",function(q,g,p){return n(p,"transform")});t.add("css-transforms3d",function(q,g,p){return n(p,"perspective")});t.add("transitionend",function(){var n=t("css-transitions");return n?!0===n?"transitionend":{ms:"MSTransitionEnd",O:"oTransitionEnd",Moz:"transitionend",Webkit:"webkitTransitionEnd"}[n]:!1});return t})},"dgrid/Grid":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on dojo/has ./List ./util/misc dojo/_base/sniff".split(" "),
function(t,n,q,r,g,p,m,f){function l(a,b){b&&b.nodeType&&a.appendChild(b)}t=t(m,{columns:null,hasNeutralSort:!1,cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(a){return"object"!==typeof a?this.columns[a]:this.cell(a).column},listType:"grid",cell:function(a,b){if(a.column&&a.element)return a;a.target&&a.target.nodeType&&(a=a.target);var e;if(a.nodeType){do{if(this._rowIdToObject[a.id])break;var c=a.columnId;if(c){b=c;e=a;break}a=a.parentNode}while(a&&a!==this.domNode)}if(!e&&"undefined"!==
typeof b){var k=this.row(a);if(c=k&&k.element)for(var c=c.getElementsByTagName("td"),h=0;h<c.length;h++)if(c[h].columnId===b){e=c[h];break}}if(null!=a)return{row:k||this.row(a),column:b&&this.column(b),element:e}},createRowCells:function(a,b,e,c,k){var h=q.create("table",{className:"dgrid-row-table",role:"presentation"}),d=9>p("ie")?q.create("tbody",null,h):h,u,x,g,l,m,z,v,n,r,w;e=e||this.subRows;x=0;for(g=e.length;x<g;x++)for(z=e[x],u=q.create("tr",null,d),z.className&&(u.className=z.className),
l=0,m=z.length;l<m;l++){v=z[l];n=v.id;r=v.field?" field-"+f.escapeCssIdentifier(v.field,"-"):"";(w="function"===typeof v.className?v.className(c):v.className)&&(r+=" "+w);r=q.create(a,{className:"dgrid-cell"+(n?" dgrid-column-"+f.escapeCssIdentifier(n,"-"):"")+r,role:"th"===a?"columnheader":"gridcell"});r.columnId=n;if(n=v.colSpan)r.colSpan=n;if(n=v.rowSpan)r.rowSpan=n;b(r,v,c,k);u.appendChild(r)}return h},_createBodyRowCell:function(a,b,e,c){var k=e;b.get?k=b.get(e):"field"in b&&"_item"!==b.field&&
(k=e[b.field]);b.renderCell?l(a,b.renderCell(e,k,a,c)):this._defaultRenderCell.call(b,e,k,a,c)},_createHeaderRowCell:function(a,b){var e=b.headerNode=a,c=b.field;c&&(a.field=c);b.renderHeaderCell?l(e,b.renderHeaderCell(e)):("label"in b||b.field)&&e.appendChild(document.createTextNode("label"in b?b.label:b.field));!1!==b.sortable&&c&&"_item"!==c&&(a.sortable=!0,a.className+=" dgrid-sortable")},left:function(a,b){a.element||(a=this.cell(a));return this.cell(this._move(a,-(b||1),"dgrid-cell"))},right:function(a,
b){a.element||(a=this.cell(a));return this.cell(this._move(a,b||1,"dgrid-cell"))},_defaultRenderCell:function(a,b,e){if(this.formatter){var c=this.formatter,k=this.grid.formatterScope;e.innerHTML="string"===typeof c&&k?k[c](b,a):this.formatter(b,a)}else null!=b&&e.appendChild(document.createTextNode(b))},renderRow:function(a,b){var e=this.createRowCells("td",n.hitch(this,"_createBodyRowCell"),b&&b.subRows,a,b),c=q.create("div",{role:"row"});c.appendChild(e);return c},renderHeader:function(){var a=
this,b=this.headerNode;b.setAttribute("role","row");q.empty(b);var e=this.createRowCells("th",n.hitch(this,"_createHeaderRowCell"),this.subRows&&this.subRows.headerRows);this._rowIdToObject[e.id=this.id+"-header"]=this.columns;b.appendChild(e);this._sortListener&&this._sortListener.remove();this._sortListener=g(e,"click,keydown",function(c){if("click"===c.type||32===c.keyCode||!p("opera")&&13===c.keyCode){var e=c.target,h,d;do if(e.sortable){h=e.field||e.columnId;d=a.sort[0];h=a.hasNeutralSort&&d&&
d.property===h&&d.descending?[]:[{property:h,descending:d&&d.property===h&&!d.descending}];d={bubbles:!0,cancelable:!0,grid:a,parentType:c.type,sort:h};g.emit(c.target,"dgrid-sort",d)&&(a._sortNode=e,a.set("sort",h));break}while((e=e.parentNode)&&e!==b)}})},resize:function(){if(this.headerNode){var a=this.headerNode.firstChild,b=this.contentNode,e;this.inherited(arguments);b.style.width="";b&&a&&(e=a.offsetWidth)>b.offsetWidth&&(b.style.width=e+"px")}},destroy:function(){this._destroyColumns();this._sortListener&&
this._sortListener.remove();this.inherited(arguments)},_setSort:function(){this.inherited(arguments);this.updateSortArrow(this.sort)},_findSortArrowParent:function(a){var b=this.columns,e;for(e in b){var c=b[e];if(c.field===a)return c.headerNode}},updateSortArrow:function(a,b){this._lastSortedArrow&&(r.remove(this._lastSortedArrow.parentNode,"dgrid-sort-up dgrid-sort-down"),q.destroy(this._lastSortedArrow),delete this._lastSortedArrow);b&&(this.sort=a);if(a[0]){var e=a[0].property,c=a[0].descending,
e=this._sortNode||this._findSortArrowParent(e);delete this._sortNode;e&&(e=e.contents||e,this._lastSortedArrow=q.create("div",{className:"dgrid-sort-arrow ui-icon",innerHTML:"\x26nbsp;",role:"presentation"},e,"first"),r.add(e,"dgrid-sort-"+(c?"down":"up")),this.resize())}},styleColumn:function(a,b){return this.addCssRule("#"+f.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+f.escapeCssIdentifier(a,"-"),b)},_configColumns:function(a,b){var e=[],c=b instanceof Array;f.each(b,function(k,h){"string"===
typeof k&&(b[h]=k={label:k});c||k.field||(k.field=h);h=k.id=k.id||(isNaN(h)?h:a+h);this._configColumn&&(this._configColumn(k,b,a),h=k.id);c&&(this.columns[h]=k);k.grid=this;e.push(k)},this);return c?b:e},_destroyColumns:function(){this.cleanup()},configStructure:function(){var a=this.subRows,b=this._columns=this.columns;this.columns=!b||b instanceof Array?{}:b;if(a)for(b=0;b<a.length;b++)a[b]=this._configColumns(b+"-",a[b]);else this.subRows=[this._configColumns("",b)]},_getColumns:function(){return this._columns||
this.columns},_setColumns:function(a){this._destroyColumns();this.subRows=null;this.columns=a;this._updateColumns()},_setSubRows:function(a){this._destroyColumns();this.subRows=a;this._updateColumns()},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this.sort.length?(this._lastSortedArrow=null,this.updateSortArrow(this.sort)):this.resize())}});t.appendIfNode=l;return t})},"dgrid/List":function(){define("dojo/_base/declare dojo/dom-construct dojo/dom-class dojo/on dojo/has ./util/misc dojo/_base/sniff".split(" "),
function(t,n,q,r,g,p){function m(d,a){d.className="dgrid-scrollbar-measure";document.body.appendChild(d);var h=d["offset"+a]-d["client"+a];d.className="";d.parentNode&&document.body.removeChild(d);return h}function f(d){q.replace(this.domNode,d,this._class||"");this._class=d}function l(){return this._class}var a=[];g("mozilla")&&a.push("has-mozilla");g("touch")&&a.push("has-touch");q.add(document.documentElement,a);g.add("pointer",function(d){return"PointerEvent"in d?"pointer":"MSPointerEvent"in d?
"MSPointer":!1});var b,e;g.add("dom-scrollbar-width",function(d,a,h){return m(h,"Width")});g.add("dom-scrollbar-height",function(d,a,h){return m(h,"Height")});g.add("dom-rtl-scrollbar-left",function(d,a,h){d=document.createElement("div");h.className="dgrid-scrollbar-measure";h.setAttribute("dir","rtl");h.appendChild(d);document.body.appendChild(h);a=!!g("ie")||!!g("trident")||/\bEdge\//.test(navigator.userAgent)||d.offsetLeft>=g("dom-scrollbar-width");h.className="";h.parentNode&&document.body.removeChild(h);
n.destroy(d);h.removeAttribute("dir");return a});var c=0,k=function(){this._started&&this.resize()},h=t(null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,addUiClasses:!0,highlightDuration:250,postscript:function(d,a){var h=this;(this._Row=function(d,a,h){this.id=d;this.data=a;this.element=h}).prototype.remove=function(){h.removeRow(this.element)};a&&(this.srcNodeRef=a=a.nodeType?a:document.getElementById(a));this.create(d,a)},listType:"list",create:function(d,
a){var b=this.domNode=a||document.createElement("div"),e;d&&(this.params=d,t.safeMixin(this,d),e=d["class"]||d.className||b.className);this.sort=this.sort||[];this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=b.id=b.id||this.id||h.autoIdPrefix+c++;this.buildRendering();e&&f.call(this,e);this.postCreate();delete this.srcNodeRef},buildRendering:function(){var d=this.domNode,a=this.addUiClasses,h=this,b,c,e;e=this.isRTL="rtl"===(document.body.dir||
document.documentElement.dir||document.body.style.direction).toLowerCase();d.className="";d.setAttribute("role","grid");q.add(d,"dgrid dgrid-"+this.listType+(a?" ui-widget":""));b=this.headerNode=n.create("div",{tabIndex:-1,className:"dgrid-header dgrid-header-row"+(a?" ui-widget-header":"")+(this.showHeader?"":" dgrid-header-hidden")},d);c=this.bodyNode=n.create("div",{className:"dgrid-scroller"},d);g("ff")&&(c.tabIndex=-1);this.headerScrollNode=n.create("div",{className:"dgrid-header dgrid-header-scroll dgrid-scrollbar-width"+
(a?" widget":"")},d);this.footerNode=n.create("div",{className:"dgrid-footer"+(this.showFooter?"":" dgrid-footer-hidden")},d);e&&(d.className+=" dgrid-rtl"+(g("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));r(c,"scroll",function(a){h.showHeader&&(b.scrollLeft=a.scrollLeft||c.scrollLeft);a.stopPropagation();r.emit(d,"scroll",{scrollTarget:c})});this.configStructure();this.renderHeader();this.contentNode=this.touchNode=n.create("div",{className:"dgrid-content"+(a?" widget":"")},this.bodyNode);this._listeners.push(this._resizeHandle=
r(window,"resize",p.throttleDelayed(k,this)))},postCreate:function(){},startup:function(){this._started||(this.inherited(arguments),this._started=!0,this.resize(),this.set("sort",this.sort))},configStructure:function(){},resize:function(){var d=this.bodyNode,a=this.footerNode,a=this.showFooter?a.offsetHeight:0;this.headerScrollNode.style.height=d.style.marginTop=this.headerNode.offsetHeight+"px";d.style.marginBottom=a+"px";b||(b=g("dom-scrollbar-width"),e=g("dom-scrollbar-height"),g("ie")&&(b++,e++),
17!==b&&p.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+b+"px"))},addCssRule:function(d,a){var h=p.addCssRule(d,a);this.cleanAddedRules&&this._listeners.push(h);return h},on:function(d,a){var h=r(this.domNode,d,a);g("dom-addeventlistener")||this._listeners.push(h);return h},cleanup:function(){for(var d in this._rowIdToObject)if(this._rowIdToObject[d]!==this.columns){var a=document.getElementById(d);a&&this.removeRow(a,!0)}},destroy:function(){if(this._listeners){for(var d=this._listeners.length;d--;)this._listeners[d].remove();
this._listeners=null}this._started=!1;this.cleanup();n.destroy(this.domNode)},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoRowId=0;this.contentNode.innerHTML="";this.scrollTo({x:0,y:0})},highlightRow:function(d,a){var h="dgrid-highlight"+(this.addUiClasses?" ui-state-highlight":"");d=d.element||d;q.add(d,h);setTimeout(function(){q.remove(d,h)},a||this.highlightDuration)},adjustRowIndices:function(d){var a=d.rowIndex;if(-1<a){do-1<d.rowIndex&&(this.maintainOddEven&&q.contains(d,
"dgrid-row")&&q.replace(d,1===a%2?"dgrid-row-odd":"dgrid-row-even",0===a%2?"dgrid-row-odd":"dgrid-row-even"),d.rowIndex=a++);while((d=d.nextSibling)&&d.rowIndex!==a)}},renderArray:function(d,a,h){h=h||{};var b=h.start||0,c=document.createDocumentFragment(),e=[],k=0,f=d.length;a||(this._lastCollection=d);for(;k<f;)e[k]=this.insertRow(d[k],c,null,b++,h),k++;(d=a?a.parentNode:this.contentNode)&&d.parentNode&&(d!==this.contentNode||f)&&(d.insertBefore(c,a||null),f&&this.adjustRowIndices(e[f-1]));return e},
renderHeader:function(){},_autoRowId:0,insertRow:function(d,a,h,b,c){var e=this.id+"-row-"+(this.collection&&this.collection.getIdentity?this.collection.getIdentity(d):this._autoRowId++),k=document.getElementById(e),f=k&&k.previousSibling;k&&(k===h&&(h=(h.connected||h).nextSibling),this.removeRow(k,!1,c));k=this.renderRow(d,c);k.className=(k.className||"")+" dgrid-row "+(1===b%2?"dgrid-row-odd":"dgrid-row-even");this._rowIdToObject[k.id=e]=d;a.insertBefore(k,h||null);k.rowIndex=b;f&&f.rowIndex!==
k.rowIndex-1&&this.adjustRowIndices(f);return k},renderRow:function(d){var a=document.createElement("div");a.appendChild(document.createTextNode(d));return a},removeRow:function(d,a){d=d.element||d;delete this._rowIdToObject[d.id];a||n.destroy(d)},row:function(d){var a;if(d instanceof this._Row)return d;if(!d)return null;d.target&&d.target.nodeType&&(d=d.target);if(d.nodeType){do{var h=d.id;if(a=this._rowIdToObject[h])return new this._Row(h.substring(this.id.length+5),a,d);d=d.parentNode}while(d&&
d!==this.domNode)}else return"object"===typeof d?a=this.collection.getIdentity(d):(a=d,d=this._rowIdToObject[this.id+"-row-"+a]),new this._Row(a,d,document.getElementById(this.id+"-row-"+a))},cell:function(a){return{row:this.row(a)}},_move:function(a,h,b,c){var e,k;k=e=a.element;h=h||1;do if(a=e[0>h?"previousSibling":"nextSibling"]){do if((e=a)&&-1<(e.className+" ").indexOf(b+" ")){k=e;h+=0>h?1:-1;break}while(a=(!c||!e.hidden)&&e[0>h?"lastChild":"firstChild"])}else if(e=e.parentNode,!e||e===this.bodyNode||
e===this.headerNode)break;while(h);return k},up:function(a,h,b){if(!a)return null;a.element||(a=this.row(a));return this.row(this._move(a,-(h||1),"dgrid-row",b))},down:function(a,h,b){if(!a)return null;a.element||(a=this.row(a));return this.row(this._move(a,h||1,"dgrid-row",b))},scrollTo:function(a){"undefined"!==typeof a.x&&(this.bodyNode.scrollLeft=a.x);"undefined"!==typeof a.y&&(this.bodyNode.scrollTop=a.y)},getScrollPosition:function(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}},
get:function(a){var h="_get"+a.charAt(0).toUpperCase()+a.slice(1);return"function"===typeof this[h]?this[h].apply(this,[].slice.call(arguments,1)):this[a]},set:function(a,h){if("object"===typeof a)for(var b in a)this.set(b,a[b]);else b="_set"+a.charAt(0).toUpperCase()+a.slice(1),"function"===typeof this[b]?this[b].apply(this,[].slice.call(arguments,1)):this[a]=h;return this},_getClass:l,_setClass:f,_getClassName:l,_setClassName:f,_setSort:function(a,h){this.sort="string"!==typeof a?a:[{property:a,
descending:h}];this._applySort()},_applySort:function(){this.refresh();if(this._lastCollection){var a=this.sort;if(a&&0<a.length){var h=a[0].property,b=!!a[0].descending;this._lastCollection.sort(function(a,d){var c=a[h],e=d[h];void 0===c&&(c="");void 0===e&&(e="");return c===e?0:c>e!==b?1:-1})}this.renderArray(this._lastCollection)}},_setShowHeader:function(a){var h=this.headerNode;this.showHeader=a;q.toggle(h,"dgrid-header-hidden",!a);this.renderHeader();this.resize();a&&(h.scrollLeft=this.getScrollPosition().x)},
_setShowFooter:function(a){this.showFooter=a;q.toggle(this.footerNode,"dgrid-footer-hidden",!a);this.resize()}});h.autoIdPrefix="dgrid_";return h})},"dgrid/util/misc":function(){define(["dojo/has"],function(t){t.add("dom-contains",function(f,l,a){return!!a.contains});var n=[],q,r,g,p=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,m={defaultDelay:15,throttle:function(f,l,a){var b=!1;a=a||m.defaultDelay;return function(){b||(b=!0,f.apply(l,arguments),setTimeout(function(){b=!1},a))}},throttleDelayed:function(f,l,
a){var b=!1;a=a||m.defaultDelay;return function(){if(!b){b=!0;var e=arguments;setTimeout(function(){b=!1;f.apply(l,e)},a)}}},debounce:function(f,l,a){var b;a=a||m.defaultDelay;return function(){b&&(clearTimeout(b),b=null);var e=arguments;b=setTimeout(function(){f.apply(l,e)},a)}},each:function(f,l,a){var b,e;if(f)if("number"===typeof f.length)for(b=0,e=f.length;b<e;b++)l.call(a,f[b],b,f);else for(b in f)l.call(a,f[b],b,f)},contains:function(f,l){return t("dom-contains")?f.contains(l):f.compareDocumentPosition(l)&
8},addCssRule:function(f,l){q||(q=document.createElement("style"),document.getElementsByTagName("head")[0].appendChild(q),q=q.sheet||q.styleSheet,r=q.deleteRule?"deleteRule":"removeRule",g=q.cssRules?"cssRules":"rules");var a=n.length;n[a]=(q.cssRules||q.rules).length;q.addRule?q.addRule(f,l):q.insertRule(f+"{"+l+"}",n[a]);return{get:function(b){return q[g][n[a]].style[b]},set:function(b,e){"undefined"!==typeof n[a]&&(q[g][n[a]].style[b]=e)},remove:function(){var b=n[a],e,c;if(void 0!==b)for(q[r](b),
n[a]=void 0,e=a+1,c=n.length;e<c;e++)n[e]>b&&n[e]--}}},escapeCssIdentifier:function(f,l){return"string"===typeof f?f.replace(p,l||"\\$1"):f}};return m})},"dgrid/Selection":function(){define("dojo/_base/declare dojo/dom-class dojo/on dojo/has dojo/aspect ./List dgrid/util/touch dojo/query dojo/_base/sniff dojo/dom".split(" "),function(t,n,q,r,g,p,m){function f(a,d){for(var b=a.unselectable=d?"on":"",c=a.getElementsByTagName("*"),e=c.length;--e;)"INPUT"!==c[e].tagName&&"TEXTAREA"!==c[e].tagName&&(c[e].unselectable=
b)}function l(a,d){var c=a.bodyNode,e=d?"text":21>r("ff")?"-moz-none":"none";b&&"msUserSelect"!==b?c.style[b]=e:r("dom-selectstart")?d||a._selectstartHandle?d&&a._selectstartHandle&&(a._selectstartHandle.remove(),delete a._selectstartHandle):a._selectstartHandle=q(c,"selectstart",function(a){var h=a.target&&a.target.tagName;"INPUT"!==h&&"TEXTAREA"!==h&&a.preventDefault()}):(f(c,!d),d||a._unselectableHandle)?d&&a._unselectableHandle&&(a._unselectableHandle.remove(),delete a._unselectableHandle):a._unselectableHandle=
g.after(a,"renderRow",function(a){f(a,!0);return a})}r.add("dom-comparedocumentposition",function(a,d,b){return!!b.compareDocumentPosition});r.add("dom-selectstart","undefined"!==typeof document.onselectstart);var a=r("mac")?"metaKey":"ctrlKey",b=r("css-user-select"),e=(p=r("pointer"))&&"MS"===p.slice(0,2),c=p?p+(e?"Down":"down"):"mousedown",k=p?p+(e?"Up":"up"):"mouseup";"WebkitUserSelect"===b&&"undefined"!==typeof document.documentElement.style.msUserSelect&&(b=!1);return t(null,{selectionDelegate:".dgrid-row",
selectionEvents:c+","+k+",dgrid-cellfocusin",selectionTouchEvents:r("touch")?m.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();var a=this.selectionMode;this.selectionMode="";this._setSelectionMode(a)},destroy:function(){this.inherited(arguments);this._selectstartHandle&&
this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&this._removeDeselectSignals()},_setSelectionMode:function(a){a!==this.selectionMode&&(this.clearSelection(),this.selectionMode=a,this._selectionHandlerName="_"+a+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},_setAllowTextSelection:function(a){"undefined"!==typeof a?l(this,a):l(this,"none"===this.selectionMode);this.allowTextSelection=a},_handleSelect:function(a,
d){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(d))&&("dgrid-cellfocusin"!==a.type||"mousedown"!==a.parentType)&&(a.type!==k||d===this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=a;if(!a.keyCode||!a.ctrlKey||32===a.keyCode)if(!a.shiftKey&&a.type===c&&this.isSelected(d))this._waitForMouseUp=d;else this[this._selectionHandlerName](a,d);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(h,d){var b=h.keyCode?h.ctrlKey:h[a];this._lastSelected===
d?this.select(d,null,!b||!this.isSelected(d)):(this.clearSelection(),this.select(d),this._lastSelected=d)},_multipleSelectionHandler:function(h,d){var b=this._lastSelected,c=h.keyCode?h.ctrlKey:h[a],e;h.shiftKey||(e=c?null:!0,b=null);this.select(d,b,e,null,-1!==h.type.indexOf("mouse")?"mouse":h.type);b||(this._lastSelected=d)},_extendedSelectionHandler:function(h,d){(2===h.button?this.isSelected(d):h.keyCode?h.ctrlKey:h[a])||this.clearSelection(null,!0);this._multipleSelectionHandler(h,d)},_toggleSelectionHandler:function(a,
d){this.select(d,null,null)},_initSelectionEvents:function(){var h=this,d=this.contentNode,b=this.selectionDelegate;this._selectionEventQueues={deselect:[],select:[]};r("touch")&&!r("pointer")&&this.selectionTouchEvents?(q(d,m.selector(b,this.selectionTouchEvents),function(a){h._handleSelect(a,this);h._ignoreMouseSelect=this}),q(d,q.selector(b,this.selectionEvents),function(a){h._ignoreMouseSelect!==this?h._handleSelect(a,this):a.type===k&&(h._ignoreMouseSelect=null)})):q(d,q.selector(b,this.selectionEvents),
function(a){h._handleSelect(a,this)});this.addKeyHandler&&this.addKeyHandler(32,function(a){h._handleSelect(a,a.target)});if(this.allowSelectAll)this.on("keydown",function(d){d[a]&&65===d.keyCode&&!/\bdgrid-input\b/.test(d.target.className)&&(d.preventDefault(),h[h.allSelected?"clearSelection":"selectAll"]())});this._setCollection&&g.before(this,"_setCollection",function(a){h._updateDeselectionAspect(a)});this._updateDeselectionAspect()},_updateDeselectionAspect:function(a){function d(a,h,d){if((a=
b.row(a))&&b.selection[a.id])b[h](a,null,!0,null,d)}var b=this,c;this._removeDeselectSignals&&this._removeDeselectSignals();c=a&&a.track&&this._observeCollection?[g.before(this,"_observeCollection",function(a){c.push(a.on("delete",function(a){"undefined"===typeof a.index&&d(a.id,"deselect")}))}),g.after(this,"_observeCollection",function(a){c.push(a.on("update",function(h){"undefined"!==typeof h.index&&d(a.getIdentity(h.target),"select","update")}))},!0)]:[g.before(this,"removeRow",function(a,h){var d;
h||(d=this.row(a))&&d.id in this.selection&&this.deselect(d)})];this._removeDeselectSignals=function(){for(var a=c.length;a--;)c[a].remove();c=[]}},allowSelect:function(){return!0},_fireSelectionEvent:function(a){var d=this._selectionEventQueues[a],b=this._selectionTriggerEvent,c;c={bubbles:!0,grid:this};b&&(c.parentType=b.type);c[this._selectionTargetType]=d;this._selectionEventQueues[a]=[];q.emit(this.contentNode,"dgrid-"+a,c)},_fireSelectionEvents:function(){var a=this._selectionEventQueues,d;
for(d in a)a[d].length&&this._fireSelectionEvent(d)},_select:function(a,d,b){var c,e,k;"undefined"===typeof b&&(b=!0);a.element||(a=this.row(a));if(!1===b||this.allowSelect(a))if(c=this.selection,e=!!c[a.id],null===b&&(b=!e),k=a.element,b||this.allSelected?c[a.id]=b:delete this.selection[a.id],k&&(b?n.add(k,"dgrid-selected"+(this.addUiClasses?" ui-state-active":"")):n.remove(k,"dgrid-selected ui-state-active")),b!==e&&k&&this._selectionEventQueues[(b?"":"de")+"select"].push(a),d)if(d.element||(d=
this.row(d)),d){if(d=d.element)for(c=this._determineSelectionDirection(k,d),c||(d=document.getElementById(d.id),c=this._determineSelectionDirection(k,d));a.element!==d&&(a=this[c](a));)this._select(a,null,b)}else this._lastSelected=k},_determineSelectionDirection:r("dom-comparedocumentposition")?function(a,b){var c=b.compareDocumentPosition(a);return c&1?!1:2===c?"down":"up"}:function(a,b){return 1>b.sourceIndex?!1:b.sourceIndex>a.sourceIndex?"down":"up"},select:function(a,b,c){this._select(a,b,c);
this._fireSelectionEvents()},deselect:function(a,b){this.select(a,b,!1)},clearSelection:function(a,b){this.allSelected=!1;for(var c in this.selection)a!==c&&this._select(c,null,!1);b||(this._lastSelected=null);this._fireSelectionEvents()},selectAll:function(){this.allSelected=!0;this.selection={};for(var a in this._rowIdToObject){var b=this.row(this._rowIdToObject[a]);this._select(b.id,null,!0)}this._fireSelectionEvents()},isSelected:function(a){if("undefined"===typeof a||null===a)return!1;a.element||
(a=this.row(a));return a.id in this.selection?!!this.selection[a.id]:this.allSelected&&(!a.data||this.allowSelect(a))},refresh:function(){this.deselectOnRefresh&&this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var a=this.inherited(arguments),b=this.selection,c,e,k;for(c=0;c<a.length;c++)e=this.row(a[c]),(k=e.id in b?b[e.id]:this.allSelected)&&this.select(e,null,k,null,"renderArray");this._fireSelectionEvents();return a}})})},"dgrid/util/touch":function(){define(["dojo/on"],
function(t,n){function q(g,p,m,f){if(!(1<m.targetTouches.length)){var l=m.changedTouches[0],a=l.screenX,b=l.screenY;f&&m.preventDefault();var e=t(g,"touchend",function(c){var k=c.changedTouches[0];c.targetTouches.length||(Math.abs(k.screenX-a)<r.tapRadius&&Math.abs(k.screenY-b)<r.tapRadius&&(f&&c.preventDefault(),p.call(this,c)),e.remove())})}}var r={tapRadius:10,dbltapTime:250,selector:function(g,p,m){return function(f,l){var a=p.bubble;a?p=a:!1!==m&&(m=!0);return t(f,p,function(a){var e=a.target;
3===e.nodeType&&(e=e.parentNode);for(;!n.matches(e,g,f);)if(e===f||!m||!(e=e.parentNode))return;return l.call(e,a)})}},countCurrentTouches:function(g,p){if(!("touches"in g))return-1;var m,f,l;for(f=m=0;l=g.touches[m];++m)p.contains(l.target)&&++f;return f},tap:function(g,p){return t(g,"touchstart",function(m){q(g,p,m)})},dbltap:function(g,p){var m,f;return t(g,"touchstart",function(l){m?q(g,function(a){if(m){var b=a.changedTouches[0];Math.abs(b.screenX-m.screenX)<r.tapRadius&&Math.abs(b.screenY-m.screenY)<
r.tapRadius&&(f&&clearTimeout(f),m=f=null,p.call(this,a))}},l,!0):q(g,function(a){m=a.changedTouches[0];f=setTimeout(function(){m=f=null},r.dbltapTime)},l)})}};return r})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/on dojo/when ./util/misc".split(" "),function(t,n,q,r,g,p,m,f){return q([t,n],{minRowsPerPage:2500,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",
pagingDelay:f.defaultDelay,keepScrollPosition:!1,rowHeight:0,postCreate:function(){this.inherited(arguments);var l=this;p(this.bodyNode,"scroll",f[this.pagingMethod](function(a){l._processScroll(a)},null,this.pagingDelay))},destroy:function(){this.inherited(arguments);this._refreshTimeout&&clearTimeout(this._refreshTimeout)},renderQuery:function(f,a){var b=this,e=a&&a.container||this.contentNode,c={query:f,count:0},k,h=this.preload,d={node:g.create("div",{className:"dgrid-preload",style:{height:"0"}},
e),count:0,query:f,next:c};d.node.rowIndex=0;c.node=k=g.create("div",{className:"dgrid-preload"},e);c.previous=d;k.rowIndex=this.minRowsPerPage;h?((c.next=h.next)&&k.offsetTop>=h.node.offsetTop?c.previous=h:(c.next=h,c.previous=h.previous),c.previous.next=c,c.next.previous=c):this.preload=c;var u=g.create("div",{className:"dgrid-loading"},k,"before");g.create("div",{className:"dgrid-below"},u).innerHTML=this.loadingMessage;a=r.mixin({start:0,count:this.minRowsPerPage},"level"in f?{queryLevel:f.level}:
null);return this._trackError(function(){var d=f(a);return b.renderQueryResults(d,k,a).then(function(h){return d.totalLength.then(function(d){var e=h.length,f=k.parentNode,l=b.noDataNode;b._rows&&(b._rows.min=0,b._rows.max=e===d?Infinity:e-1);g.destroy(u);"queryLevel"in a||(b._total=d);0===d&&f&&(l&&(g.destroy(l),delete b.noDataNode),b.noDataNode=l=g.create("div",{className:"dgrid-no-data",innerHTML:b.noDataMessage}),b._emit("noData"),f.insertBefore(l,b._getFirstRowSibling(f)));for(l=f=0;l<e;l++)f+=
b._calcRowHeight(h[l]);e&&f&&(b.rowHeight=f/e);d-=e;c.count=d;k.rowIndex=e;d?k.style.height=Math.min(d*b.rowHeight,b.maxEmptySpace)+"px":k.style.display="none";b._previousScrollPosition&&(b.scrollTo(b._previousScrollPosition),delete b._previousScrollPosition);return m(b._processScroll()).then(function(){return h})})}).otherwise(function(a){g.destroy(u);throw a;})})},refresh:function(f){var a=this,b=f&&f.keepScrollPosition;"undefined"===typeof b&&(b=this.keepScrollPosition);b&&(this._previousScrollPosition=
this.getScrollPosition());this.inherited(arguments);if(this._renderedCollection)return this.renderQuery(function(b){return a._renderedCollection.fetchRange({start:b.start,end:b.start+b.count})}).then(function(){a._refreshTimeout=setTimeout(function(){p.emit(a.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:a});a._refreshTimeout=null},0)})},resize:function(){this.inherited(arguments);this._processScroll()},cleanup:function(){this.inherited(arguments);this.preload=null},renderQueryResults:function(f){var a=
this.inherited(arguments),b=this._renderedCollection;b&&b.releaseRange&&a.then(function(a){a[0]&&!a[0].parentNode.tagName&&f.totalLength.then(function(){b.releaseRange(a[0].rowIndex,a[a.length-1].rowIndex+1)})});return a},_getFirstRowSibling:function(f){return f.lastChild},_calcRowHeight:function(f){var a=f.nextSibling;return a&&!/\bdgrid-preload\b/.test(a.className)?a.offsetTop-f.offsetTop:f.offsetHeight},lastScrollTop:0,_processScroll:function(f){function a(a,d,h,e){var k=c.farOffRemoval,f=a.node;
if(d>2*k){for(var u,p=f[h],m=0,x=0,l=[],v=p&&p.rowIndex,n;u=p;){var q=c._calcRowHeight(u);if(m+q+k>d||0>p.className.indexOf("dgrid-row")&&0>p.className.indexOf("dgrid-loading"))break;p=u[h];m+=q;x+=u.count||1;c.removeRow(u,!0);l.push(u);"rowIndex"in u&&(n=u.rowIndex)}c._renderedCollection.releaseRange&&"number"===typeof v&&"number"===typeof n&&(e?c._renderedCollection.releaseRange(n,v+1):c._renderedCollection.releaseRange(v,n+1),c._rows[e?"max":"min"]=n,c._rows.max>=c._total-1&&(c._rows.max=Infinity));
a.count+=x;e?(f.rowIndex-=x,b(a)):f.style.height=f.offsetHeight+m+"px";var C=document.createElement("div");for(a=l.length;a--;)C.appendChild(l[a]);setTimeout(function(){g.destroy(C)},1)}}function b(a,b){a.node.style.height=Math.min(a.count*c.rowHeight,b?Infinity:c.maxEmptySpace)+"px"}function e(a,b){do a=b?a.next:a.previous;while(a&&!a.node.offsetWidth);return a}if(this.rowHeight){var c=this,k=c.bodyNode;f=f&&f.scrollTop||this.getScrollPosition().y;var k=k.offsetHeight+f,h,d,u=c.preload,p=c.lastScrollTop,
m=c.bufferRows*c.rowHeight,n=m-c.rowHeight,q,r=!0;for(c.lastScrollTop=f;u&&!u.node.offsetWidth;)u=u.previous;for(;u&&u!==h;){h=c.preload;c.preload=u;d=u.node;var v=d.offsetTop;if(k+1+n<v)u=e(u,r=!1);else if(f-1-n>v+d.offsetHeight)u=e(u,r=!0);else{var v=((d.rowIndex?f-m:k)-v)/c.rowHeight,y=(k-f+2*m)/c.rowHeight,A=Math.max(Math.min((f-p)*c.rowHeight,c.maxRowsPerPage/2),c.maxRowsPerPage/-2),y=y+Math.min(Math.abs(A),10);0===d.rowIndex&&(v-=y);v=Math.max(v,0);10>v&&0<v&&y+v<c.maxRowsPerPage&&(y+=Math.max(0,
v),v=0);y=Math.min(Math.max(y,c.minRowsPerPage),c.maxRowsPerPage,u.count);if(0===y)u=e(u,r);else{var y=Math.ceil(y),v=Math.min(Math.floor(v),u.count-y),w={};u.count-=y;var t=d,G,A=c.queryRowsOverlap,H=(0<d.rowIndex||d.offsetTop>f)&&u;if(H){var E=u.previous;E&&(a(E,f-(E.node.offsetTop+E.node.offsetHeight),"nextSibling"),0<v&&E.node===d.previousSibling?(v=Math.min(u.count,v),u.previous.count+=v,b(u.previous,!0),d.rowIndex+=v,A=0):y+=v,u.count-=v);w.start=d.rowIndex-A;w.count=Math.min(y+A,c.maxRowsPerPage);
d.rowIndex=w.start+w.count}else u.next&&(a(u.next,u.next.node.offsetTop-k,"previousSibling",!0),t=d.nextSibling,t===u.next.node?(u.next.count+=u.count-v,u.next.node.rowIndex=v+y,b(u.next),u.count=v,A=0):G=!0),w.start=u.count,w.count=Math.min(y+A,c.maxRowsPerPage);G&&t&&t.offsetWidth&&(G=t.offsetTop);b(u);"level"in u.query&&(w.queryLevel=u.query.level);if("queryLevel"in w||!(w.start>c._total||0>w.count)){var F=g.create("div",{className:"dgrid-loading",style:{height:y*c.rowHeight+"px"}},t,"before");
g.create("div",{className:"dgrid-"+(H?"below":"above"),innerHTML:c.loadingMessage},F);F.count=y;c._trackError(function(){(function(a,d,h){var e=u.query(w);q=c.renderQueryResults(e,a,w).then(function(k){var f=c._rows;!f||"queryLevel"in w||!k.length||(d?(f.max<=f.min&&(f.min=k[0].rowIndex),f.max=k[k.length-1].rowIndex):(f.max<=f.min&&(f.max=k[k.length-1].rowIndex),f.min=k[0].rowIndex));t=a.nextSibling;g.destroy(a);h&&t&&t.offsetWidth&&(f=c.getScrollPosition(),c.scrollTo({x:f.x,y:f.y+t.offsetTop-h,preserveMomentum:!0}));
e.totalLength.then(function(a){"queryLevel"in w||(c._total=a,c._rows&&c._rows.max>=c._total-1&&(c._rows.max=Infinity));d&&(d.count=a-d.node.rowIndex,b(d))});c._processScroll();return k},function(b){g.destroy(a);throw b;})})(F,H,G)});u=u.previous}}}}return q}}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/aspect dojo/dom-construct dojo/has dojo/on dojo/when".split(" "),function(t,n,q,r,g,p,m,f){function l(a){if("object"!==typeof a)a=Error(a);else if("cancel"===
a.dojoType)return;m.emit(this.domNode,"dgrid-error",{grid:this,error:a,cancelable:!0,bubbles:!0})&&console.error(a)}return t(null,{collection:null,_renderedCollection:null,_rows:null,_observerHandle:null,shouldTrackCollection:!1,getBeforePut:!0,noDataMessage:"",loadingMessage:"",_total:0,constructor:function(){this.dirty={};this._updating={};this._columnsWithSet={};r.before(this,"configStructure",n.hitch(this,function(){this._columnsWithSet={}}))},destroy:function(){this.inherited(arguments);this._renderedCollection&&
this._cleanupCollection()},_configColumn:function(a){a.set&&(this._columnsWithSet[a.field]=a);this.inherited(arguments)},_setCollection:function(a){this._renderedCollection&&(this.cleanup(),this._cleanupCollection({shouldRevert:!a||a.storage!==this._renderedCollection.storage}));this.collection=a;if(this._started){if(a){var b=a;this.sort&&0<this.sort.length&&(b=a.sort(this.sort));b.track&&this.shouldTrackCollection&&(b=b.track(),this._rows=[],this._observerHandle=this._observeCollection(b,this.contentNode,
{rows:this._rows}));this._renderedCollection=b}this.refresh()}},_setStore:function(){},_getTotal:function(){return this._total},_cleanupCollection:function(a){a=a||{};this._renderedCollection.tracking&&this._renderedCollection.tracking.remove();this._observerHandle&&(this._observerHandle.remove(),this._observerHandle=this._rows=null);!1!==a.shouldRevert&&(this.dirty={});this._renderedCollection=this.collection=null},_applySort:function(){this.collection&&this.set("collection",this.collection)},row:function(){var a=
this.inherited(arguments);a&&a.data&&"undefined"!==typeof a.id&&(this.collection?a.id=this.collection.getIdentity(a.data):console.error("_StoreMixin:have no collection!"));return a},refresh:function(){var a=this.inherited(arguments);this.collection||(this.noDataNode=g.create("div",{className:"dgrid-no-data",innerHTML:this.noDataMessage},this.contentNode),this._emit("noData"));return a},refreshCell:function(a){if(!this.collection||!this._createBodyRowCell)return!1;if(a.column){if(a.column&&a.column.selector)return(new q).resolve();
this.inherited(arguments);return this.collection.get(a.row.id).then(n.hitch(this,"_refreshCellFromItem",a))}},_refreshCellFromItem:function(a,b,e){if(a&&a.element){var c=a.element;c.widget&&c.widget.destroyRecursive();g.empty(c);var k=this.dirty&&this.dirty[a.row.id];k&&(b=n.delegate(b,k));this._createBodyRowCell(c,a.column,b,e)}},renderArray:function(){var a=this.inherited(arguments);this.collection||a.length&&this.noDataNode&&g.destroy(this.noDataNode);return a},insertRow:function(a,b,e,c,k){var h=
this.collection,d=this.dirty,h=h&&h.getIdentity(a),f;h in d&&!(h in this._updating)&&(f=d[h]);f&&(a=n.delegate(a,f));d=this.inherited(arguments);k&&k.rows&&(k.rows[c]=d);this.noDataNode&&(g.destroy(this.noDataNode),this.noDataNode=null);return d},updateDirty:function(a,b,e){var c=this.dirty,k=c[a];k||(k=c[a]={});k[b]=e},save:function(){function a(a,d){return function(k){var f=b._columnsWithSet,u=b._updating,g,p;if("function"===typeof k.set)k.set(d);else for(g in d)k[g]=d[g];for(g in f)p=f[g].set(k),
void 0!==p&&(k[g]=p);u[a]=!0;return e.put(k).then(function(b){delete c[a];delete u[a];h[a]=b;return h})}}var b=this,e=this.collection,c=this.dirty,k=new q,h={},d=function(a){var d;return b.getBeforePut||!(d=b.row(a).data)?function(){return e.get(a)}:function(){return d}},f=k.then(function(){return h}),g;for(g in c)var p=a(g,c[g]),f=f.then(d(g)).then(p);k.resolve();return f},revert:function(){this.dirty={};this.refresh()},_trackError:function(a){"string"===typeof a&&(a=n.hitch(this,a));var b=this,
e;try{e=f(a())}catch(c){a=new q,a.reject(c),e=a.promise}e.otherwise(function(a){l.call(b,a)});return e},removeRow:function(a,b,e){var c={element:a};!b&&this.noDataMessage&&this.up(c).element===a&&this.down(c).element===a&&(this.noDataNode=g.create("div",{className:"dgrid-no-data",innerHTML:this.noDataMessage},this.contentNode),this._emit("noData"));(c=e&&e.rows||this._rows)&&delete c[a.rowIndex];return this.inherited(arguments)},renderQueryResults:function(a,b,e){e=n.mixin({rows:this._rows},e);var c=
this;return a.then(function(a){a=c.renderArray(a,b,e);delete c._lastCollection;return a})},_observeCollection:function(a,b,e){var c=this,k=e.rows,h,d=[a.on("delete, update",function(a){var d=a.previousIndex,f=a.index;void 0!==d&&k[d]&&("max"in k&&(void 0===f||f<k.min||f>k.max)&&k.max--,h=k[d],h.parentNode===b&&c.removeRow(h,!1,e),k.splice(d,1),("delete"===a.type||"update"===a.type&&(d<f||void 0===f))&&k[d]&&k[d].rowIndex--);"delete"===a.type&&(h=null)}),a.on("add, update",function(a){var d=a.previousIndex,
f=a.index;if(void 0!==f&&(!("max"in k)||f>=k.min&&f<=k.max)){"max"in k&&(void 0===d||d<k.min||d>k.max)&&k.max++;if(k.length){if(d=k[f],!d&&(d=k[f-1]))d=(d.connected||d).nextSibling}else d=c._getFirstRowSibling&&c._getFirstRowSibling(b);h&&d&&h.id===d.id&&(d=(d.connected||d).nextSibling);d&&!d.parentNode&&(d=document.getElementById(d.id));k.splice(f,0,void 0);h=c.insertRow(a.target,b,d,f,e);c.highlightRow(h)}h=null}),a.on("add, delete, update",function(d){var b="undefined"!==typeof d.previousIndex?
d.previousIndex:Infinity,h="undefined"!==typeof d.index?d.index:Infinity,e=Math.min(b,h);b!==h&&k[e]&&c.adjustRowIndices(k[e]);Infinity!==b&&c._processScroll&&(k[b]||k[b-1])&&c._processScroll();c._onNotification(k,d,a);a===c._renderedCollection&&"totalLength"in d&&(c._total=d.totalLength)})];return{remove:function(){for(;0<d.length;)d.pop().remove()}}},_onNotification:function(){}})})},"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(t,n,q){return t([n,
q],{})})},"dgrid/extensions/ColumnReorder":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/dom-class dojo/on dojo/query dojo/dnd/Source".split(" "),function(t,n,q,r,g,p){function m(a,e){var c=e[2],k=a[c?"columnSets":"subRows"][e[1]];return c?k[e[2]]:k}function f(a,e,c){e[2]?a.columnSets[e[1]][e[2]]=c:a.subRows[e[1]]=c}function l(a,e){return e.slice(("dgrid-"+a+"-").length)}var a=/(\d+)(?:-(\d+))?$/;t=n(p,{copyState:function(){return!1},checkAcceptance:function(a){return a===
this},_legalMouseDown:function(a){return-1<a.target.className.indexOf("dgrid-resize-handle")?!1:this.inherited(arguments)},onDropInternal:function(b){var e=this.grid,c=a.exec(l(e.id,b[0].getAttribute("dndType"))),k=c[2]?"columnSets":"subRows",h=m(e,c),d=e.columns;this.inherited(arguments);c&&setTimeout(function(){var a=q.map(b[0].parentNode.childNodes,function(a){return d[a.columnId]});f(e,c,a);a={grid:e,subRow:a,column:d[b[0].columnId],bubbles:!0,cancelable:!0,parentType:"dnd"};a[k]=e[k];g.emit(e.domNode,
"dgrid-columnreorder",a)?e.set(k,e[k]):(f(e,c,h),e.renderHeader(),e.sort.length&&e.updateSortArrow(e.sort))},0)}});n=n("dgrid.ColumnReorder",null,{columnDndConstructor:t,_initSubRowDnd:function(a,e){var c,k,h,d;k=0;for(h=a.length;k<h;k++)d=a[k],!1!==d.reorderable&&(d=d.headerNode,r.add(d,"dojoDndItem"),d.setAttribute("dndType",e),c||(c=d.parentNode));c&&this._columnDndSources.push(new this.columnDndConstructor(c,{horizontal:!0,grid:this}))},renderHeader:function(){var a="dgrid-"+this.id+"-",e,c;this.inherited(arguments);
this._columnDndSources=[];if(this.columnSets)for(c=0,e=this.columnSets.length;c<e;c++)q.forEach(this.columnSets[c],function(e,h){this._initSubRowDnd(e,a+c+"-"+h)},this);else q.forEach(this.subRows,function(c,h){this._initSubRowDnd(c,a+h)},this)},_destroyColumns:function(){this._columnDndSources&&q.forEach(this._columnDndSources,function(a){a&&a.destroy&&a.destroy()});this.inherited(arguments)}});n.ColumnDndSource=t;return n})},"dgrid/extensions/ColumnResizer":function(){define("dojo/_base/declare dojo/on dojo/query dojo/_base/lang dojo/dom dojo/dom-construct dojo/dom-geometry dojo/has ../util/misc dojo/_base/html".split(" "),
function(t,n,q,r,g,p,m,f,l){function a(a){for(var d=a.length,b=d,c=a[0].length,e=Array(d);d--;)e[d]=Array(c);for(var k={},d=0;d<b;d++)for(var f=e[d],g=a[d],p=0,m=0;p<c;p++){var l=g[m],n;if("undefined"===typeof f[p]){f[p]=l.id;if(l.rowSpan&&1<l.rowSpan){n=e;for(var q=l.rowSpan,r=d,t=p,E=l.id,F=1;F<q;F++)n[r+F][t]=E}if(0<d&&l.colSpan&&1<l.colSpan)for(n=1;n<l.colSpan;n++)if(f[++p]=l.id,l.rowSpan&&1<l.rowSpan)for(var q=e,r=l.rowSpan,t=d,E=p,F=l.id,J=1;J<r;J++)q[t+J][E]=F;k[l.id]=a[0][p].id;m++}}return k}
function b(a,d,b,c,e){if(!(0>=b)){var f=a.columns[d],k;if(f&&(k={grid:a,columnId:d,width:b,bubbles:!0,cancelable:!0},c&&(k.parentType=c),!a._resizedColumns||n.emit(a.headerNode,"dgrid-columnresize",k)))return"auto"===b?delete f.width:(f.width=b,b+="px"),(c=a._columnSizes[d])?c.set("width",b):c=l.addCssRule("#"+l.escapeCssIdentifier(a.domNode.id)+" .dgrid-column-"+l.escapeCssIdentifier(d,"-"),"width: "+b+";"),a._columnSizes[d]=c,!1!==e&&a.resize(),!0}}var e,c=0,k={create:function(){e=p.create("div",
{className:"dgrid-column-resizer"})},destroy:function(){p.destroy(e);e=null},show:function(a){a=m.position(a.domNode,!0);e.style.top=a.y+"px";e.style.height=a.h+"px";document.body.appendChild(e)},move:function(a){e.style.left=a+"px"},hide:function(){e.parentNode.removeChild(e)}};return t("dgrid.ColumnResizer",null,{resizeNode:null,minWidth:40,adjustLastColumn:!0,_resizedColumns:!1,buildRendering:function(){this.inherited(arguments);c||k.create();c++},destroy:function(){this.inherited(arguments);for(var a in this._columnSizes)this._columnSizes[a].remove();
--c||k.destroy()},resizeColumnWidth:function(a,d){return b(this,a,d)},configStructure:function(){var a=this._oldColumnSizes=r.mixin({},this._columnSizes),d;this._resizedColumns=!1;this._columnSizes={};this.inherited(arguments);for(d in a)d in this._columnSizes||a[d].remove();delete this._oldColumnSizes},_configColumn:function(a){this.inherited(arguments);var d=a.id,b;"width"in a&&((b=this._oldColumnSizes[d])?b.set("width",a.width+"px"):b=l.addCssRule("#"+l.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+
l.escapeCssIdentifier(d,"-"),"width: "+a.width+"px;"),this._columnSizes[d]=b)},renderHeader:function(){this.inherited(arguments);var b=this,d;if(this.columnSets&&this.columnSets.length)for(var c=this.columnSets.length;c--;)d=r.mixin(d||{},a(this.columnSets[c]));else this.subRows&&1<this.subRows.length&&(d=a(this.subRows));for(var c=q(".dgrid-cell",b.headerNode),e=c.length;e--;){var k=c[e],g=k.columnId,m=b.columns[g],t=k.childNodes;if(m&&!1!==m.resizable){m=p.create("div",{className:"dgrid-resize-header-container"});
for(k.contents=m;0<t.length;)m.appendChild(t[0]);t=p.create("div",{className:"dgrid-resize-handle resizeNode-"+l.escapeCssIdentifier(g,"-")},m);k.appendChild(m);t.columnId=d&&d[g]||g}}b.mouseMoveListen||(n(b.headerNode,".dgrid-resize-handle:mousedown"+(f("touch")?",.dgrid-resize-handle:touchstart":""),function(a){b._resizeMouseDown(a,this);b.mouseMoveListen.resume();b.mouseUpListen.resume()}),b._listeners.push(b.mouseMoveListen=n.pausable(document,"mousemove"+(f("touch")?",touchmove":""),l.throttleDelayed(function(a){b._updateResizerPosition(a)}))),
b._listeners.push(b.mouseUpListen=n.pausable(document,"mouseup"+(f("touch")?",touchend":""),function(a){b._resizeMouseUp(a);b.mouseMoveListen.pause();b.mouseUpListen.pause()})),b.mouseMoveListen.pause(),b.mouseUpListen.pause())},_resizeMouseDown:function(a,b){a.preventDefault();g.setSelectable(this.domNode,!1);this._startX=this._getResizeMouseLocation(a);this._targetCell=q(".dgrid-column-"+l.escapeCssIdentifier(b.columnId,"-"),this.headerNode)[0];this._updateResizerPosition(a);k.show(this)},_resizeMouseUp:function(a){var d=
this._columnSizes,c,e,f;this.adjustLastColumn&&(f=this.headerNode.clientWidth-1);this._resizedColumns||(c=q(".dgrid-cell",this.headerNode),this.columnSets&&this.columnSets.length?c=c.filter(function(a){return"0"===a.columnId.split("-")[0]&&!(a.columnId in d)}):this.subRows&&1<this.subRows.length&&(c=c.filter(function(a){return"0"===a.columnId.charAt(0)&&!(a.columnId in d)})),e=c.map(function(a){return a.offsetWidth}),c.forEach(function(a,d){b(this,a.columnId,e[d],null,!1)},this),this._resizedColumns=
!0);g.setSelectable(this.domNode,!0);c=this._targetCell;var p=this._getResizeMouseLocation(a)-this._startX,m=c.offsetWidth+p,n=this._getResizedColumnWidths(),v=n.totalWidth,n=n.lastColId,r=q(".dgrid-column-"+l.escapeCssIdentifier(n,"-"),this.headerNode)[0].offsetWidth;m<this.minWidth&&(m=this.minWidth);b(this,c.columnId,m,a.type)&&c.columnId!==n&&this.adjustLastColumn&&(v+p<f?b(this,n,"auto",a.type):r-p<=this.minWidth&&b(this,n,this.minWidth,a.type));k.hide();delete this._startX;delete this._targetCell},
_updateResizerPosition:function(a){if(this._targetCell){a=this._getResizeMouseLocation(a);var b=this._targetCell.offsetWidth,c=a;b+(a-this._startX)<this.minWidth&&(c=this._startX-(b-this.minWidth));k.move(c)}},_getResizeMouseLocation:function(a){var b=0;a.pageX?b=a.pageX:a.clientX&&(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft);return b},_getResizedColumnWidths:function(){var a=0,b=q((this.columnSets?".dgrid-column-set-cell ":"")+"tr:first-child .dgrid-cell",this.headerNode),
c=b.length;if(!c)return{};for(var e=b[c-1].columnId;c--;)a+=b[c].offsetWidth;return{totalWidth:a,lastColId:e}}})})},"dgrid/extensions/CompoundColumns":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/sniff","dojo/query","../util/misc"],function(t,n,q,r,g){return n(null,{configStructure:function(){function p(b,d,c,e){var k=0,m=function(){},n,q;g.each(b,function(g,r){"string"===typeof g&&(g={label:g});b instanceof Array||g.field||(g.field=r);q=(n=g.children)&&!1!==g.showChildHeaders;
g.parentColumn=e;n?null==g.id?g.id=(e&&e.id||d-1)+"-"+l.length:e&&e.id&&(g.id=e.id+"-"+g.id):(a.push(g),l.push(t.delegate(g,{renderHeaderCell:m})),k++);q||(g=t.delegate(g,{rowSpan:-d}));n&&(k+=g.colSpan=p(n,d+1,q,g));c&&(f[d]||(f[d]=[])).push(g)},this);return k}var m=this.subRows&&this.subRows[0]||this.columns,f=[[]],l=f[0],a=[];f[0].className="dgrid-spacer-row";p(m,1,!0);var m=f.length,b,e,c,k;for(b=0;b<m;b++)for(c=f[b],e=0;e<c.length;e++)k=c[e],1>k.rowSpan&&(k.rowSpan+=m);a=[a];a.headerRows=f;this.subRows=
a;this.inherited(arguments)},renderHeader:function(){var g,m=this.subRows[0],f=this.subRows.headerRows[0];this.inherited(arguments);for(g=m.length;g--;)m[g].headerNode=f[g].headerNode},_findSortArrowParent:function(){var p=this.inherited(arguments);if(p&&g.contains(r(".dgrid-spacer-row",this.headerNode)[0],p))return p=p.columnId||p.parentNode.columnId,p=r(".dgrid-column-"+p,this.headerNode),p[p.length-1]},_configColumn:function(g,m,f){var l=g.parentColumn,a=g.id;l&&(a=0===a.indexOf(f)?a.substring(f.length):
a,f=l.id+"-",g.id=f+a);this.inherited(arguments,[g,m,f])},cell:function(g,m){if("object"!==typeof m){var f=this.column(m);f&&(m=f.id)}return this.inherited(arguments,[g,m])},column:function(g){var m=this.inherited(arguments);if(null==m&&"object"!==typeof g){var f="-"+g,l=f.length,a;for(a in this.columns)if(-1!==a.indexOf(f,a.length-l))return this.columns[a]}return m},_updateCompoundHiddenStates:function(g,m){var f=this.columns[g],l;if(!f||f.hidden!==m)for(;f&&f.parentColumn;){f=f.parentColumn;if(l=
f.colSpan+=m?-1:1)f.headerNode.colSpan=l;1!==l||m?!l&&m&&this._hideColumn(f.id):this._showColumn(f.id)}},_hideColumn:function(g){var m=this;this._updateCompoundHiddenStates(g,!0);this.inherited(arguments);q("ff")&&(this.headerNode.style.display="none",setTimeout(function(){m.headerNode.style.display="";m.resize()},0))},_showColumn:function(g){this._updateCompoundHiddenStates(g,!1);this.inherited(arguments)},_getResizedColumnWidths:function(){var g=0,m=this.columns,f;for(f in m)g+=m[f].headerNode.offsetWidth;
return{totalWidth:g,lastColId:this.subRows[0][this.subRows[0].length-1].id}}})})},"dgrid/extensions/Pagination":function(){define("../_StoreMixin dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on dojo/query dojo/string dojo/has dojo/when ../util/misc dojo/_base/sniff".split(" "),function(t,n,q,r,g,p,m,f,l,a,b,e){function c(a){a.noDataNode?(g.destroy(a.noDataNode),delete a.noDataNode):a.cleanup();a.contentNode.innerHTML=""}function k(a){if(a.loadingNode)g.destroy(a.loadingNode),
delete a.loadingNode;else if(a._oldPageNodes){for(var b in a._oldPageNodes)a.removeRow(a._oldPageNodes[b]);delete a._oldPageNodes}delete a._isLoading}return n(t,{rowsPerPage:10,pagingTextBox:!1,previousNextArrows:!0,firstLastArrows:!1,pagingLinks:2,pageSizeOptions:null,showLoadingMessage:!0,i18nPagination:{status:"${start} - ${end} of ${total} results",gotoFirst:"Go to first page",gotoNext:"Go to next page",gotoPrev:"Go to previous page",gotoLast:"Go to last page",gotoPage:"Go to page",jumpPage:"Jump to page",
rowsPerPage:"Number of rows per page"},showFooter:!0,_currentPage:1,buildRendering:function(){this.inherited(arguments);var a=this,b=this.paginationNode=g.create("div",{className:"dgrid-pagination"},this.footerNode),c=this.paginationStatusNode=g.create("div",{className:"dgrid-status"},b),e=this.i18nPagination;c.tabIndex=0;this.addUiClasses&&p.add(this.footerNode,"ui-widget-content");this._updatePaginationSizeSelect();this._updateRowsPerPageOption();this._updatePaginationStatus(this._total);b=this.paginationNavigationNode=
g.create("div",{className:"dgrid-navigation"},b);this.firstLastArrows&&(this.paginationFirstNode=g.create("span",{"aria-label":e.gotoFirst,className:"dgrid-first dgrid-page-link",innerHTML:"\u00ab",tabIndex:0},b));this.previousNextArrows&&(this.paginationPreviousNode=g.create("span",{"aria-label":e.gotoPrev,className:"dgrid-previous dgrid-page-link",innerHTML:"\u2039",tabIndex:0},b));this.paginationLinksNode=g.create("span",{className:"dgrid-pagination-links"},b);this.previousNextArrows&&(this.paginationNextNode=
g.create("span",{"aria-label":e.gotoNext,className:"dgrid-next dgrid-page-link",innerHTML:"\u203a",tabIndex:0},b));this.firstLastArrows&&(this.paginationLastNode=g.create("span",{"aria-label":e.gotoLast,className:"dgrid-last dgrid-page-link",innerHTML:"\u00bb",tabIndex:0},b));this._listeners.push(m(b,".dgrid-page-link:click,.dgrid-page-link:keydown",function(b){if("keydown"!==b.type||13===b.keyCode){b=this.className;var d,c;a._isLoading||-1<b.indexOf("dgrid-page-disabled")||(d=a._currentPage,c=Math.ceil(a._total/
a.rowsPerPage),this===a.paginationPreviousNode?a.gotoPage(d-1):this===a.paginationNextNode?a.gotoPage(d+1):this===a.paginationFirstNode?a.gotoPage(1):this===a.paginationLastNode?a.gotoPage(c):"dgrid-page-link"===b&&a.gotoPage(+this.innerHTML))}}))},destroy:function(){this.inherited(arguments);this._pagingTextBoxHandle&&this._pagingTextBoxHandle.remove()},_updatePaginationSizeSelect:function(){var a=this.pageSizeOptions,b=this.paginationSizeSelect,c;if(a&&a.length){b||(b=this.paginationSizeSelect=
g.create("select",{"aria-label":this.i18nPagination.rowsPerPage,className:"dgrid-page-size"},this.paginationNode),c=this._paginationSizeChangeHandle=m(b,"change",r.hitch(this,function(){this.set("rowsPerPage",+this.paginationSizeSelect.value)})),this._listeners.push(c));for(c=b.options.length=0;c<a.length;c++)g.create("option",{innerHTML:a[c],selected:this.rowsPerPage===a[c],value:a[c]},b);this._updateRowsPerPageOption()}else a&&a.length||!b||(g.destroy(b),this.paginationSizeSelect=null,this._paginationSizeChangeHandle.remove())},
_setPageSizeOptions:function(a){this.pageSizeOptions=a&&a.sort(function(a,b){return a-b});this._updatePaginationSizeSelect()},_updateRowsPerPageOption:function(){var a=this.rowsPerPage,b=this.pageSizeOptions,c=this.paginationSizeSelect;c&&(0>q.indexOf(b,a)?this._setPageSizeOptions(b.concat([a])):c.value=""+a)},_setRowsPerPage:function(a){this.rowsPerPage=a;this._updateRowsPerPageOption();this.gotoPage(1)},_updateNavigation:function(a){function b(a,d){var c,e;l.pagingTextBox&&a===r&&1<A?(c=g.create("input",
{"aria-label":n.jumpPage,className:"dgrid-page-input",type:"text",value:r},q),l._pagingTextBoxHandle=m(c,"change",function(){var a=+this.value;!isNaN(a)&&0<a&&a<=A&&l.gotoPage(+this.value)}),w&&"INPUT"===w.tagName&&c.focus()):(e=a===r,c=g.create("span",{"aria-label":n.gotoPage,className:"dgrid-page-link"+(e?" dgrid-page-disabled":""),innerHTML:a+(d?" ":""),tabIndex:e?-1:0},q),I===a&&(e?a<A?I++:G.focus():c.focus()),e||(G=c))}function c(a,b){p.toggle(a,"dgrid-page-disabled",b);a.tabIndex=b?-1:0}function k(){g.create("span",
{className:"dgrid-page-skip",innerHTML:"..."},q)}var l=this,n=this.i18nPagination,q=this.paginationLinksNode,r=this._currentPage,v=this.pagingLinks,t=this.paginationNavigationNode,A=Math.ceil(a/this.rowsPerPage);a=this._pagingTextBoxHandle;var w=document.activeElement,I,G;w&&e.contains(this.paginationNavigationNode,w)?"dgrid-page-link"===w.className&&(I=+w.innerHTML):w=null;a&&a.remove();q.innerHTML="";f(".dgrid-first, .dgrid-previous",t).forEach(function(a){c(a,1===r)});f(".dgrid-last, .dgrid-next",
t).forEach(function(a){c(a,r>=A)});if(v&&0<A){b(1,!0);t=r-v;for(2<t?k():t=2;t<Math.min(r+v+1,A);t++)b(t,!0);r+v+1<A&&k();1<A&&b(A)}else l.pagingTextBox&&b(r);w&&-1===w.tabIndex&&(v=f('[tabindex\x3d"0"]',this.paginationNavigationNode),w===this.paginationPreviousNode||w===this.paginationFirstNode?w=v[0]:v.length&&(w=v[v.length-1]),w&&w.focus())},_updatePaginationStatus:function(a){var b=this.rowsPerPage,c=Math.min(a,(this._currentPage-1)*b+1);this.paginationStatusNode.innerHTML=l.substitute(this.i18nPagination.status,
{start:c,end:Math.min(a,c+b-1),total:a})},refresh:function(a){var b=this,c=a&&a.keepCurrentPage?Math.min(this._currentPage,Math.ceil(this._total/this.rowsPerPage)):1;this.inherited(arguments);return this.gotoPage(c).then(function(a){setTimeout(function(){m.emit(b.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:b})},0);return a})},_onNotification:function(a,b,c){a=this.rowsPerPage;var e=this._currentPage*a;"add"===b.type&&b.index<e||"delete"===b.type&&b.previousIndex<e||"update"===
b.type&&Math.floor(b.index/a)!==Math.floor(b.previousIndex/a)?this.gotoPage(Math.min(this._currentPage,Math.ceil(b.totalLength/this.rowsPerPage))):c===this._renderedCollection&&b.totalLength!==this._total&&(this._updatePaginationStatus(b.totalLength),this._updateNavigation(b.totalLength))},renderQueryResults:function(a,b){var c=this,e=this.inherited(arguments);b||(this._topLevelRequest&&(this._topLevelRequest.cancel(),delete this._topLevelRequest),"function"===typeof e.cancel&&(this._topLevelRequest=
e),e.then(function(){c._topLevelRequest&&delete c._topLevelRequest}));return e},insertRow:function(){var a=this._oldPageNodes,b=this.inherited(arguments);a&&b===a[b.id]&&delete a[b.id];return b},gotoPage:function(a){var d=this,e=(this._currentPage-1)*this.rowsPerPage;if(!this._renderedCollection)return b([]);this._renderedCollection.releaseRange&&this._renderedCollection.releaseRange(e,e+this.rowsPerPage);return this._trackError(function(){var b=d.rowsPerPage,e=(a-1)*b,f={start:e,count:b},m,l=d.contentNode,
p,n,u;if(d.showLoadingMessage)c(d),d.loadingNode=g.create("div",{className:"dgrid-loading",innerHTML:d.loadingMessage},l);else for(d._oldPageNodes=p={},l=l.children,n=0,u=l.length;n<u;n++)p[l[n].id]=l[n];d._isLoading=!0;m=d._renderedCollection.fetchRange({start:e,end:e+b});return d.renderQueryResults(m,null,f).then(function(c){k(d);d.scrollTo({y:0});d._rows&&(d._rows.min=e,d._rows.max=e+b-1);m.totalLength.then(function(b){b||(d.noDataNode&&(g.destroy(d.noDataNode),delete d.noDataNode),d.noDataNode=
g.create("div",{className:"dgrid-no-data",innerHTML:d.noDataMessage},d.contentNode));d._total=b;d._currentPage=a;d._rowsOnPage=c.length;d._updatePaginationStatus(b);d._updateNavigation(b)});return m},function(a){k(d);throw a;})})}})})},"dgrid/extensions/DnD":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/aspect dojo/dom-class dojo/on dojo/topic dojo/has dojo/when dojo/dnd/Source dojo/dnd/Manager dojo/_base/NodeList ../Selection dojo/has!touch?../util/touch dojo/has!touch?./_DnD-touch-autoscroll".split(" "),
function(t,n,q,r,g,p,m,f,l,a,b,e,c,k){var h=t(a,{grid:null,getObject:function(a){var b=this.grid;return b.collection.get(a.id.slice(b.id.length+5))},_legalMouseDown:function(a){return this.inherited(arguments)&&a.target!==this.grid.bodyNode},onDrop:function(a,b,c){var e=this,h=this._targetAnchor=this.targetAnchor,k=this.grid,f=k.collection;!this.before&&h&&(h=h.nextSibling);h=h&&k.row(h);l(h&&f.get(h.id),function(h){if(e!==a)e.onDropExternal(a,b,c,h);else e.onDropInternal(b,c,h)})},onDropInternal:function(a,
b,c){var e=this.grid,h=e.collection,k=this,f=k._targetAnchor,g;f&&(g=this.before?f.previousSibling:f.nextSibling);f=e.row(a[0]);(b||g!==a[0]&&(c||!f||e.down(f).element!==a[0]))&&a.forEach(function(a){l(k.getObject(a),function(a){var d=h.getIdentity(a);h[b&&h.copy?"copy":"put"](a,{beforeId:c?h.getIdentity(c):null});k._selectedNodes[d]&&(k._selectedNodes[d]=e.row(d).element)})})},onDropExternal:function(a,b,c,e){var h=this.grid.collection,k=a.grid;b.forEach(function(b,f){l(a.getObject(b),function(g){c||
(k?l(k.collection.getIdentity(g),function(c){!f&&a.selectNone();a.delItem(b.id);k.collection.remove(c)}):a.deleteSelectedNodes());h[h.copy?"copy":"put"](g,{beforeId:e?h.getIdentity(e):null})})})},onDndStart:function(a){this.inherited(arguments);a===this&&(this.grid.cancelTouchScroll&&this.grid.cancelTouchScroll(),b.manager().avatar.node.style.width=this.grid.domNode.offsetWidth/2+"px")},onMouseDown:function(a){f("touch")&&this.isDragging&&1<k.countCurrentTouches(a,this.grid.touchNode)?(m.publish("/dnd/cancel"),
b.manager().stopDrag()):this.inherited(arguments)},onMouseMove:function(a){(!f("touch")||1>=k.countCurrentTouches(a,this.grid.touchNode))&&this.inherited(arguments)},checkAcceptance:function(b){return b.getObject&&a.prototype.checkAcceptance.apply(this,arguments)},getSelectedNodes:function(){if(!this.grid.selection)return this.inherited(arguments);var a=new e,b;for(b in this.grid.selection)a.push(this._selectedNodes[b]);return a}});t=t(c,{dndSourceType:"dgrid-row",dndParams:null,dndConstructor:h,
postMixInProperties:function(){this.inherited(arguments);this.dndParams=n.mixin({accept:[this.dndSourceType]},this.dndParams)},postCreate:function(){function a(b){c[b.id]=b.element}function b(a){delete c[a.id];g.remove(a.element,"dojoDndItemSelected dojoDndItemAnchor")}this.inherited(arguments);this.dndSource=new (this.dndConstructor||h)(this.bodyNode,n.mixin(this.dndParams,{grid:this,dropParent:this.contentNode}));var c=this.dndSource._selectedNodes={};this.on("dgrid-select",function(b){q.forEach(b.rows,
a)});this.on("dgrid-deselect",function(a){q.forEach(a.rows,b)});r.after(this,"destroy",function(){delete this.dndSource._selectedNodes;c=null;this.dndSource.destroy()},!0)},insertRow:function(a){var b=this.inherited(arguments),c="function"===typeof this.getObjectDndType?this.getObjectDndType(a):[this.dndSourceType];g.add(b,"dojoDndItem");this.dndSource.setItem(b.id,{data:a,type:c instanceof Array?c:[c]});return b},removeRow:function(a){this.dndSource.delItem(this.row(a));this.inherited(arguments)}});
t.GridSource=h;return t})},"dgrid/Editor":function(){define("dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/dom-construct dojo/dom-class dojo/on dojo/has dojo/query ./Grid dojo/_base/sniff".split(" "),function(t,n,q,r,g,p,m,f,l){return t(null,{constructor:function(){this._editorInstances={};this._editorColumnListeners=[];this._editorCellListeners={};this._editorsPendingStartup=[]},postCreate:function(){var a=this;this.inherited(arguments);this.on(".dgrid-input:focusin",function(){a._focusedEditorCell=
a.cell(this)});this._editorFocusoutHandle=p.pausable(this.domNode,".dgrid-input:focusout",function(){a._focusedEditorCell=null});this._listeners.push(this._editorFocusoutHandle)},insertRow:function(){this._editorRowListeners={};var a=this.inherited(arguments),b=this.row(a),e=this._editorCellListeners[a.id]=this._editorCellListeners[a.id]||{},c;for(c in this._editorRowListeners)e[c]=this._editorRowListeners[c];this._editorRowListeners=null;(e=this._previouslyFocusedEditorCell)&&e.row.id===b.id&&this.edit(this.cell(b,
e.column.id));return a},refresh:function(){for(var a in this._editorInstances){var b=this._editorInstances[a].domNode;b&&b.parentNode&&b.parentNode.removeChild(b)}this.inherited(arguments)},removeRow:function(a){var b=this,e=this._focusedEditorCell;e&&e.row.id===this.row(a).id&&(this._previouslyFocusedEditorCell=e,this._editorFocusoutHandle.pause(),setTimeout(function(){b._editorFocusoutHandle.resume();b._previouslyFocusedEditorCell=null},0));if(this._editorCellListeners[a.id]){for(var c in this._editorCellListeners[a.id])this._editorCellListeners[a.id][c].remove();
delete this._editorCellListeners[a.id]}for(e=this._alwaysOnWidgetColumns.length;e--;)if(c=(c=this.cell(a,this._alwaysOnWidgetColumns[e].id).element)&&(c.contents||c).widget)this._editorFocusoutHandle.pause(),c.destroyRecursive();return this.inherited(arguments)},renderArray:function(){var a=this.inherited(arguments);a.length?this._startupPendingEditors():this._editorsPendingStartup=[];return a},_onNotification:function(){this.inherited(arguments);this._startupPendingEditors()},_destroyColumns:function(){this._editorStructureCleanup();
this.inherited(arguments)},_editorStructureCleanup:function(){var a=this._editorInstances,b=this._editorColumnListeners;this._editTimer&&clearTimeout(this._editTimer);for(var e in a){var c=a[e];c.domNode&&c.destroyRecursive()}this._editorInstances={};for(a=b.length;a--;)b[a].remove();for(var k in this._editorCellListeners)for(e in this._editorCellListeners[k])this._editorCellListeners[k][e].remove();for(a=0;a<this._editorColumnListeners.length;a++)this._editorColumnListeners[a].remove();this._editorCellListeners=
{};this._editorColumnListeners=[];this._editorsPendingStartup=[]},_configColumns:function(){var a=this.inherited(arguments);this._alwaysOnWidgetColumns=[];for(var b=0,e=a.length;b<e;b++)a[b].editor&&this._configureEditorColumn(a[b]);return a},_configureEditorColumn:function(a){var b=this,e=a.renderCell||this._defaultRenderCell,c=a.editOn,k="string"!==typeof a.editor;c?this._editorInstances[a.id]=this._createSharedEditor(a,e):k&&this._alwaysOnWidgetColumns.push(a);a.renderCell=c?function(h,d,k,f){if(!f||
!f.alreadyHooked){var g=p(k,c,function(){b._activeOptions=f;b.edit(this)});if(b._editorRowListeners)b._editorRowListeners[a.id]=g;else{var m=b.row(h);b._editorCellListeners[m.element.id][a.id]=g}}return e.call(a,h,d,k,f)}:function(c,d,f,g){if(!a.canEdit||a.canEdit(c,d))g=b._createEditor(a),g.object=c,b._showEditor(g,a,f,d),f[k?"widget":"input"]=g;else return e.call(a,c,d,f,g)}},edit:function(a){function b(a){e._activeCell=k;e._showEditor(g,c,k,f);e._editTimer=setTimeout(function(){g.focus&&g.focus();
c._editorBlurHandle&&c._editorBlurHandle.resume();e._editTimer=null;a.resolve(g)},0)}var e=this,c,k,h,d,f,g,m;a.column||(a=this.cell(a));if(!a||!a.element)return null;c=a.column;d=c.field;k=a.element.contents||a.element;if(g=this._editorInstances[c.id]){if(this._activeCell!==k){var l=a.row;f=(h=this.dirty&&this.dirty[l.id])&&d in h?h[d]:c.get?c.get(l.data):l.data[d];if(!c.canEdit||c.canEdit(a.row.data,f))return m=new q,a=g.domNode||g,a.offsetWidth?(a.blur(),setTimeout(function(){b(m)},0)):b(m),m.promise}}else if(c.editor&&
(g=k.widget||k.input))return m=new q,g.focus&&g.focus(),m.resolve(g),m.promise;return null},refreshCell:function(a){var b=a.row.element.id,e=a.column.id;this._editorCellListeners[b]&&this._editorCellListeners[b][e]&&(this._editorCellListeners[b][e].remove(),this._editorCellListeners[b][e]=null);return this.inherited(arguments)},_showEditor:function(a,b,e,c){var f=a.domNode;f||this._updateInputValue(a,c);e.innerHTML="";g.add(e,"dgrid-cell-editing");f&&b.editOn&&a.validate&&a.reset&&a.reset();e.appendChild(a.domNode||
a);f&&!b.editOn?this._editorsPendingStartup.push([a,b,e,c]):this._startupEditor(a,b,e,c)},_startupEditor:function(a,b,e,c){a.domNode&&(a._started||a.startup(),a._dgridIgnoreChange=!0,a.set("value",c),setTimeout(function(){a._dgridIgnoreChange=!1},0));a._dgridLastValue=c;this._activeCell&&(this._activeValue=c,p.emit(e,"dgrid-editor-show",{grid:this,cell:this.cell(e),column:b,editor:a,bubbles:!0,cancelable:!1}))},_startupPendingEditors:function(){for(var a=this._editorsPendingStartup,b=a.length;b--;)this._startupEditor.apply(this,
a[b]);this._editorsPendingStartup=[]},_handleEditorChange:function(a,b){var e=a.target;"_dgridLastValue"in e&&-1<e.className.indexOf("dgrid-input")&&this._updatePropertyFromEditor(b||this.cell(e).column,e,a)},_createEditor:function(a){var b=a.editor,e=a.editOn,c=this,f="string"!==typeof b&&b,h,d,g={};h=a.editorArgs||{};"function"===typeof h&&(h=h.call(this,a));f?(d=new f(h),h=d.focusNode||d.domNode,h.className+=" dgrid-input",d.on(e?"blur":"change",function(){d._dgridIgnoreChange||c._updatePropertyFromEditor(a,
this,{type:"widget"})})):(this._hasInputListener||(this._hasInputListener=!0,this.on("change",function(a){c._handleEditorChange(a)})),"textarea"===b?f="textarea":(f="input",g.type=b),d=h=r.create(f,n.mixin(g,{className:"dgrid-input",name:a.field,tabIndex:isNaN(a.tabIndex)?-1:a.tabIndex},h)),9>m("ie")&&(b="radio"===b||"checkbox"===b?p(d,"click",function(b){c._handleEditorChange(b,a)}):p(d,"change",function(b){c._handleEditorChange(b,a)}),e?this._editorColumnListeners.push(b):this._editorRowListeners?
this._editorRowListeners[a.id]=b:this._editorCellListeners[this.row(object).element.id][a.id]=b));if(a.autoSelect){var l=d.focusNode||d;l.select&&p(l,"focus",function(){setTimeout(function(){l.select()},0)})}return d},_createSharedEditor:function(a){function b(){var a=c._activeCell;d.blur();"function"===typeof c.focus&&setTimeout(function(){c.focus(a)},f&&9>m("ie")?15:0)}var e=this._createEditor(a),c=this,f=e.domNode,h=e.domNode||e,d=e.focusNode||h,q=f?function(){e.set("value",e._dgridLastValue)}:
function(){c._updateInputValue(e,e._dgridLastValue);c._updatePropertyFromEditor(a,e)};this._editorColumnListeners.push(p(d,"keydown",function(d){d=d.keyCode||d.which;27===d?(q(),c._activeValue=e._dgridLastValue,b()):13===d&&!1!==a.dismissOnEnter&&b()}));(a._editorBlurHandle=p.pausable(e,"blur",function(){var b=h.parentNode,d={alreadyHooked:!0},f=c.cell(h);p.emit(f.element,"dgrid-editor-hide",{grid:c,cell:f,column:a,editor:e,bubbles:!0,cancelable:!1});a._editorBlurHandle.pause();b.removeChild(h);f.row&&
(g.remove(f.element,"dgrid-cell-editing"),r.empty(b),l.appendIfNode(b,a.renderCell(f.row.data,c._activeValue,b,c._activeOptions?n.delegate(d,c._activeOptions):d)));c._focusedEditorCell=c._activeCell=c._activeValue=c._activeOptions=null})).pause();this._editorColumnListeners.push(a._editorBlurHandle);return e},_updatePropertyFromEditor:function(a,b,e){var c;if(!b.isValid||b.isValid())if(e=this._updateProperty((b.domNode||b).parentNode,this._activeCell?this._activeValue:b._dgridLastValue,this._retrieveEditorValue(a,
b),e),this._activeCell?this._activeValue=e:b._dgridLastValue=e,"radio"===b.type&&b.name&&!a.editOn&&a.field)for(c in e=this.row(b),f("input[type\x3dradio][name\x3d"+b.name+"]",this.contentNode).forEach(function(c){var e=this.row(c);c!==b&&c._dgridLastValue&&(c._dgridLastValue=!1,this.updateDirty?this.updateDirty(e.id,a.field,!1):e.data[a.field]=!1)},this),this.dirty)e.id.toString()!==c&&this.dirty[c][a.field]&&this.updateDirty(c,a.field,!1)},_updateProperty:function(a,b,e,c){var f=this;if((b&&b.valueOf())!==
(e&&e.valueOf())){var h=this.cell(a),d=h.row,g=h.column;a=h.element;if(g.field&&d)if(h={grid:this,cell:h,oldValue:b,value:e,bubbles:!0,cancelable:!0},c&&c.type&&(h.parentType=c.type),p.emit(a,"dgrid-datachange",h))this.updateDirty?(this.updateDirty(d.id,g.field,e),g.autoSave&&setTimeout(function(){f._trackError("save")},0)):d.data[g.field]=e;else{var m;(m=a.widget)?(m._dgridIgnoreChange=!0,m.set("value",b),setTimeout(function(){m._dgridIgnoreChange=!1},0)):(m=a.input)&&this._updateInputValue(m,b);
return b}}return e},_updateInputValue:function(a,b){a.value=b;if("radio"===a.type||"checkbox"===a.type)a.checked=a.defaultChecked=!!b},_retrieveEditorValue:function(a,b){return"function"===typeof b.get?this._convertEditorValue(b.get("value")):this._convertEditorValue(b["checkbox"===b.type||"radio"===b.type?"checked":"value"])},_convertEditorValue:function(a,b){if("number"===typeof b)a=isNaN(a)?a:parseFloat(a);else if("boolean"===typeof b)a="true"===a?!0:"false"===a?!1:a;else if(b instanceof Date){var e=
new Date(a);a=isNaN(e.getTime())?a:e}return a}})})},"dstore/Store":function(){define("dojo/_base/lang dojo/_base/array dojo/aspect dojo/has dojo/when dojo/Deferred dojo/_base/declare dstore/QueryMethod dstore/Filter dojo/Evented".split(" "),function(t,n,q,r,g,p,m,f,l,a){function b(a){return function(b,e){var d=this;g(b,function(b){b={target:b};var f=e[1]||{};"beforeId"in f&&(b.beforeId=f.beforeId);d.emit(a,b)});return b}}r.add("object-proto",!!{}.__proto__&&!{}.watch);var e=r("object-proto");return m(a,
{constructor:function(c){c&&m.safeMixin(this,c);this.Model&&this.Model.createSubclass&&(this.Model=this.Model.createSubclass([]).extend({_store:this}));this.storage=new a;var e=this;this.autoEmitEvents&&(q.after(this,"add",b("add")),q.after(this,"put",b("update")),q.after(this,"remove",function(a,b){g(a,function(){e.emit("delete",{id:b[0]})});return a}))},autoEmitEvents:!0,idProperty:"id",queryAccessors:!0,getIdentity:function(a){return a.get?a.get(this.idProperty):a[this.idProperty]},_setIdentity:function(a,
b){a.set?a.set(this.idProperty,b):a[this.idProperty]=b},forEach:function(a,b){var e=this;return g(this.fetch(),function(d){for(var f=0,g;void 0!==(g=d[f]);f++)a.call(b,g,f,e);return d})},on:function(a,b){return this.storage.on(a,b)},emit:function(a,b){b=b||{};b.type=a;try{return this.storage.emit(a,b)}finally{return b.cancelable}},parse:null,stringify:null,Model:null,_restore:function(a,b){var f=this.Model;if(f&&a){var d=f.prototype,g=d._restore;g?a=g.call(a,f,b):e&&b?a.__proto__=d:a=t.delegate(d,
a)}return a},create:function(a){return new this.Model(a)},_createSubCollection:function(a){var b=t.delegate(this.constructor.prototype),e;for(e in this)this._includePropertyInSubCollection(e,b)&&(b[e]=this[e]);return m.safeMixin(b,a)},_includePropertyInSubCollection:function(a,b){return!(a in b)||b[a]!==this[a]},queryLog:[],filter:new f({type:"filter",normalizeArguments:function(a){var b=this.Filter;return a instanceof b?[a]:[new b(a)]}}),Filter:l,sort:new f({type:"sort",normalizeArguments:function(a,
b){var e;"function"===typeof a?e=[a]:(e=a instanceof Array?a.slice():"object"===typeof a?[].slice.call(arguments):[{property:a,descending:b}],e=n.map(e,function(a){a=t.mixin({},a);a.descending=!!a.descending;return a}),e=[e]);return e}}),select:new f({type:"select"}),_getQuerierFactory:function(a){return this["_create"+(a[0].toUpperCase()+a.substr(1))+"Querier"]}})})},"dstore/QueryMethod":function(){define([],function(){return function(t){var n=t.type,q=t.normalizeArguments,r=t.applyQuery,g=t.querierFactory;
return function(){var p=Array.prototype.slice.call(arguments),m=q?q.apply(this,p):p,p={type:n,arguments:p,normalizedArguments:m},f=this._getQuerierFactory(n)||g;f&&(p.querier=f.apply(this,m));m=this._createSubCollection({queryLog:this.queryLog.concat(p)});return r?r.call(this,m,p):m}}})},"dstore/Filter":function(){define(["dojo/_base/declare"],function(t){function n(q){return function(){var r=this.constructor,g=new r;g.type=q;g.args=arguments;return this.type?n("and").call(r.prototype,this,g):g}}
t=t(null,{constructor:function(n){var r=typeof n;switch(r){case "object":var r=this,g;for(g in n)var p=n[g],r=p instanceof this.constructor?r[p.type](g,p.args[0]):p&&p.test?r.match(g,p):r.eq(g,p);this.type=r.type;this.args=r.args;break;case "function":case "string":this.type=r,this.args=[n]}},and:n("and"),or:n("or"),eq:n("eq"),ne:n("ne"),lt:n("lt"),lte:n("lte"),gt:n("gt"),gte:n("gte"),contains:n("contains"),"in":n("in"),match:n("match")});t.filterCreator=n;return t})},"dstore/Memory":function(){define("dojo/_base/declare dojo/_base/array ./Store ./Promised ./SimpleQuery ./QueryResults".split(" "),
function(t,n,q,r,g,p){return t([q,r,g],{constructor:function(){this.storage.version=0},postscript:function(){this.inherited(arguments);this.setData(this.data||[])},data:null,autoEmitEvents:!1,getSync:function(g){return this.storage.fullData[this.storage.index[g]]},putSync:function(g,f){f=f||{};var l=this.storage,a=l.index,b=l.fullData,e=this.Model;!e||g instanceof e||(g=this._restore(g));var c=this.getIdentity(g);null==c&&(this._setIdentity(g,"id"in f?f.id:Math.random()),c=this.getIdentity(g));l.version++;
var l=c in a?"update":"add",e={target:g},k;if("update"===l){if(!1===f.overwrite)throw Error("Object already exists");b.splice(k=a[c],1);c=k}else c=this.defaultNewToStart?0:b.length;var h;if("beforeId"in f){var d=f.beforeId;null===d?h=b.length:(h=a[d],k<h&&--h);void 0!==h?e.beforeId=d:(console.error("options.beforeId was specified but no corresponding index was found"),h=c)}else h=c;b.splice(h,0,g);k=isFinite(k)?Math.min(k,h):h;for(c=b.length;k<c;++k)a[this.getIdentity(b[k])]=k;this.emit(l,e);return g},
addSync:function(g,f){(f=f||{}).overwrite=!1;return this.putSync(g,f)},removeSync:function(g){var f=this.storage,l=f.index,f=f.fullData;if(g in l)return l=f.splice(l[g],1)[0],this._reindex(),!0!==this._ignoreChangeEvents&&this.emit("delete",{id:g,target:l}),!0},setData:function(g){this.parse&&(g=this.parse(g));g.items&&(this.idProperty=g.identifier||this.idProperty,g=g.items);this.storage.fullData=this.data=g;this._reindex()},_reindex:function(){for(var g=this.storage,f=g.index={},l=g.fullData,a=
this.Model,b=Object.prototype,e=0,c=l.length;e<c;e++){var k=l[e];if(a&&!(k instanceof a)){var h=this._restore(k,k.__proto__===b);k!==h&&(l[e]=k=h)}f[this.getIdentity(k)]=e}g.version++},fetchSync:function(){var g=this.data;if(!g||g._version!==this.storage.version){for(var g=this.storage.fullData,f=this.queryLog,l=0,a=f.length;l<a;l++)g=f[l].querier(g);g._version=this.storage.version;this.data=g}return new p(g)},fetchRangeSync:function(g){var f=this.fetchSync();return new p(f.slice(g.start,g.end),{totalLength:f.length})},
_includePropertyInSubCollection:function(g){return"data"!==g&&this.inherited(arguments)}})})},"dstore/Promised":function(){define(["dojo/_base/declare","dojo/Deferred","./QueryResults","dojo/when"],function(t,n,q,r){function g(g,m){return function(){var f=new n;try{f.resolve(this[g].apply(this,arguments))}catch(l){f.reject(l)}return m?(f=new q(f.promise),f.totalLength=r(f.totalLength),f):f.promise}}return t(null,{get:g("getSync"),put:g("putSync"),add:g("addSync"),remove:g("removeSync"),fetch:g("fetchSync",
!0),fetchRange:g("fetchRangeSync",!0)})})},"dstore/QueryResults":function(){define(["dojo/_base/lang","dojo/when"],function(t,n){function q(r,g){return n(this,function(p){for(var m=0,f=p.length;m<f;m++)r.call(g,p[m],m,p)})}return function(n,g){var p=g&&"totalLength"in g;if(n.then){n=t.delegate(n);var m=n.then(function(f){var l=p?g.totalLength:f.totalLength||f.length;f.totalLength=l;return!p&&l});n.totalLength=p?g.totalLength:m;n.response=g&&g.response}else n.totalLength=p?g.totalLength:n.length;n.forEach=
q;return n}})},"dstore/SimpleQuery":function(){define(["dojo/_base/declare","dojo/_base/array"],function(t,n){function q(g,p){if(-1<g.indexOf(".")){var m=g.split("."),f=m.length;return function(g){for(var a=0;a<f;a++)g=g&&(p&&g.get?g.get(m[a]):g[m[a]]);return g}}return function(f){return f.get?f.get(g):f[g]}}var r={eq:function(g,p){return g===p},"in":function(g,p){return-1<n.indexOf(p.data||p,g)},ne:function(g,p){return g!==p},lt:function(g,p){return g<p},lte:function(g,p){return g<=p},gt:function(g,
p){return g>p},gte:function(g,p){return g>=p},match:function(g,p,m){return p.test(g,m)},contains:function(g,p,m,f){var l=this;return n.every(p.data||p,function(a){if("object"===typeof a&&a.type){var b=l._getFilterComparator(a.type);return n.some(g,function(e){return b.call(l,e,a.args[1],m,f)})}return-1<n.indexOf(g,a)})}};return t(null,{_createFilterQuerier:function(g){function p(a){var b=a.type;a=a.args;var e=f._getFilterComparator(b);if(e){var c=a[0],g=q(c,m),h=a[1];h&&h.fetchSync&&(h=h.fetchSync());
return function(a){return e.call(f,g(a),h,a,c)}}switch(b){case "and":case "or":for(var d=0,n=a.length;d<n;d++){var r=p(a[d]);l=l?function(a,d){return"and"===b?function(b){return a(b)&&d(b)}:function(b){return a(b)||d(b)}}(l,r):r}return l;case "function":return a[0];case "string":d=f[a[0]];if(!d)throw Error("No filter function "+a[0]+" was found in the collection");return d;case void 0:return function(){return!0};default:throw Error('Unknown filter operation "'+b+'"');}}var m=this.queryAccessors,f=
this,l=p(g);return function(a){return n.filter(a,l)}},_getFilterComparator:function(g){return r[g]||this.inherited(arguments)},_createSelectQuerier:function(g){return function(p){var m=g.length;return n.map(p,g instanceof Array?function(f){for(var l={},a=0;a<m;a++){var b=g[a];l[b]=f[b]}return l}:function(f){return f[g]})}},_createSortQuerier:function(g){var p=this.queryAccessors;return function(m){m=m.slice();m.sort("function"==typeof g?g:function(f,l){for(var a=0;a<g.length;a++){var b,e=g[a];if("function"==
typeof e)b=e(f,l);else{b=e.get||(e.get=q(e.property,p));var e=e.descending,c=b(f);b=b(l);null!=c&&(c=c.valueOf());null!=b&&(b=b.valueOf());b=c===b?0:!!e===(null===c||c>b&&null!==b)?-1:1}if(0!==b)return b}return 0});return m}}})})},"dstore/Tree":function(){define(["dojo/_base/declare"],function(t){return t(null,{constructor:function(){this.root=this},mayHaveChildren:function(n){return"hasChildren"in n?n.hasChildren:!0},getRootCollection:function(){return this.root.filter({parent:null})},getChildren:function(n){return this.root.filter({parent:this.getIdentity(n)})}})})},
"dstore/Cache":function(){define("dojo/_base/array dojo/when dojo/_base/declare dojo/_base/lang ./Store ./Memory ./QueryResults".split(" "),function(t,n,q,r,g,p,m){function f(a){return function(){var e=this.inherited(arguments),c=this.cachingCollection||this.cachingStore;e.cachingCollection=c[a].apply(c,arguments);e.isValidFetchCache=!0===this.canCacheQuery||this.canCacheQuery(a,arguments);return e}}function l(a){a.cachingStore||(a.cachingStore=new p);a.cachingStore.Model=a.Model;a.cachingStore.idProperty=
a.idProperty}var a={cachingStore:null,constructor:function(){l(this)},canCacheQuery:function(a,e){return!1},isAvailableInCache:function(){return this.isValidFetchCache&&(this.allLoaded||this.fetchRequest)||this._parent&&this._parent.isAvailableInCache()},fetch:function(){return this._fetch(arguments)},fetchRange:function(){return this._fetch(arguments,!0)},_fetch:function(a,e){var c=this.cachingStore,f=this.cachingCollection||c,g=this,d=this.isAvailableInCache();if(d)return new m(n(d,function(){return g.isAvailableInCache()?
e?f.fetchRange(a[0]):f.fetch():g.inherited(a)}));d=this.fetchRequest=this.inherited(a);n(d,function(a){var b=!e;g.fetchRequest=null;t.forEach(a,function(a){!g.isLoaded||g.isLoaded(a)?c.put(a):b=!1});b&&(g.allLoaded=!0);return a});return d},isValidFetchCache:!1,get:function(a,e){var c=this.cachingStore,f=this.getInherited(arguments),g=this;return n(this.fetchRequest,function(){return n(c.get(a),function(d){if(void 0!==d)return d;if(f)return n(f.call(g,a,e),function(d){d&&c.put(d,{id:a});return d})})})},
add:function(a,e){var c=this.cachingStore;return n(this.inherited(arguments),function(f){var g=c.put(a&&"object"===typeof f?f:a,e);return f||g})},put:function(a,e){var c=this.cachingStore;c.remove(e&&e.id||this.getIdentity(a));return n(this.inherited(arguments),function(f){var g=c.put(a&&"object"===typeof f?f:a,e);return f||g})},remove:function(a,e){var c=this.cachingStore;return n(this.inherited(arguments),function(f){return n(c.remove(a,e),function(){return f})})},evict:function(a){this.allLoaded=
!1;return this.cachingStore.remove(a)},invalidate:function(){this.allLoaded=!1},_createSubCollection:function(){var a=this.inherited(arguments);a._parent=this;return a},sort:f("sort"),filter:f("filter"),_getQuerierFactory:function(a){var e=this.cachingStore;return this.inherited(arguments)||r.hitch(e,e._getQuerierFactory(a))}};g=q(null,a);g.create=function(b,e){b=q.safeMixin(r.delegate(b),a);q.safeMixin(b,e);l(b);return b};return g})},"dstore/Trackable":function(){define("dojo/_base/lang dojo/_base/declare dojo/aspect dojo/when dojo/promise/all dojo/_base/array dojo/on".split(" "),
function(t,n,q,r,g,p,m){function f(a,e,c){for(var f=a.length-1;0<=f;--f){var g=a[f],d=g.start,g=d+g.count;if(e>g){a.splice(f+1,0,{start:e,count:c-e});return}c>=d&&(e=Math.min(e,d),c=Math.max(c,g),a.splice(f,1))}a.unshift({start:e,count:c-e})}var l=0,a={track:function(){function a(){return function(){var a=this,b=this.inherited(arguments);r(b,function(b){b=a._results=b.slice();a._partialResults&&(a._partialResults=null);a._ranges=[];f(a._ranges,0,b.length)});return b}}function e(){return function(a){var b=
this,d=a.start,e=a.end,c=this.inherited(arguments);this._results||r(c,function(a){return r(a.totalLength,function(c){var g=b._partialResults||(b._partialResults=[]);e=Math.min(e,d+a.length);g.length=c;c=[d,e-d].concat(a);g.splice.apply(g,c);f(b._ranges,d,e);return a})});return c}}function c(a,b){l++;var d=b.target;b=t.delegate(b,B[a]);r(x._results||x._partialResults,function(e){if(e){var c,f,h,l=x._ranges,m,n="id"in b?b.id:g.getIdentity(d),q=-1,r=-1,t=-1,u=-1;if("delete"===a||"update"===a)for(c=0;-1===
q&&c<l.length;++c)for(m=l[c],f=m.start,h=f+m.count;f<h;++f)if(g.getIdentity(e[f])==n){q=b.previousIndex=f;r=c;e.splice(q,1);m.count--;for(f=c+1;f<l.length;++f)l[f].start--;break}if("add"===a||"update"===a){if(C){if(C([d]).length){var B=0;h=l.length-1;f=-1;for(var K;B<=h&&-1===t;)c=B+Math.round((h-B)/2),m=l[c],r=e.slice(m.start,m.start+m.count),"beforeId"in b&&(f=null===b.beforeId?r.length:D(r,b.beforeId)),-1===f&&(f=q>=Math.max(0,m.start-1)&&q<=m.start+m.count?q:g.defaultNewToStart?0:r.length),r.splice(f,
0,d),n=p.indexOf(C(r),d),K=m.start+n,0===n&&0!==m.start?h=c-1:n>=r.length-1&&K<e.length?B=c+1:(t=K,u=c);if(-1===t&&0<B&&B<l.length)var L=!0}}else{f=-1;if("beforeId"in b)if(null===b.beforeId)t=e.length,f=l.length-1;else for(c=0,h=l.length;-1===u&&c<h;++c)m=l[c],t=D(e,b.beforeId,m.start,m.start+m.count),-1!==t&&(u=c);else"update"===a?(t=q,u=r):g.defaultNewToStart?f=t=0:(t=e.length,f=l.length-1);-1!==f&&-1===u&&(m=l[f])&&m.start<=t&&t<=m.start+m.count&&(u=f)}if(-1<t&&-1<u)for(b.index=t,e.splice(t,0,
d),l[u].count++,c=u+1;c<l.length;++c)l[c].start++;else if(L)for(b.beforeIndex=l[B].start,c=B;c<l.length;++c)l[c].start++}b.totalLength=e.length}(e=x["on_tracked"+a])&&e.call(x,b)})}var g=this.store||this,h=[],d={add:1,update:1,"delete":1},u;for(u in d)h.push(this.on(u,function(a){return function(b){c(a,b)}}(u)));var x=n.safeMixin(t.delegate(this),{_ranges:[],fetch:a(),fetchRange:e(),releaseRange:function(a,b){if(this._partialResults){a:for(var c=this._ranges,d=0,e;e=c[d];++d){var f=e.start,g=f+e.count;
if(a<=f)if(b>=g)c.splice(d,1);else{e.start=b;e.count=g-e.start;break a}else if(a<g)if(b>f){c.splice(d,1,{start:f,count:a-f},{start:b,count:g-b});break a}else e.count=a-e.start}for(c=a;c<b;++c)delete this._partialResults[c]}},on:function(a,b){var c=this,e=this.getInherited(arguments);return m.parse(x,a,b,function(a,f){return f in d?q.after(x,"on_tracked"+f,b,!0):e.call(c,f,b)})},tracking:{remove:function(){for(;0<h.length;)h.pop().remove();this.remove=function(){}}},track:null});this.fetchSync&&(n.safeMixin(x,
{fetchSync:a(),fetchRangeSync:e()}),x.fetchSync());var C;p.forEach(this.queryLog,function(a){var b=C,c=a.querier;c&&(C=b?function(a){return c(b(a))}:c)});var B={add:{index:void 0},update:{previousIndex:void 0,index:void 0},"delete":{previousIndex:void 0}},D=function(a,b,c,d){d=void 0!==d?d:a.length;for(c=void 0!==c?c:0;c<d;++c)if(g.getIdentity(a[c])===b)return c;return-1};return x}};g=n(null,a);g.create=function(b,e){b=n.safeMixin(t.delegate(b),a);n.safeMixin(b,e);return b};return g})},"dstore/legacy/DstoreAdapter":function(){define(["dojo/_base/declare",
"dojo/_base/array","dojo/store/util/QueryResults"],function(t,n,q){function r(g){return g}var g={store:null,constructor:function(g){this.store=g;if(g._getQuerierFactory("filter")||g._getQuerierFactory("sort"))this.queryEngine=function(f,l){l=l||{};var a=g._getQuerierFactory("filter"),b=a?a(f):r,a=g._getQuerierFactory("sort"),e=r;a&&(e=a(n.map(l.sort,function(a){return{property:a.attribute,descending:a.descending}})));var c=r;isNaN(l.start)&&isNaN(l.count)||(c=function(a){var b=l.start||0,b=a.slice(b,
b+(l.count||Infinity));b.total=a.length;return b});return function(a){return c(e(b(a)))}};var m=this;g.on("add,update,delete",function(f){var l=f.type,a=f.target;m.notify("add"===l||"update"===l?a:void 0,"delete"===l||"update"===l?"id"in f?f.id:g.getIdentity(a):void 0)})},labelAttr:"title",getLabel:function(g){return this.store.getLabel(g)},query:function(g,m){m=m||{};var f=this.store.filter(g),l,a,b;if(b=m.sort)if("[object Array]"===Object.prototype.toString.call(b))for(var e;e=b.pop();)f=f.sort(e.attribute,
e.descending);else f=f.sort(b);f.track&&!f.tracking&&(f=f.track(),a=!0);"start"in m&&(l=m.start||0,l=f[f.fetchRangeSync?"fetchRangeSync":"fetchRange"]({start:l,end:m.count?l+m.count:Infinity}));l=l||f[f.fetchSync?"fetchSync":"fetch"]();b=l.totalLength;l=new q(l);l.total=b;l.observe=function(b,e){function g(b){return void 0===b&&a?-1:b}var d=f.on("add",function(a){b(a.target,-1,g(a.index))}),l=f.on("update",function(a){!e&&a.previousIndex===a.index&&isFinite(a.index)||b(a.target,g(a.previousIndex),
g(a.index))}),m=f.on("delete",function(a){b(a.target,g(a.previousIndex),-1)}),n={remove:function(){d.remove();l.remove();m.remove()}};n.cancel=n.remove;return n};return l},notify:function(){}};n.forEach(["get","put","add","remove","getIdentity"],function(n){g[n]=function(){var g=this.store;return(g[n+"Sync"]||g[n]).apply(g,arguments)}});return t(null,g)})}}});
//# sourceMappingURL=dgrid.js.map